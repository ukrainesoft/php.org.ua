{"pageProps":{"page":{"slug":"mongodb-driver-clientencryption.encryptexpression.md","content":"# MongoDB\\\\Driver\\\\ClientEncryption::encryptExpression\n\n(mongodb >=1.16.0)\n\nMongoDB\\\\Driver\\\\ClientEncryption::encryptExpression — Шифрує збіг або агрегований вираз\n\n### Опис\n\n```methodsynopsis\nfinal public MongoDB\\Driver\\ClientEncryption::encryptExpression(array|object $expr, ?array $options = null): object\n```\n\nШифрує збіг або агрегований вираз запиту індексу діапазону.\n\nДля виконання запиту із зашифрованим діапазоном корисного навантаження драйвер [MongoDB\\\\Driver\\\\Manager](class.mongodb-driver-manager.md) повинен бути налаштований з опцією `\"autoEncryption\"`Опция`\"bypassQueryAnalysis\"` автоматичного шифрування може мати значення \\*\\*`true`\\*\\*Опция`\"bypassAutoEncryption\"` автоматичного шифрування повинна мати значення **`false`**\n\n> **Зауваження** :\n> \n> Алгоритм роботи з діапазоном є експериментальним. Він призначений для громадського використання.\n> \n> Драйвер PHP поки не підтримує запити діапазонів типів полів decimal128 BSON.\n\n### Список параметрів\n\n`expr`\n\nВідповідність чи агрегований вираз, який необхідно зашифрувати. У виразах повинен використовуватися хоча б один із операторів `$gt` `$gte` `$lt`или`$lte`. Оператор верхнього рівня `$and` необхідний, навіть якщо використовується лише один оператор порівняння.\n\nПриклад підтримуваного виразу відповідності (застосовується для запитів та етапу агрегації `$match`) виглядає наступним чином:\n\n\\[ '$and' => \\[ \\[ '' => \\[ '$gt' => '' \\] \\] \\[ '' => \\[ '$lte' => '' \\] \\] \\],\\]\n\nПриклад агрегованого виразу, що підтримується, виглядає наступним чином:\n\n\\[ '$and' => \\[ \\[ '$gte' => \\[ '', '' \\] \\] \\[ '$lt' => \\[ '', '' \\] \\] \\],\\]\n\n`options`\n\n**Encryption options**\n\n| Опция | Тип | Опис |\n| --- | --- | --- |\n| algorithm | string |  |\n| Алгоритм шифрування, який використовуватиметься. Опція є обов'язковою. Вкажіть одну з наступних [констант ClientEncryption](class.mongodb-driver-clientencryption.md#mongodb-driver-clientencryption.constants) : |  |  |\n\n-   **`MongoDB\\Driver\\ClientEncryption::AEAD_AES_256_CBC_HMAC_SHA_512_DETERMINISTIC`**\n-   **`MongoDB\\Driver\\ClientEncryption::AEAD_AES_256_CBC_HMAC_SHA_512_RANDOM`**\n-   **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_INDEXED`**\n-   **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_UNINDEXED`**\n-   **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_RANGE_PREVIEW`**\n\n| | contentionFactor | int |\n\nКоефіцієнт стримування в оцінці запитів з індексованими, зашифрованими корисними навантаженнями.\n\nОпція застосовується та може бути вказана лише тоді, коли опція `algorithm` дорівнює **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_INDEXED`** або **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_RANGE_PREVIEW`**\n\n| | keyAltName | string |\n\nІдентифікує документ колекції сховища ключів за `keyAltName`. Опція є взаємовиключною з `keyId` і потрібно рівно один.\n\n| | keyId |[MongoDB\\\\BSON\\\\Binary](class.mongodb-bson-binary.md)\n\nІдентифікує ключ даних щодо `_id`. Значення UUID (двійковий підтип 4). Опція є взаємовиключною з `keyAltName` і потрібно рівно один.\n\n| | queryType | string |\n\nТип запиту для оцінки запитів із індексованими, зашифрованими корисними навантаженнями. Вкажіть одну з наступних [констант ClientEncryption](class.mongodb-driver-clientencryption.md#mongodb-driver-clientencryption.constants) :\n\n-   **`MongoDB\\Driver\\ClientEncryption::QUERY_TYPE_EQUALITY`**\n-   **`MongoDB\\Driver\\ClientEncryption::QUERY_TYPE_RANGE_PREVIEW`**\n\nОпція застосовується та може бути вказана лише тоді, коли опція `algorithm` дорівнює **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_INDEXED`** або **`MongoDB\\Driver\\ClientEncryption::ALGORITHM_RANGE_PREVIEW`**\n\n| | rangeOpts | array |\n\nОпції індексу для поля, що шифрується, з підтримкою запитів \"rangePreview\". Наведені нижче параметри повинні відповідати значенням, встановленим у `encryptedFields` цільової колекції. Для полів типу double та decimal128 BSON, `min` `max`и`precision` повинні бути або всі встановлені, або всі повинні бути відсутніми.\n\n**Опції індексу діапазону**\n\n| Опция | Тип | Опис |\n| --- | --- | --- |\n| min | [mixed](language.types.declarations.md#language.types.declarations.mixed) | Обов'язкове, якщо встановлено значення `precision` |\n| max | [mixed](language.types.declarations.md#language.types.declarations.mixed) | Обов'язкове, якщо встановлено значення `precision` |\n| sparsity | int | Обов'язкове. |\n| precision | int | Необов'язкове. Може бути встановлений лише для типів полів BSON double або decimal128. |\n\n### Значення, що повертаються\n\nПовертає зашифрований вираз у вигляді об'єкта.\n\n### Помилки\n\n-   При помилці парсингу аргумент кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\InvalidArgumentException](class.mongodb-driver-exception-invalidargumentexception.md)\n-   Викидає виняток [MongoDB\\\\Driver\\\\Exception\\\\EncryptionException](class.mongodb-driver-exception-encryptionexception.md)у разі виникнення помилки під час шифрування виразу.\n\n### Дивіться також\n\n-   [MongoDB\\\\Driver\\\\Manager::\\_\\_construct()](mongodb-driver-manager.construct.md) \\- Створює новий Manager MongoDB\n","title":"MongoDB\\\\Driver\\\\ClientEncryption::encryptExpression","contentType":2,"navigation":[{"mongodb-driver-clientencryption.encrypt.md":"« MongoDB\\\\Driver\\\\ClientEncryption::encrypt"},{"mongodb-driver-clientencryption.getkey.md":"MongoDB\\\\Driver\\\\ClientEncryption::getKey »"},{"index.md":"PHP Manual"},{"class.mongodb-driver-clientencryption.md":"MongoDB\\\\Driver\\\\ClientEncryption"}]}},"__N_SSG":true}