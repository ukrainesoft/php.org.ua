{"pageProps":{"page":{"slug":"function.sqlsrv-fetch-array.md","content":"# sqlsrv\\_fetch\\_array\n\n(No version information available, might only be in Git)\n\nsqlsrv\\_fetch\\_array — Повертає рядок як масив\n\n### Опис\n\n```methodsynopsis\nsqlsrv_fetch_array(    resource $stmt,    int $fetchType = ?,    int $row = ?,    int $offset = ?): array\n```\n\nПовертає наступний доступний рядок даних у вигляді асоціативного масиву, числового масиву або того й іншого (за замовчуванням).\n\n### Список параметрів\n\n`stmt`\n\nРесурс оператора, що повертається sqlsrv\\_query або sqlsrv\\_prepare.\n\n`fetchType`\n\nОбумовлена ​​константа, що вказує тип масива, що повертається. Можливі значення: **`SQLSRV_FETCH_ASSOC`** **`SQLSRV_FETCH_NUMERIC`** або **`SQLSRV_FETCH_BOTH`**(по умолчанию).\n\nТип вибірки SQLSRV\\_FETCH\\_ASSOC не слід використовувати при використанні набору результатів із кількома стовпцями з однаковим ім'ям.\n\n`row`\n\nЗадає рядок для доступу в результуючому наборі, в якому використовується курсор, що прокручується. Можливі значення: **`SQLSRV_SCROLL_NEXT`** **`SQLSRV_SCROLL_PRIOR`** **`SQLSRV_SCROLL_FIRST`** **`SQLSRV_SCROLL_LAST`** **`SQLSRV_SCROLL_ABSOLUTE`** і **`SQLSRV_SCROLL_RELATIVE`** (за замовчуванням). Якщо цей параметр вказано, `fetchType` має бути явно визначений.\n\n`offset`\n\nВказує рядок, до якого буде доступ, якщо для параметра рядка встановлено значення \\*\\*`SQLSRV_SCROLL_ABSOLUTE`** або **`SQLSRV_SCROLL_RELATIVE`\\*\\*Обратите внимание, что первая строка в наборе результатов имеет индекс 0.\n\n### Значення, що повертаються\n\nУ разі успішного виконання повертає масив, \\*\\*`null`\\*\\*якщо в наборі результатів більше немає рядків і \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Отримання асоціативного масиву.**\n\n```php\n<?php\n$serverName = \"serverName\\instanceName\";\n$connectionInfo = array( \"Database\"=>\"dbName\", \"UID\"=>\"username\", \"PWD\"=>\"password\");\n$conn = sqlsrv_connect( $serverName, $connectionInfo );\nif( $conn === false ) {\n    die( print_r( sqlsrv_errors(), true));\n}\n\n$sql = \"SELECT FirstName, LastName FROM SomeTable\";\n$stmt = sqlsrv_query( $conn, $sql );\nif( $stmt === false) {\n    die( print_r( sqlsrv_errors(), true) );\n}\n\nwhile( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC) ) {\n      echo $row['LastName'].\", \".$row['FirstName'].\"<br />\";\n}\n\nsqlsrv_free_stmt( $stmt);\n?>\n```\n\n**Приклад #2 Отримання числового масиву.**\n\n```php\n<?php\n$serverName = \"serverName\\instanceName\";\n$connectionInfo = array( \"Database\"=>\"dbName\", \"UID\"=>\"username\", \"PWD\"=>\"password\");\n$conn = sqlsrv_connect( $serverName, $connectionInfo );\nif( $conn === false ) {\n    die( print_r( sqlsrv_errors(), true));\n}\n\n$sql = \"SELECT FirstName, LastName FROM SomeTable\";\n$stmt = sqlsrv_query( $conn, $sql );\nif( $stmt === false) {\n    die( print_r( sqlsrv_errors(), true) );\n}\n\nwhile( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_NUMERIC) ) {\n      echo $row[0].\", \".$row[1].\"<br />\";\n}\n\nsqlsrv_free_stmt( $stmt);\n?>\n```\n\n### Примітки\n\nНе вказаний `fetchType` або явне використання константи **`SQLSRV_FETCH_TYPE`** у наведених вище прикладах поверне масив, у якого ключі будуть як асоціативні, і числові.\n\nЯкщо більше одного стовпця повертається з тим самим ім'ям, останній стовпець матиме пріоритет. Щоб уникнути конфліктів імен полів, використовуйте псевдоніми.\n\nЯкщо стовпець повертається без імені, асоціативний ключ для елемента масиву буде порожнім рядком (\"\").\n\n### Дивіться також\n\n-   [sqlsrv\\_connect()](function.sqlsrv-connect.md) \\- Відкриває з'єднання з базою даних Microsoft SQL Server\n-   [sqlsrv\\_query()](function.sqlsrv-query.md) \\- готує та виконує запит\n-   [sqlsrv\\_errors()](function.sqlsrv-errors.md) \\- Повертає інформацію про помилку та попередження останньої виконаної операції SQLSRV\n-   [sqlsrv\\_fetch()](function.sqlsrv-fetch.md) \\- Робить наступний рядок у наборі результатів доступного для читання\n","title":"sqlsrv\\_fetch\\_array","contentType":2,"navigation":[{"function.sqlsrv-execute.md":"« sqlsrv\\_execute"},{"function.sqlsrv-fetch-object.md":"sqlsrv\\_fetch\\_object »"},{"index.md":"PHP Manual"},{"ref.sqlsrv.md":"Функції SQLSRV"}]}},"__N_SSG":true}