{"pageProps":{"page":{"slug":"class.com.md","content":"# Клас com\n\n(PHP 4 >= 4.1.0, PHP 5, PHP 7, PHP 8)\n\n## Вступ\n\nКлас com дозволяє створювати екземпляри OLE-сумісного COM-об'єкта, викликати його методи та отримувати доступ до його властивостей.\n\n## Огляд класів\n\n```classsynopsis\n\n    \n     class com\n    \n\n    \n     extends\n      variant\n     {\n\n    /* Методы */\n    \n   public __construct(    string $module_name,    array|string|null $server_name = null,    int $codepage = CP_ACP,    string $typelib = \"\")\n\n   }\n```\n\n## Перевантажені методи\n\nОб'єкти, що повертаються, є перевантаженими, тобто PHP не бачить будь-яких фіксованих методів, як це відбувається зі звичайними класами. Замість цієї властивості та доступ до методів передається через COM.\n\nPHP автоматично визначає методи, які звертаються до властивостей посилань і автоматично перетворять стандартні змінні PHP у вигляд, який можна передавати за посиланням. Це означає, що ви можете викликати методи, не вносячи будь-яких доповнень до свого коду.\n\n## Приклади використання com\n\n**Приклад #1 Перший приклад**\n\n```php\n<?php\n// запускаем word\n$word = new com(\"word.application\") or die(\"Невозможно создать экземпляр Word\");\necho \"Загружен Word, версия {$word->Version}\\n\";\n\n//делаем его активным окном\n$word->Visible = 1;\n\n//открываем пустой документ\n$word->Documents->Add();\n\n//Что то с ним делаем\n$word->Selection->TypeText(\"Это проверка...\");\n$word->Documents[1]->SaveAs(\"Бесполезный тест.doc\");\n\n//закрываем word\n$word->Quit();\n\n//высвобождаем ресурсы объекта\n$word = null;\n?>\n```\n\n**Приклад #2 Другий приклад**\n\n```php\n<?php\n\n$conn = new com(\"ADODB.Connection\") or die(\"Cannot start ADO\");\n$conn->Open(\"Provider=SQLOLEDB; Data Source=localhost;\nInitial Catalog=database; User ID=user; Password=password\");\n\n$rs = $conn->Execute(\"SELECT * FROM sometable\");    // Набор записей\n\n$num_columns = $rs->Fields->Count();\necho $num_columns . \"\\n\";\n\nfor ($i=0; $i < $num_columns; $i++) {\n    $fld[$i] = $rs->Fields($i);\n}\n\n$rowcount = 0;\nwhile (!$rs->EOF) {\n    for ($i=0; $i < $num_columns; $i++) {\n        echo $fld[$i]->value . \"\\t\";\n    }\n    echo \"\\n\";\n    $rowcount++;            // увеличиваем счётчик строк\n    $rs->MoveNext();\n}\n\n$rs->Close();\n$conn->Close();\n\n$rs = null;\n$conn = null;\n\n?>\n```\n\n## Зміст\n\n-   [com::\\_\\_construct](com.construct.md) \\- Конструктор класу com\n","title":"Клас com","contentType":2,"navigation":[{"com.examples.arrays.md":"« Масиви та властивості COM у стилі масивів"},{"com.construct.md":"com::\\_\\_construct »"},{"index.md":"PHP Manual"},{"book.com.md":"COM"}]}},"__N_SSG":true}