- [« yaz_range](function.yaz-range.md)
- [yaz_scan_result »](function.yaz-scan-result.md)

- [PHP Manual](index.md)
- [Функції YAZ](ref.yaz.md)
- Повертає запис

# yaz_record

(PHP 4 u003d 4.0.1, PECL yaz u003d 0.9.0)

yaz_record — Повертає запис

### Опис

**yaz_record**(resource `$id`, int `$pos`, string `$type`): string

Функція **yaz_record()** перевіряє запис у поточному результуючому
набір на позиції, визначеної параметром `pos`.

### Список параметрів

`id`
Дескриптор з'єднання, що повертається
[yaz_connect()](function.yaz-connect.md).

`pos`
Позиція запису. Записи в результуючому наборі нумеруються як 1, 2, ...
$hits, де $hits - число записів у результуючому наборі, яке
повертається функцією [yaz_hits()](function.yaz-hits.md).

`type`
`type` визначає форму запису, що повертається.

> **Примітка**:
>
> Тільки додаток несе відповідальність за достовірність того, що
> записи, що повертаються з сервера Z39.50/SRW у належному форматі.
> Тип, що задається, тільки визначає перетворення, яке має місце
> на стороні клієнта (PHP/YAZ).

Крім перетворення переданого запису в рядок/масив, PHP/YAZ так само
може конвертувати кодування запису. Особливо це актуально для
форматів USMARC/MARC21, які рекомендується перетворювати, оскільки
вони зазвичай повертаються в кодуванні MARC-8, яке не розуміють браузери
та інші програми. Щоб визначити перетворення, додайте
`; charsetu003d`from`, `to, де from поточне кодування запису та to
результуюче кодування, яке буде доступне PHP.

`string`
Запис повертається як рядок для відображення. У цьому режимі всі
MARC-записи перетворюються на построкове уявлення, оскільки в
формат ISO2709 їх важко прочитати. Записи XML та SUTRS повертаються до
їхньому рідному форматі. GRS-1 повертається у (потворному) построковому
поданні.

Даний формат застосовується для швидкого виведення записів на екран,
налагодження, або якщо коректне відображення неможливо.

`xml`
Запис повертається як рядок XML, якщо це можливо. У цьому режимі всі
MARC-записи перетворюються на формат
[» MARCXML](http://www.loc.gov/standards/marcxml/). Записи XML та SUTRS
повертаються у їхньому рідному форматі. GRS-1 не підтримується.

Цей формат схожий на `string`, за винятком того, що MARC-записи
перетворюються на MARCXML.

Цей формат застосовується, якщо запис буде передано парсеру XML або
XSLT-процесору.

`raw`
Запис повертається у вигляді рядка у вихідній формі. Цей тип застосовується
для MARC, XML та SUTRS, але не працює для GRS-1.

MARC-запис повертається у форматі ISO2709, XML та SUTRS повертаються як
рядок.

`syntax`
Синтаксис запису, що повертається, наприклад `USmarc`, `GRS-1`, `XML`, і д.р.

`database`
Ім'я бази даних, зіставлене із записом.

`array`
Запис повертається як масиву, зіставленого зі структурою GRS-1.
Цей тип застосовується для MARC і GRS-1. XML, SUTRS не підтримуються та,
якщо вихідний запис у форматі XML або SUTRS, повертається порожній
рядок.

Масив, що повертається, складається зі списку, який відповідає кожному
внутрішньому вузлу або кінцевому елементу формату GRS-1. Кожен
список складається з підписку, першим елементом якого буде *шлях* і
*дата* (якщо вона доступна).

Шлях, поданий у вигляді рядка, містить список кожної компоненти
дерева (для структури запису GRS-1) від кореневого елемента до кінцевого.
Кожна компонента представлена парою тип поля та значення, у формі
(`тип`, `значення`).

Початкове поле зазвичай зіставлено типу 3. MARC-записи також можуть бути
повернені як масиву (вони конвертуються в GRS-1).

### Значення, що повертаються

Повертає запис на позиції `pos` або порожній рядок, якщо на заданому
позиції немає записів.

Якщо на заданій позиції в базі даних немає записів, буде повернуто
порожня стрічка.

### Приклади

**Приклад #1 Масив для запису GRS-1**

Візьмемо запис GRS-1, виду:

``` examplescode
(4,52) Robert M. Pirsig
(4,70)
(4,90)
(2,7) Transworld Publishers, ltd.
````

Цей запис містить два вузли на верхньому (кореневому) рівні. Перший
елемент кореневого рівня (4,52) \[тип 4, значення 52\], і містить
дані `Robert M. Pirsig`. Другий елемент кореневого рівня (4,70)
містить піддерево з єдиним елементом (4,90). Елемент (4,90)
свою чергу містить піддерево (2,7) з даними
`Transworld Publishers, ltd.`.

Якщо цей запис знаходиться на позиції $p, тоді скрипт

` <?php$ar u003d yaz_record($id, $p, "array");print_r($ar);?> `

виведе:

Array
(
[0] u003d> Array
(
[0] u003d> (4,52)
[1] u003d> Robert M. Pirsig
)
[1] u003d> Array
(
[0] u003d> (4,70)
)
[2] u003d> Array
(
[0] u003d> (4,70) (4,90)
)
[3] u003d> Array
(
[0] u003d> (4,70)(4,90)(2,7)
[1] u003d> Transworld Publishers, ltd.
)
)

**Приклад #2 Приклад роботи з MARCXML**

Скрипт поверне запис MARC21/USMARC у форматі MARCXML. Вихідна
запис буде повернено у кодуванні marc-8 (невідомому для більшості
XML парсерів), тому вона перетворюється на UTF-8.

` <?php$rec u003d yaz_record($id, $p, "xml; charsetu003dmarc-8,utf-8");?> `

Запис `$rec` може бути оброблений процесором Sablotron XSLT так:

` <?php$xslfile u003d 'display.xsl';$processor u003d xslt_create();$parms u003d array('/_xml' u003d> $rec);$res u003d xslt_process($processor, 'arg:/ $xslfile, NULL, $parms);xslt_free($processor);$res u003d preg_replace("'</?html[^>]*>'", '', $res);echo $res;?> `
