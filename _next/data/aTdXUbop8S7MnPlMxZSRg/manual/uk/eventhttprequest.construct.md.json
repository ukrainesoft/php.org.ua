{"pageProps":{"page":{"slug":"eventhttprequest.construct.md","content":"# EventHttpRequest::\\_\\_construct\n\n(PECL event >= 1.4.0-beta)\n\nEventHttpRequest::\\_\\_construct — Створює об'єкт EventHttpRequest\n\n### Опис\n\n```methodsynopsis\npublic\n   EventHttpRequest::__construct(\n    callable\n     $callback\n   , \n    mixed\n     $data\n     = null\n   )\n```\n\nСтворює об'єкт EventHttpRequest.\n\n### Список параметрів\n\n`callback`\n\nВикликається за запитом шляху. Повинен відповідати наступному прототипу:\n\n```methodsynopsis\ncallback(\n       EventHttpRequest\n        $req\n        = null\n      , \n       mixed\n        $arg\n        = null\n      ): void\n```\n\n`data`\n\nКористувальницькі дані, що передаються в callback-функцію.\n\n### Приклади\n\n**Приклад #1 Приклад использования метода**EventHttpRequest::\\_\\_construct()\\*\\*\\*\\*\n\n```php\n<?php\n\nfunction _request_handler($req, $base) {\n    echo __FUNCTION__, PHP_EOL;\n\n    if (is_null($req)) {\n        echo \"Время вышло\\n\";\n    } else {\n        $response_code = $req->getResponseCode();\n\n        if ($response_code == 0) {\n            echo \"Соединение разорвано\\n\";\n        } elseif ($response_code != 200) {\n            echo \"Неожиданный ответ: $response_code\\n\";\n        } else {\n            echo \"Успешно: $response_code\\n\";\n            $buf = $req->getInputBuffer();\n            echo \"Тело ответа:\\n\";\n            while ($s = $buf->readLine(EventBuffer::EOL_ANY)) {\n                echo $s, PHP_EOL;\n            }\n        }\n    }\n\n    $base->exit(NULL);\n}\n\n\n$address = \"127.0.0.1\";\n$port = 80;\n\n$base = new EventBase();\n$conn = new EventHttpConnection($base, NULL, $address, $port);\n$conn->setTimeout(5);\n$req = new EventHttpRequest(\"_request_handler\", $base);\n\n$req->addHeader(\"Host\", $address, EventHttpRequest::OUTPUT_HEADER);\n$req->addHeader(\"Content-Length\", \"0\", EventHttpRequest::OUTPUT_HEADER);\n$conn->makeRequest($req, EventHttpRequest::CMD_GET, \"/index.cphp\");\n\n$base->loop();\n\n?>\n```\n\n### Дивіться також\n\n-   [EventHttpRequest::cancel()](eventhttprequest.cancel.md) \\- Скасує очікування HTTP-запиту\n-   [EventHttpRequest::addHeader()](eventhttprequest.addheader.md) \\- Додає заголовок HTTP до заголовків запиту\n","title":"EventHttpRequest::\\_\\_construct","contentType":2,"navigation":[{"eventhttprequest.closeconnection.md":"« EventHttpRequest::closeConnection"},{"eventhttprequest.findheader.md":"EventHttpRequest::findHeader »"},{"index.md":"PHP Manual"},{"class.eventhttprequest.md":"EventHttpRequest"}]}},"__N_SSG":true}