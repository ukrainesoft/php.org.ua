- [« Нові глобальні константи](migration73.constants.md)
- [Функціонал, оголошений застарілим у PHP 7.3.x
»](migration73.deprecated.md)

- [PHP Manual](index.md)
- [Міграція з PHP 7.2.x на PHP 7.3.x](migration73.md)
- Зміни, що ламають зворотну сумісність

## Зміни, що ламають зворотну сумісність

### Ядро PHP

#### Інтерпретація закриває ідентифікатора Heredoc/Nowdoc

Завдяки введенню [гнучкого синтаксису
heredoc/nowdoc](migration73.new-features.md#migration73.new-features.core.heredoc),
doc-рядки, що містять закривають ідентифікатори всередині свого тіла,
можуть викликати синтаксичні помилки або зміни інтерпретації.
Приклад:

` <?php$str u003d <<<<FOOabcdefg   FOOFOO;?> `

З відступом `FOO` раніше у відсутності особливого значення. Тепер він буде
інтерпретуватися як кінець heredoc-рядка і наступний `FOO;` приведе
до синтаксичної помилки. Ця проблема завжди може бути вирішена шляхом
вибору закриває ідентифікатора, який не використовується у вмісті
рядки.

#### Генерування попередження в continue, що використовується в switch

Вирази `continue`, що використовуються у структурах управління потоку
`switch` тепер видаватиме попередження. У PHP такі висловлювання
`continue` еквіваленти `break`, у той час, як в інших мовах вони
поводяться як `continue 2`.

` <?phpwhile ($foo) {    switch ($bar) {      case "baz":         continue; // Попередження: "continue" еквівалентний      "break". Можливо, ви мали у виду "continue 2"? }}?> `

#### Сувора інтерпретація цілих рядкових ключів на ArrayAccess

Доступ до масиву типу $obj["123"], де $obj реалізує
[ArrayAccess](class.arrayaccess.md), а `"123"` - це цілий
рядковий літерал, більше не призведе до неявного перетворення на ціле
число, тобто. `$obj->offsetGet("123")` замість `$obj->offsetGet(123)`. Це
відповідає існуючому поведінці для нелітеральних значень.
Поведінка масивів не змінилося, вони продовжують неявно
перетворювати цілі рядкові ключі на цілі числа.

#### Статичні властивості більше не поділяються присвоєнням за посиланням

У PHP статичні властивості спільно використовуються наступними класами,
якщо статичну властивість явно не перевизначено у дочірньому класі.
Однак через помилку реалізації можна було відокремити статичні властивості,
надавши їх за посиланням. Ця лазівка була виправлена.

` <?phpclass Test {    public static $x u003d 0;}class Test2 extends Test { }Test2::$x u003d &$x;$x u003d 1;var_dump(Test::$x,$ // Раніше: int(0), int(1)//Тепер: int(1), int(1)?

#### Посилання, що повертаються при доступі до масиву або властивості негайно розпаковуються

Посилання, що повертаються доступом до масиву та властивості, тепер
розпаковуються як частина доступу. Це означає, що більше неможливо
змінити посилання між доступом та використанням доступного значення:

` <?php$arr u003d [1];$ref u003d& $arr[0];var_dump($arr[0] + ($arr[0] u003d 2));// Раніше: int(4), Тепер : int(3)?> `

Це робить поведінку посилань і без узгоджених посилань. Зверніть
увага, що читання та запис значення всередині одного виразу залишається
невизначеним поведінкою і може змінитися у майбутньому.

#### Розпакування аргументу зі значенням Traversable з нечисловими ключами більше не підтримується

Розпакування аргументів перестало працювати зі значенням
[Traversable](class.traversable.md) із нечисловими ключами. Наступний
код працює в PHP 5.6-7.2 помилково.

` <?phpfunction foo(...$args) {    var_dump($args);}function gen() {    yield 1.23 u003d> 123;}foo(...gen());?> `

#### Різне

Утиліта `ext_skel` була повністю перероблена з новими опціями, а
деякі старі опції вилучені. Тепер вона написана на PHP і не має
зовнішніх залежностей.

Підтримку BeOS було припинено.

Винятки, викинуті через автоматичне перетворення
попередження у виключення в режимі `EH_THROW` (наприклад, деякі
виключення [DateTime](class.datetime.md)), більше не заповнюють
стан [error_get_last()](function.error-get-last.md). Таким
Таким чином, вони тепер працюють так само, як вручну викинуті винятки.

Виняток [TypeError](class.typeerror.md) тепер вказує на
правильні типи `int` та `bool` замість `integer` і `boolean`,
відповідно.

Про невизначені змінні, передані в
[compact()](function.compact.md), тепер буде повідомлено повідомленням.

Функція [getimagesize()](function.getimagesize.md) та пов'язані з нею
функції тепер повідомляють mime-типи зображень BMP як `image/bmp` замість
`image/x-ms-bmp`, оскільки перший зареєстрований в IANA (дивіться
[»RFC 7903](http://www.faqs.org/rfcs/rfc7903)).

Функція [stream_socket_get_name()](function.stream-socket-get-name.md)
тепер повертає адреси IPv6, укладені у квадратні дужки.
Наприклад, буде повернуто рядок `"[::1]:1337"` замість `"::1:1337"`.

### Довільної точності математика BCMath

Усі попередження, викинуті [функціями BCMath](ref.bc.md), тепер
використовують обробку помилок PHP. Раніше деякі попередження були
безпосередньо відправлені в потік stderr.

Функції [bcmul()](function.bcmul.md) та [bcpow()](function.bcpow.md)
тепер повертають числа із запитаним масштабом. Раніше повертаються
числа могли опускати завершальні десяткові нулі.

### IMAP, POP3 та NNTP

Логін **rsh**/**ssh** за замовчуванням вимкнено. Використовуйте
[imap.enable_insecure_rsh](imap.configuration.md#ini.imap.enable-insecure-rsh),
якщо ви хочете включити їх. Зверніть увагу, що бібліотека IMAP не
фільтрує імена поштових скриньок перед передачею їх команді
**rsh**/**ssh**, таким чином, передача ненадійних даних цієї функції
з увімкненим **rsh**/**ssh** небезпечна.

### Мультибайтові рядки

Через додаткову підтримку іменованих фрагментів, патерни
`mb_ereg_*()` з використанням іменованих фрагментів будуть поводитися
по різному. Зокрема, іменовані фрагменти будуть частиною збігів,
а [mb_ereg_replace()](function.mb-ereg-replace.md) буде
інтерпретувати додатковий синтаксис. Дивіться [Іменовані
фрагменти](migration73.new-features.md#migration73.new-features.mbstring.named-captures)
для отримання додаткової інформації.

### Покращений модуль MySQL

Підготовлені запити тепер правильно вказують на дрібні секунди для
стовпців `DATETIME`, `TIME` та `TIMESTAMP` з вказівником десяткових знаків
(наприклад, `TIMESTAMP(6)` при використанні мікросекунд). Раніше частина
дробових секунд була просто опущена з значень, що повертаються.

### Функції MySQL (PDO_MYSQL)

Підготовлені запити тепер правильно вказують на дрібні секунди для
стовпців `DATETIME`, `TIME` та `TIMESTAMP` зі специфікатором десяткових
знаків (наприклад, `TIMESTAMP(6)` при використанні мікросекунд). Раніше,
дрібна частина секунд була просто опущена з значень, що повертаються.
Зверніть увагу, що це впливає лише на використання
[PDO_MYSQL](ref.pdo-mysql.md) з відключеною емуляцією підготовлених
запитів (наприклад, із використанням нативної функціональності).
Запити, що використовують з'єднання, які мають опцію
**`PDO::ATTR_EMULATE_PREPARES`**u003d**`true`** (значення за замовчуванням), не
були порушені даним виправленням помилки і вже отримували коректні
значення часток секунди від двигуна.

### Reflection

Експорт об'єктів [Reflection](book.reflection.md) у рядок тепер
використовує `int`) та `bool`) замість `integer` and `boolean`,
відповідно.

### Стандартна бібліотека PHP (SPL)

Якщо автозавантажувач [SPL](book.spl.md) викидає виняток,
наступні автозавантажувачі не виконуватимуться. Раніше все
автозавантажувачі виконувались, а винятки об'єднувалися в ланцюжок викликів.

### SimpleXML

Математичні операції, що включають об'єкти
[SimpleXML](book.simplexml.md), тепер будуть обробляти текст як
ціле число (int) або число з плаваючою точкою (float), залежно від
те, що є більш підходящим. Раніше значення оброблялися як
цілі числа (integer) без будь-яких умов.

### Вхідні Cookies

Починаючи з PHP 7.3.23 *імена* вхідних cookie більше не декодуються з
URL-закодованого рядка з міркувань безпеки.
