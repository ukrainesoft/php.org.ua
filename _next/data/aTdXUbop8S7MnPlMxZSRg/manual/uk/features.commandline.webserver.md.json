{"pageProps":{"page":{"slug":"features.commandline.webserver.md","content":"## Вбудований веб-сервер\n\n**Увага**\n\nВеб-сервер призначений для допомоги у розробці програм. Він також може бути корисним у тестових цілях або для демонстрації програми, що запускається у повністю контрольованому оточенні. Він не виконує повноцінного веб-сервера і не повинен використовуватися в загальнодоступних мережах.\n\nМодуль CLI SAPI містить вбудований веб-сервер.\n\nВеб-сервер виконує лише один однопотоковий процес, тому програми PHP зупинятимуться, якщо запит заблокований.\n\nURI запити обслуговуються з поточної директорії, в якій було запущено PHP, якщо не використовується опція -t для явного вказівки кореневого документа. Якщо URI запиту не вказує на певний файл, то буде повернутий index.php або index.md у вказаній директорії. Якщо жоден із файлів не існує, то пошук цих файлів буде продовжено в батьківській директорії і так далі, доки вони не будуть знайдені або було досягнуто коріння документа. Якщо знайдено index.php або index.md, він повертається, а в $\\_SERVER\\['PATH\\_INFO'\\] буде знайдено останню частину URL-адреси. В іншому випадку повертається код відповіді 404.\n\nЯкщо PHP-файл вказується в командному рядку, коли запускається веб-сервер, він розглядається як скрипт \"маршрутизації\" (router). Скрипт виконується на початку кожного HTTP-запиту. Якщо цей скрипт повертає **`false`**, То запитуваний ресурс повертається як є. В іншому випадку браузеру буде повернено виведення цього скрипту.\n\nСтандартні MIME-типи повертаються для файлів з такими розширеннями: .3gp, .apk, .avi, .bmp, .css, .csv, .doc, .docx, .flac, .gif, .gz, .gzip, .htm, .md, .ics, .jpe, .jpeg, .jpg, .js, .kml, .kmz, .m4a, .mov, .mp3, .mp4, .mpeg, .mpg, .odp, .ods, .odt , .oga, .ogg, .ogv, .pdf, .pdf, .png, .pps, .pptx, .qt, .svg, .swf, .tar, .text, .tif, .txt, .wav, . webm, .wmv, .xls, .xlsx, .xml, .xsl, .xsd та .zip.\n\n**Історія правок: Підтримувані MIME-типи (розширення файлів)**\n\n| Версия | Опис |\n| --- | --- |\n| 5.5.12 | .xml, .xsl, та .xsd |\n| 5.5.7 | .3gp, .apk, .avi, .bmp, .csv, .doc, .docx, .flac, .gz, .gzip, .ics, .kml, .kmz, .m4a, .mp3, .mp4, .mpg , .mpeg, .mov, .odp, .ods, .odt, .oga, .pdf, .pptx, .pps, .qt, .swf, .tar, .text, .tif, .wav, .wmv, . xls, .xlsx та .zip |\n| 5.5.5 | .pdf |\n| 5.4.11 | .ogg, .ogv, та .webm |\n| 5.4.4 | .htm та .svg |\n\n**Історія змін**\n\n| Версия | Опис |\n| --- | --- |\n| 7.4.0 | Ви можете налаштувати вбудований веб-сервер так, щоб він виконував розгалуження кількох воркерів для перевірки коду, який потребує кількох одночасних запитів до вбудованого веб-сервера. Задайте у змінній оточення PHP\\_CLI\\_SERVER\\_WORKERS кількість необхідних воркерів перед запуском сервера. Не підтримується у Windows. |\n| **Увага** |  |\n\nЦя *експериментальна*функция*не* призначена для продакшен використання. Зазвичай вбудований веб-сервер *не*предназначен для продакшен использования.\n\n**Приклад #1 Запуск веб-сервера**\n\n$ cd ~/public\\_html $ php -S localhost:8000\n\nУ консолі виведеться:\n\n```\nPHP 5.4.0 Development Server started at Thu Jul 21 10:43:28 2011\nListening on localhost:8000\nDocument root is /home/me/public_html\nPress Ctrl-C to quit\n```\n\nПісля URI-запитів [http://localhost:8000/](http://localhost:8000/) і [http://localhost:8000/myscript.md](http://localhost:8000/myscript.md) в консолі виведеться приблизно таке:\n\n```\nPHP 5.4.0 Development Server started at Thu Jul 21 10:43:28 2011\nListening on localhost:8000\nDocument root is /home/me/public_html\nPress Ctrl-C to quit.\n[Thu Jul 21 10:48:48 2011] ::1:39144 GET /favicon.ico - Request read\n[Thu Jul 21 10:48:50 2011] ::1:39146 GET / - Request read\n[Thu Jul 21 10:48:50 2011] ::1:39147 GET /favicon.ico - Request read\n[Thu Jul 21 10:48:52 2011] ::1:39148 GET /myscript.md - Request read\n[Thu Jul 21 10:48:52 2011] ::1:39149 GET /favicon.ico - Request read\n```\n\nЗверніть увагу, що до PHP 7.4.0 статичні ресурси із символічними посиланнями не були доступні у Windows, якщо тільки скрипт маршрутизатора не обробив би їх.\n\n**Приклад #2 Запуск із зазначенням кореневої директорії**\n\n$ cd ~/public\\_html $ php -S localhost:8000 -t foo/\n\nУ консолі виведеться:\n\n```\nPHP 5.4.0 Development Server started at Thu Jul 21 10:50:26 2011\nListening on localhost:8000\nDocument root is /home/me/public_html/foo\nPress Ctrl-C to quit\n```\n\n**Приклад #3 Використання скрипта маршрутизації**\n\nУ цьому прикладі запити зображень будуть відображати їх, але запити HTML-файлів будуть повертати \"Ласкаво просимо до PHP\".\n\n```php\n<?php\n// router.php\nif (preg_match('/\\.(?:png|jpg|jpeg|gif)$/', $_SERVER[\"REQUEST_URI\"])) {\n    return false;    // сервер возвращает файлы напрямую.\n} else {\n    echo \"<p>Добро пожаловать в PHP</p>\";\n}\n?>\n```\n\n$ php -S localhost:8000 router.php\n\n**Увага**\n\nВбудований веб-сервер не повинен використовуватись у загальнодоступній мережі.\n\n**Приклад #4 Перевірка використання веб-сервера CLI**\n\nДля спільного використання скрипта маршрутизації при розробці з веб-сервером CLI і надалі з робочим веб-сервером:\n\n```php\n<?php\n// router.php\nif (php_sapi_name() == 'cli-server') {\n    /* Маршрутизация с заданными правилами и возврат false */\n}\n/* продолжение с обычными операциями index.php */\n?>\n```\n\n$ php -S localhost:8000 router.php\n\n**Приклад #5 Підтримка типів файлів, що не підтримуються.**\n\nЯкщо вам потрібно обслуговувати статичні ресурси з MIME-типами, які не підтримує веб-сервер CLI, використовуйте це:\n\n```php\n<?php\n// router.php\n$path = pathinfo($_SERVER[\"SCRIPT_FILENAME\"]);\nif ($path[\"extension\"] == \"el\") {\n    header(\"Content-Type: text/x-script.elisp\");\n    readfile($_SERVER[\"SCRIPT_FILENAME\"]);\n}\nelse {\n    return FALSE;\n}\n?>\n```\n\n$ php -S localhost:8000 router.php\n\n**Приклад #6 Доступ до веб-сервера CLI з віддалених машин**\n\nВи можете зробити веб-сервер доступним на 8000 портах для всіх мережевих інтерфейсів:\n\n$ php -S 0.0.0.0:8000\n","title":"Вбудований веб-сервер","contentType":2,"navigation":[{"features.commandline.interactive.md":"« Інтерактивна консоль"},{"features.commandline.ini.md":"Опції конфігурації »"},{"index.md":"PHP Manual"},{"features.commandline.md":"Робота з PHP з командного рядка"}]}},"__N_SSG":true}