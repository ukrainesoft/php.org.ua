- [« ssh2_auth_pubkey_file](function.ssh2-auth-pubkey-file.md)
- [ssh2_disconnect »](function.ssh2-disconnect.md)

- [PHP Manual](index.md)
- [Функції SSH2](ref.ssh2.md)
- Підключення до SSH-сервера

# ssh2_connect

(PECL ssh2 \>u003d 0.9.0)

ssh2_connect — Підключення до SSH-сервера

### Опис

**ssh2_connect**(
string `$host`,
int `$port` u003d 22,
array `$methods` u003d ?,
array `$callbacks` u003d ?
): resource

Встановлює з'єднання з сервером SSH.

Після з'єднання користувач повинен перевірити ключ сервера, використовуючи
функцію [ssh2_fingerprint()](function.ssh2-fingerprint.md), та після
цього авторизуватись, використовуючи пароль або відкритий ключ.

### Список параметрів

`host`

`port`

`methods`
Параметр `methods` може бути асоціативним масивом, що містить до
чотирьох записів, наведених нижче.

| Індекс Що означає | Допустимі значення * |
|------------------|------------------------------ -------------------------------------------------- -------------------------------------------------- -----------------------------------------|-------- -------------------------------------------------- -------------------------------------------|
| kex | Список методів обміну ключами, розділених комою, як перевагу. | `diffie-hellman-group1-sha1`, `diffie-hellman-group14-sha1`, та `diffie-hellman-group-exchange-sha1` |
| hostkey | Список методів ключів хоста, розділених комою, як перевагу. | `ssh-rsa` та `ssh-dss` |
| client_to_server | Асоціативний масив, що містить налаштування шифрування, стиснення та методу імітівставки ("message authentication code" або MAC) для повідомлень, надісланих клієнтом серверу. | |
| server_to_client | Асоціативний масив, що містить налаштування шифрування, стиснення та методу імітівставки ("message authentication code" або MAC) для повідомлень, надісланих сервером клієнту. | |

**Параметр `methods` може бути асоціативним масивом, що містить від
одного до чотирьох параметрів**

\* - Підтримувані значення залежать від методів, що підтримуються базовою
бібліотекою. Докладніше читайте документацію з
[» libssh2](http://libssh2.org/).

| Індекс Що означає | Допустимі значення * |
|--------|---------------------------------------- ---------------------------------|---------------- -------------------------------------------------- -------------------------------------------------- ----------------------|
| crypt | Список методів шифрування, розділених комою, як перевагу. | `rijndael-cbc@lysator.liu.se`, `aes256-cbc`, `aes192-cbc`, `aes128-cbc`, `3des-cbc`, `blowfish-cbc`, `cast128-cbc`, `arcfour `і `none**` |
| comp | Список методів стиснення, розділених комою, як перевагу. | `zlib` та `none` |
| mac | Список методів MAC, розділених комою, як перевагу. | `hmac-sha1`, `hmac-sha1-96`, `hmac-ripemd160`, `hmac-ripemd160@openssh.com` та `none**` |

**`client_to_server` та `server_to_client` можуть бути асоціативними
масивами, що містять будь-які або всі нижченаведені параметри.**

> **Примітка**: **Метод шифрування "`none`" та MAC**
>
> З метою безпеки `none` відключено в базовій бібліотеці
> [» libssh2](http://libssh2.org/), якщо ви не дозволили його
> самостійно на етапі збирання, використовуючи відповідні ключі
> ./configure. Дивіться документацію по базовій бібліотеці для більш
> Докладна інформація.

callbacks
callbacks може бути асоціативним масивом, що містить будь-який або ж
всі нижчеперелічені параметри

| Індекс Що означає | Прототип
|------------|------------------------------------ -------------------------------------------------- -------------------------------------------------- -------------------------------------------------| -------------------------------------------------- ---|
| ignore | Ім'я функції після отримання пакета **`SSH2_MSG_IGNORE`** | void ignore_cb($message) |
| debug | Ім'я функції після отримання пакета **`SSH2_MSG_DEBUG`** | void debug_cb($message, $language, $always_display) |
| macerror | Ім'я функції, викликаної, якщо пакет отримано, але MAC не вдалося. Якщо callback-функція поверне **`true`**, розбіжність буде проігнорована, інакше з'єднання буде обірвано. | bool macerror_cb($packet) |
| disconnect | Ім'я функції, що викликається після одержання пакета **`SSH2_MSG_DISCONNECT`** | void disconnect_cb($reason, $message, $language) |

**Параметри callback-функції**

### Значення, що повертаються

Повертає ресурс у разі успішного виконання або **`false`** у разі
виникнення помилки.

### Приклади

**Приклад #1 Приклад **ssh2_connect()****

Відкриємо з'єднання, примусово використовуючи такі настройки: 3des-cbc
при відправленні пакетів, шифр aes будь-якої сили при отриманні пакетів, без
стиснення в обох напрямках та обмін ключами Group1.

` <?php/* Повідомляємо користувача, якщо сервер перервав з'єднання */function my_ssh_disconnect($reason, $message, $language) {  printf("Сервер відключився с кодом |
",         $reason, $message);}$methods u003d array( 'kex' u003d> 'diffie-hellman-group1-sha1',  'client_to_server' u003d> array(' c| c| ' u003d> 'none'), 'server_to_client' u003d> array(   'crypt' u003d> 'aes256-cbc,aes192-cbc,aes128-cbc',| 'disconnect' u003d> 'my_ssh_disconnect');$connection u003d ssh2_connect('shell.example.com', 22, $methods, $callbacks);if (!$connection) die('Не удалося встановити з'єднання'); `

### Дивіться також

- [ssh2_fingerprint()](function.ssh2-fingerprint.md) - Отримання
відбиток віддаленого сервера
- [ssh2_auth_none()](function.ssh2-auth-none.md) - Аутентифікація
як "none"
- [ssh2_auth_password()](function.ssh2-auth-password.md) -
Аутентифікація через SSH за допомогою звичайного пароля
- [ssh2_auth_pubkey_file()](function.ssh2-auth-pubkey-file.md) -
Аутентифікація з відкритим ключем
- [ssh2_disconnect()](function.ssh2-disconnect.md) - Закрити
з'єднання з віддаленим сервером SSH
