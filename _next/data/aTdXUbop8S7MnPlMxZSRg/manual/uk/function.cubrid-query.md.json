{"pageProps":{"page":{"slug":"function.cubrid-query.md","content":"# cubrid\\_query\n\n(PECL CUBRID >= 8.3.1)\n\ncubrid\\_query — Надсилання запиту CUBRID\n\n### Опис\n\n```methodsynopsis\ncubrid_query(string $query, resource $conn_identifier = ?): resource\n```\n\nФункция**cubrid\\_query()** посилає унікальний запит (множинні запити не підтримуються) поточної активної бази даних, заданої ідентифікатором з'єднання `conn_identifier`\n\n### Список параметрів\n\n`query`\n\nSQL-запит\n\nДані у запиті мають бути [коректно екрановані](function.cubrid-real-escape-string.md)\n\n`conn_identifier`\n\nІдентифікатор з'єднання. Якщо не встановлено, то буде використано останнє, відкрите за допомогою [cubrid\\_connect()](function.cubrid-connect.md)соединение.\n\n### Значення, що повертаються\n\nДля SELECT, SHOW, DESCRIBE, EXPLAIN та інших запитів, що повертають результуючий набір, **cubrid\\_query()** повертає resource у разі успішного виконання та \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\nДля інших типів SQL-запитів, INSERT, UPDATE, DELETE, DROP і т.д. **cubrid\\_query()** повертає **`true`** або **`false`** залежно від успішності виконання.\n\nПовернутий результат можна передавати у функцію [cubrid\\_fetch\\_array()](function.cubrid-fetch-array.md) і їй подібні до роботи з отриманими даними.\n\nИспользуйте[cubrid\\_num\\_rows()](function.cubrid-num-rows.md) для визначення кількості повернутих оператором SELECT рядків або [cubrid\\_affected\\_rows()](function.cubrid-affected-rows.md) для визначення кількості порушених рядків, для запитів, що змінюють дані, таких як DELETE, INSERT, REPLACE та UPDATE.\n\n**cubrid\\_query()** також може завершитися з помилкою та повернути **`false`**, якщо користувач не має права на доступ до таблиці, яка використовується у запиті.\n\n### Приклади\n\n**Приклад #1 Некоректний запит**\n\nНаступний запит містить синтаксичну помилку, тому **cubrid\\_query()** поверне **`false`**\n\n```php\n<?php\n$conn = cubrid_connect('localhost', 33000, 'demodb');\n\n$result = cubrid_query('SELECT * WHERE 1=1');\nif (!$result) {\n    die('Некорректный запрос: ' . cubrid_error());\n}\n\n?>\n```\n\n**Приклад #2 Коректний запит**\n\nНаступний запит коректний, тож **cubrid\\_query()** поверне ресурс.\n\n```php\n<?php\n// Какие нибудь значения\n$firstname = 'fred';\n$lastname  = 'fox';\n\n$conn = cubrid_connect('localhost', 33000, 'demodb');\n\ncubrid_execute($conn,\"DROP TABLE if exists friends\");\ncubrid_execute($conn,\"create table friends(firstname varchar,lastname varchar,address char(24),age int)\");\ncubrid_execute($conn,\"insert into friends values('fred','fox','home-1','20')\");\ncubrid_execute($conn,\"insert into friends values('blue','cat','home-2','21')\");\n// Сформулируем запрос\n// Это лучший путь для выполнения запроса\n// Другие Приклады смотрите cubrid_real_escape_string()\n$query = sprintf(\"SELECT firstname, lastname, address, age FROM friends WHERE firstname='%s' AND lastname='%s'\",\ncubrid_real_escape_string($firstname),\ncubrid_real_escape_string($lastname));\n\n// Выполняем запрос\n$result = cubrid_query($query);\n\n// Проверяем результат\n// Показывает сам запрос и ошибку. полезно при отладке.\nif (!$result) {\n    $message  = 'Некорректный запрос: ' . cubrid_error() . \"\\n\";\n    $message .= 'Всего запросов: ' . $query;\n    die($message);\n}\n\n// Используем результат\n// Попытка распечатать $result не позволит получить доступ к информации в ресурсе\n// Должна быть использована одна из функций cubrid\n// Смотрите cubrid_result(), cubrid_fetch_array(), cubrid_fetch_row() и т.д.\nwhile ($row = cubrid_fetch_assoc($result)) {\n    echo $row['firstname'];\n    echo $row['lastname'];\n    echo $row['address'];\n    echo $row['age'];\n}\n\n// Освобождаем ресурсы. В принципе можно и не делать, так как\n// они будут автоматически освобождены после завершения работы скрипта\ncubrid_free_result($result);\n?>\n```\n\n### Дивіться також\n\n-   [cubrid\\_connect()](function.cubrid-connect.md) \\- Відкриває з'єднання з сервером CUBRID\n-   [cubrid\\_error()](function.cubrid-error.md) \\- Повертає текст останньої помилки, що відбулася.\n-   [cubrid\\_real\\_escape\\_string()](function.cubrid-real-escape-string.md) \\- Екранування спеціальних символів у SQL-запиті\n-   [cubrid\\_result()](function.cubrid-result.md) \\- Отримати значення із заданого стовпця заданого рядка\n-   [cubrid\\_fetch\\_assoc()](function.cubrid-fetch-assoc.md) \\- Витягти рядок із результуючого набору у вигляді асоціативного масиву\n-   [cubrid\\_unbuffered\\_query()](function.cubrid-unbuffered-query.md) \\- Виконання запиту без завантаження результату на згадку\n","title":"cubrid\\_query","contentType":2,"navigation":[{"function.cubrid-ping.md":"« cubrid\\_ping"},{"function.cubrid-real-escape-string.md":"cubrid\\_real\\_escape\\_string »"},{"index.md":"PHP Manual"},{"cubridmysql.cubrid.md":"Функції сумісності CUBRID MySQL"}]}},"__N_SSG":true}