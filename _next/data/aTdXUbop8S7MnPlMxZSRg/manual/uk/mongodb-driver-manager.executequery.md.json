{"pageProps":{"page":{"slug":"mongodb-driver-manager.executequery.md","content":"# MongoDB\\\\Driver\\\\Manager::executeQuery\n\n(mongodb >=1.0.0)\n\nMongoDB\\\\Driver\\\\Manager::executeQuery — Виконує запит до бази даних\n\n### Опис\n\n```methodsynopsis\nfinal public MongoDB\\Driver\\Manager::executeQuery(string $namespace, MongoDB\\Driver\\Query $query, array|MongoDB\\Driver\\ReadPreference|null $options = null): MongoDB\\Driver\\Cursor\n```\n\nВибирає сервер відповідно до опції `\"readPreference\"` та виконує запит на цьому сервері. За промовчанням буде використовуватися перевага читання з URI [URI підключення MongoDB](mongodb-driver-manager.construct.md#mongodb-driver-manager.construct-uri)\n\n### Список параметрів\n\n`namespace`(string)\n\nПовністю певне ім'я (тобто . `\"databaseName.collectionName\"`\n\n`query` [MongoDB\\\\Driver\\\\Query](class.mongodb-driver-query.md)) .\n\nЗапит на виконання.\n\n`options`\n\n**options**\n\n| Опция | Тип | Опис |\n| --- | --- | --- |\n| readPreference | [MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md) |  |\n| Перевага читання, що використовується для вибору сервера для виконання операції. |  |  |\n\n| | session |[MongoDB\\\\Driver\\\\Session](class.mongodb-driver-session.md)\n\nСесія зв'язування з операцією.\n\n### Значення, що повертаються\n\nУ разі успішного виконання повертає [MongoDB\\\\Driver\\\\Cursor](class.mongodb-driver-cursor.md)\n\n### Помилки\n\n-   При помилці парсингу аргумент кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\InvalidArgumentException](class.mongodb-driver-exception-invalidargumentexception.md)\n-   При невдалому з'єднанні з сервером (крім помилок аутентифікації) кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\ConnectionException](class.mongodb-driver-exception-connectionexception.md)\n-   У разі невдалої аутентифікації кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\AuthenticationException](class.mongodb-driver-exception-authenticationexception.md)\n-   При виникненні інших помилок (наприклад, неправильні оператори запиту) викидає виняток[MongoDB\\\\Driver\\\\Exception\\\\RuntimeException](class.mongodb-driver-exception-runtimeexception.md)\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| PECL mongodb 1.4.0 | Третій параметр тепер є масивом `options`. . Для зворотної сумісності цей параметр все одно прийме об'єкт [MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md) |\n\n### Приклади\n\n**Приклад #1 Приклад використання** MongoDB\\\\Driver\\\\Manager::executeQuery()\\*\\*\\*\\*\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://localhost:27017\");\n\n$bulk = new MongoDB\\Driver\\BulkWrite;\n$bulk->insert(['x' => 1]);\n$bulk->insert(['x' => 2]);\n$bulk->insert(['x' => 3]);\n$manager->executeBulkWrite('db.collection', $bulk);\n\n$filter = ['x' => ['$gt' => 1]];\n$options = [\n    'projection' => ['_id' => 0],\n    'sort' => ['x' => -1],\n];\n\n$query = new MongoDB\\Driver\\Query($filter, $options);\n$cursor = $manager->executeQuery('db.collection', $query);\n\nforeach ($cursor as $document) {\n    var_dump($document);\n}\n\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nobject(stdClass)#6 (1) {\n  [\"x\"]=>\n  int(3)\n}\nobject(stdClass)#7 (1) {\n  [\"x\"]=>\n  int(2)\n}\n```\n\n**Приклад #2 Обмеження часу виконання запиту**\n\nОпция`\"maxTimeMS\"`класса[MongoDB\\\\Driver\\\\Query](class.mongodb-driver-query.md) може використовуватись для обмеження часу виконання запиту. Зауважте, що цей термін застосовується на стороні сервера і не враховує затримки мережі. Дивіться [» Завершення виконання операцій](https://www.mongodb.com/docs/manual/tutorial/terminate-running-operations/#maxtimems) у посібнику MongoDB для отримання додаткової інформації.\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager('mongodb://localhost:27017');\n\n$filter = ['x' => ['$gt' => 1]];\n$options = [\n    'maxTimeMS' => 1000,\n];\n\n$query = new MongoDB\\Driver\\Query($filter, $options);\n$cursor = $manager->executeQuery('db.collection', $query);\n\nforeach ($cursor as $document) {\n    var_dump($document);\n}\n\n?>\n```\n\nЯкщо запит не завершиться через секунду після початку виконання на сервері, буде викинуто виняток [MongoDB\\\\Driver\\\\Exception\\\\ExecutionTimeoutException](class.mongodb-driver-exception-executiontimeoutexception.md)\n\n### Дивіться також\n\n-   [MongoDB\\\\Driver\\\\Cursor](class.mongodb-driver-cursor.md)\n-   [MongoDB\\\\Driver\\\\Query](class.mongodb-driver-query.md)\n-   [MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md)\n-   [MongoDB\\\\Driver\\\\Server::executeQuery()](mongodb-driver-server.executequery.md) \\- Виконує запит до бази даних на сервері\n","title":"MongoDB\\\\Driver\\\\Manager::executeQuery","contentType":2,"navigation":[{"mongodb-driver-manager.executecommand.md":"« MongoDB\\\\Driver\\\\Manager::executeCommand"},{"mongodb-driver-manager.executereadcommand.md":"MongoDB\\\\Driver\\\\Manager::executeReadCommand »"},{"index.md":"PHP Manual"},{"class.mongodb-driver-manager.md":"MongoDB\\\\Driver\\\\Manager"}]}},"__N_SSG":true}