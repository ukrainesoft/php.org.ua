- [«Безпека](mongodb.security.md)
- [Атака за допомогою ін'єкцій у скриптах
»](mongodb.security.script_injection.md)

- [PHP Manual](index.md)
- [Безпека](mongodb.security.md)
- Атака за допомогою ін'єкцій у запиті

# Атака за допомогою ін'єкцій у запиті

Якщо ви передаєте параметри `$_GET` (або `$_POST`) своїм запитам,
переконайтеся, що вони спочатку наводяться до рядків. Користувачі можуть
вставляти асоціативні масиви в запити GET та POST, які потім
можуть стати небажаними $-запитами.

Досить невинний приклад. Припустимо, ви шукаєте інформацію про
користувачеві на запит *http://www.example.com?usernameu003dbob*. Ваше
програма створює запит
`$q u003d new \MongoDB\Driver\Query( [ 'username' u003d> $_GET['username'] ])`.

Хтось може підірвати це, отримавши
*http://www.example.com?username\[$ne\]u003dfoo*, який PHP чарівним
чином перетворить на асоціативний масив, перетворивши ваш запит на
`$q u003d new \MongoDB\Driver\Query( [ 'username' u003d> [ '$ne' u003d> 'foo' ] ] )`,
який поверне всіх користувачів, які не мають імені "foo" (ймовірно,
всіх ваших користувачів).

Від цієї атаки досить легко захиститись: переконайтеся, що параметри
$\_GET і $\_POST відповідають очікуваному типу, перш ніж надсилати їх
до бази даних. PHP має функцію
[filter_var()](function.filter-var.md), щоб допомогти з цим.

Зверніть увагу, що цей тип атаки може використовуватись з будь-яким
взаємодією з базою даних, що знаходить документ, включаючи
команди update, upserts, delete і findAndModify.

Дивіться [основну]
документацію](https://www.mongodb.com/docs/manual/security/) для
отримання додаткової інформації про проблеми SQL ін'єкцій у MongoDB.
