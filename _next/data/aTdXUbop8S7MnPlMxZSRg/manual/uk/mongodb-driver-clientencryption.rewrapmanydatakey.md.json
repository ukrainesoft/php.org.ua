{"pageProps":{"page":{"slug":"mongodb-driver-clientencryption.rewrapmanydatakey.md","content":"# MongoDB\\\\Driver\\\\ClientEncryption::rewrapManyDataKey\n\n(mongodb >=1.15.0)\n\nMongoDB\\\\Driver\\\\ClientEncryption::rewrapManyDataKey — Перевертає ключі даних\n\n### Опис\n\n```methodsynopsis\nfinal public MongoDB\\Driver\\ClientEncryption::rewrapManyDataKey(array|object $filter, ?array $options = null): object\n```\n\nПеревертає (тобто розшифровує та заново шифрує) нуль або більше ключів даних у колекції сховища ключів, які відповідають заданому фільтру (`filter`\n\nЯкщо опція `\"provider\"` не вказано, що збігаються ключі даних будуть повторно зашифровані за допомогою поточного постачальника KMS. В іншому випадку ключі даних, що збігаються, будуть зашифровані заново відповідно до зазначених опцій `\"provider\"`и`\"masterKey\"`\n\n### Список параметрів\n\n`filter`(array|object)\n\n[» Предикат запиту](https://www.mongodb.com/docs/manual/tutorial/query-documents/). Порожній предикат збігатиметься з усіма елементами колекції.\n\n> **Зауваження**: При обчисленні критеріїв запиту MongoDB порівнює типи та значення відповідно до власних [» правилами порівняння типів BSON](https://www.mongodb.com/docs/manual/reference/bson-type-comparison-order/), відмінних від правил [порівняння](types.comparisons.md) і [приведення типів](language.types.type-juggling.md) PHP. Коли вказано спеціальний тип BSON, критерій запиту має відповідати [класу BSON](book.bson.md) (тобто використовувати [MongoDB\\\\BSON\\\\ObjectId](class.mongodb-bson-objectid.md) для вибірки по [» ObjectId](https://www.mongodb.com/docs/manual/reference/bson-types/#objectid)\n\n`options`\n\n**Параметри RewrapManyDataKey**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| provider | string |  |\n| Провайдер KMS (наприклад, `\"local\"` `\"aws\"`), який буде використовуватися для повторного шифрування ключів даних, що збіглися. |  |  |\n\nЯкщо провайдер KMS не вказано, то ключі даних, що збігаються, будуть повторно зашифровані за допомогою поточного провайдера KMS.\n\n| | masterKey | array |\n\nПараметр masterKey визначає специфічний для KMS ключ, який використовується для шифрування нового ключа даних. Параметр не повинен вказуватись без параметра `\"provider\"`Параметр необходим, если указан`\"provider\"`, а не`\"local\"`\n\n**Параметри провайдера `\"aws\"`**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| region | Рядок | Обов'язковий. |\n| key | Рядок | Обов'язковий. Ім'я ресурсу Amazon (ARN) для ключового ключа клієнта AWS (CMK). |\n| endpoint | Рядок | Необов'язковий. Альтернативний ідентифікатор хоста для надсилання запитів KMS. Може містити номер порту. |\n\n**Параметри провайдера `\"azure\"`**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| keyVaultEndpoint | Рядок | Обов'язковий. Хост із необов'язковим портом (наприклад, \"example.vault.azure.net\"). |\n| keyName | Рядок | Обов'язковий. |\n| keyVersion | Рядок | Необов'язковий. Певна версія іменованого ключа. За промовчанням – первинна версія ключа. |\n\n**Параметри провайдера `\"gcp\"`**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| projectId | Рядок | Обов'язковий. |\n| location | Рядок | Обов'язковий. |\n| keyRing | Рядок | Обов'язковий. |\n| keyName | Рядок | Обов'язковий. |\n| keyVersion | Рядок | Необов'язковий. Певна версія іменованого ключа. За промовчанням – первинна версія ключа. |\n| endpoint | Рядок | Необов'язковий. Хост із додатковим портом. За промовчанням \"cloudkms.googleapis.com\".. |\n\n**Параметри провайдера `\"kmip\"`**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| keyId | Рядок | Необов'язковий. Унікальний ідентифікатор 96-байтового керованого об'єкта секретних даних KMIP. Якщо не вказано, драйвер створює випадковий 96-байтовий керований об'єкт секретних даних KMIP. |\n| endpoint | Рядок | Необов'язковий. Хост із додатковим портом. |\n\n### Значення, що повертаються\n\nПовертає об'єкт, який матиме необов'язкову властивість `bulkWriteResult`, содержащее результат внутренней операции`bulkWrite` як об'єкта. Якщо жоден ключ даних не відповідає фільтру або запис не був визнаний, властивість `bulkWriteResult` буде одно **`null`**\n\n### Помилки\n\n-   При помилці парсингу аргумент кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\InvalidArgumentException](class.mongodb-driver-exception-invalidargumentexception.md)\n-   При невдалому з'єднанні з сервером (крім помилок аутентифікації) кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\ConnectionException](class.mongodb-driver-exception-connectionexception.md)\n-   У разі невдалої аутентифікації кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\AuthenticationException](class.mongodb-driver-exception-authenticationexception.md)\n-   Викидає виняток [MongoDB\\\\Driver\\\\Exception\\\\EncryptionException](class.mongodb-driver-exception-encryptionexception.md), якщо при розшифруванні або повторному шифруванні ключа даних виникла помилка.\n-   Викидає виняток [MongoDB\\\\Driver\\\\Exception\\\\RuntimeException](class.mongodb-driver-exception-runtimeexception.md)у разі виникнення інших помилок.\n","title":"MongoDB\\\\Driver\\\\ClientEncryption::rewrapManyDataKey","contentType":2,"navigation":[{"mongodb-driver-clientencryption.removekeyaltname.md":"« MongoDB\\\\Driver\\\\ClientEncryption::removeKeyAltName"},{"class.mongodb-driver-serverapi.md":"MongoDB\\\\Driver\\\\ServerApi »"},{"index.md":"PHP Manual"},{"class.mongodb-driver-clientencryption.md":"MongoDB\\\\Driver\\\\ClientEncryption"}]}},"__N_SSG":true}