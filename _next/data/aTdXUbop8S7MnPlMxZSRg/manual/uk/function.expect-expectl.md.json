{"pageProps":{"page":{"slug":"function.expect-expectl.md","content":"# expect\\_expectl\n\n(PECL expect >= 0.1.0)\n\nexpect\\_expectl — Очікує, доки виведення потоку не співпаде з одним із шаблонів, або доки не закінчиться максимальний час очікування, або повернеться EOF\n\n### Опис\n\n```methodsynopsis\nexpect_expectl(resource $expect, array $cases, array &$match = ?): int\n```\n\nОчікує, поки виведення потоку не співпаде з одним із шаблонів, або поки не закінчиться максимальний час очікування, або повернеться EOF.\n\nЕсли задан параметр`match`, він заповнюється з результатами пошуку. Збіглий рядок буде збережено в `match[0]`. Підрядки, що збіглися (залежно від дужок) в оригінальному шаблоні будуть збережені в `match[1]` `match[2]`, вплоть до`match[9]`(ограничения libexpect).\n\n### Список параметрів\n\n`expect`\n\nПотік Expect, відкритий за допомогою [expect\\_popen()](function.expect-popen.md)\n\n`cases`\n\nМасив очікуваних значень. Кожне очікуване значення являє собою індексований масив, описаний у цій таблиці:\n\n**Expect Case Array**\n\n| Индекс | Тип значения | Опис | Обязательный | Значение по умолчанию |\n| --- | --- | --- | --- | --- |\n|  | string | шаблон, який порівнюватиметься з потоком виводу | так |  |\n|  | mixed | значення, яке поверне функція, якщо збіг знайдено | так |  |\n|  | integer | тип шаблону: [**`EXP_GLOB`**](expect.constants.md#constants.expect.exp-glob) [**`EXP_EXACT`**](expect.constants.md#constants.expect.exp-exact) або [**`EXP_REGEXP`**](expect.constants.md#constants.expect.exp-regexp) | ні | [**`EXP_GLOB`**](expect.constants.md#constants.expect.exp-glob) |\n\n### Значення, що повертаються\n\nПовертає значення, пов'язане з шаблоном, з яким воно збіглося.\n\nУ разі виникнення помилки функція поверне: [**`EXP_EOF`**](expect.constants.md#constants.expect.exp-eof) [**`EXP_TIMEOUT`**](expect.constants.md#constants.expect.exp-timeout) або [**`EXP_FULLBUFFER`**](expect.constants.md#constants.expect.exp-fullbuffer)\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| PECL expect 0.2.1 | До версії 0.2.1, параметр `match` повертався рядок, а не масив рядків, що збіглися. |\n\n### Приклади\n\n**Приклад #1 Приклад використання** expect\\_expectl()\\*\\*\\*\\*\n\n```php\n<?php\n// Копируем файлы с сервера:\nini_set(\"expect.timeout\", 30);\n\n$stream = fopen(\"expect://scp user@remotehost:/var/log/messages /home/user/messages.txt\", \"r\");\n\n$cases = array(\n    // array(шаблон, возвращаемов в случае совпадения значение)\n    array(\"password:\", \"asked for password\"),\n    array(\"yes/no)?\",  \"asked for yes/no\")\n);\n\nwhile (true) {\n    switch (expect_expectl($stream, $cases)) {\n        case \"asked for password\":\n            fwrite($stream, \"my password\\n\");\n            break;\n        case \"asked for yes/no\":\n            fwrite($stream, \"yes\\n\");\n            break;\n        case EXP_TIMEOUT:\n        case EXP_EOF:\n            break 2; // Прерывает как switch так и цикл while\n        default:\n            die(\"Произошла ошибка!\");\n    }\n}\n\nfclose($stream);\n?>\n```\n\n### Дивіться також\n\n-   [expect\\_popen()](function.expect-popen.md) \\- Запускає команду через командну оболонку Bourne та відкриває для процесу потік PTY\n","title":"expect\\_expectl","contentType":2,"navigation":[{"ref.expect.md":"« Функції Expect"},{"function.expect-popen.md":"expect\\_popen »"},{"index.md":"PHP Manual"},{"ref.expect.md":"Опції Expect"}]}},"__N_SSG":true}