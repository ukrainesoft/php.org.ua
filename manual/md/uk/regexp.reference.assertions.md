- [«Зворотні посилання](regexp.reference.back-references.md)
- [Одноразові підмаски »](regexp.reference.onlyonce.md)

- [PHP Manual](index.md)
- [Опис синтаксису Perl-сумісних регулярних
виразів](reference.pcre.pattern.syntax.md)
- Затвердження

## Затвердження

Затвердження - це перевірки щодо символів, що йдуть до або після
поточної позиції зіставлення, нічого при цьому не поглинаючи (ніякі
символи вихідного тексту не ставляться у відповідність до тверджень).
Найбільш прості варіанти тверджень, такі як , \B, \A, \Z, \z, ^ і
$ розглянуті в
[escape-послідовності](regexp.reference.escape.md). Більш складні
твердження записуються як підмаски. Затвердження бувають двох видів:
ті, що аналізують текст, наступний *після поточної позиції* (look
ahead), і той, що йде *перед нею* (look behind).

Зіставлення підмаски, що містить твердження, відбувається звичайним
чином, крім того, що поточна позиція не змінюється.
Твердження щодо *наступного тексту* починаються з (?u003d для
позитивних тверджень і с (?! для заперечних тверджень. Наприклад,
`\w+(?u003d;)` збігається зі словом, за яким слідує символ ';', але при
При цьому сама точка з комою в збіг не включається. А `foo(?!bar)`
відповідає будь-якій появі "foo", після якої не йде "bar".
Зауважимо, що схожий шаблон `(?!foo)bar` не шукатиме входження
"bar", якому передує будь-який рядок за винятком "foo". Але тим
не менше, він буде відповідати будь-яким входженням підрядки "bar",
оскільки умова (?!foo) завжди **`true`**, якщо наступні три
символ - "bar". Для отримання бажаного результату необхідно
скористатися другою категорією тверджень.

Затвердження щодо *попереднього тексту* починаються з (?\<u003d для
позитивних тверджень і (?\<! для заперечників. Наприклад,
`(?<!foo)bar` знайде входження "bar", яким не передує "foo".
Самі твердження 'назад' обмежені так, щоб усі підрядки, яким
вони відповідають, мали фіксовану довжину. Але, у випадку, якщо
використовуються кілька альтернатив, вони повинні мати однакову
довжину. Таким чином шаблон `(?<u003dbullock|donkey)` коректний, але
`(?<!dogs?|cats?)` викликає помилку під час компіляції. Гілки, які
відповідають рядкам різної довжини, дозволені лише на верхньому рівні
тверджень щодо попереднього тексту. Це розширення
щодо Perl 5.005, який вимагає, щоб усі гілки відповідали
рядків однакової довжини. Таке твердження як `(?<u003dab(c|de))` не
коректно, оскільки верхній рівень маски може відповідати рядкам
різної довжини, але його можна перетворити до коректного шаблону,
використовуючи альтернативи на верхньому рівні: `(?<u003dabc|abde)` Затвердження
щодо попереднього тексту реалізовані так, що для кожної
альтернативи поточна позиція тимчасово переноситься назад,
фіксовану ширину, після чого виконується пошук відповідності умові.
Якщо перед поточною позицією недостатньо символів, пошук
відповідності зазнає невдачі. Затвердження назад у поєднанні з
одноразовими підмасками можуть бути особливо зручні для пошуку в кінці
рядки; відповідний приклад наведено в кінці розділу "Одноразові
підмаски".

Декілька тверджень (різних типів) можуть бути присутніми у твердженні,
наприклад: `(?<u003d\d{3})(?<!999)foo` збігається з підрядком "foo", якою
передують три цифри, відмінні від "999". Слід розуміти, що кожне
на підставі тверджень перевіряється щодо однієї і тієї ж позиції в
оброблюваному тексті. Спочатку виконується перевірка того, що
попередні три символи - це цифри, потім перевіряється, щоб ці ж
цифри не були числом 999. Наведений вище шаблон відповідає
підрядку "foo", якій передують шість символів, перші три з
яких - цифри, а останні три не утворюють "999". Наприклад, він не
відповідає рядку "123abcfoo", тоді як шаблон
`(?<u003d\d{3}...)(?<!999)foo` відповідає.

У цьому випадку аналізуються попередні шість символів на предмет
того, щоб перші три з них були цифрами, а останні три не
утворили "999".

Затвердження можуть бути вкладеними, причому у довільних поєднаннях:
`(?<u003d(?<!foo)bar)baz` відповідає підрядку "baz", якій
передує "bar", перед якою, у свою чергу, немає "foo", а
`(?<u003d\d{3}...(?<!999))foo` - зовсім інший шаблон, відповідний
підрядку "foo", якому передують три цифри і три довільні
символ, відмінний від "999".

Тверді підмаски є незахоплюючими і неповторними,
оскільки безглуздо повторювати те саме кілька разів. Якщо в
твердженні довільного типу знаходиться захоплююча підмаска, вона
нумерується в тій же послідовності, що й інші
захоплюючі підмаски, але захоплення відповідних значень відбувається
тільки для позитивних тверджень, оскільки для тих, хто заперечує це
має сенсу.

У твердженнях обробляється трохи більше, ніж 200 захоплюючих підмасок.
