- [« Потоки введення/виводу](features.commandline.io-streams.md)
- [Вбудований веб-сервер »](features.commandline.webserver.md)

- [PHP Manual](index.md)
- [Використання PHP у командному рядку](features.commandline.md)
- Інтерактивна консоль

## Інтерактивна консоль

Модуль CLI SAPI надає інтерактивну консоль, використовуючи опцію
**-a**, якщо PHP було скомпільовано з опцією **--with-readline**. Починаючи
з PHP PHP 7.1.0, інтерактивна консоль також доступна на Windows, якщо
[модуль readline](book.readline.md) увімкнено.

Використовуючи інтерактивну консоль, можна ввести та виконати
безпосередньо PHP-код.

**Приклад #1 Запуск коду в інтерактивній консолі**

`` shellcode
$ php -a
Interactive shell

php > echo 5+8;
13
php > function addTwo($n)
php > {
php { return $n + 2;
php { }
php > var_dump(addtwo(2));
int(4)
php >
````

Інтерактивна консоль також автодоповнює (за допомогою кнопки Tab) імена
функцій, констант, класів, змінних, виклики статичних методів та
константи класів.

**Приклад #2 Автодоповнення за Tab**

Подвійне натискання клавіш Tab за наявності декількох варіантів доповнення
покаже список цих варіантів:

`` shellcode
php > strp[TAB][TAB]
strpbrk strpos strptime
php > strp
````

Коли є лише одне доповнення, одиночне натискання Tab доповнить
текст, що залишився, на тому ж рядку:

`` shellcode
php > strpt[TAB]ime(
````

Додаток також працює для імен, які були оголошені протягом
даної інтерактивної сесії:

`` shellcode
php > $fooThisIsAReallyLongVariableName u003d 42;
php > $foo[TAB]ThisIsAReallyLongVariableName
````

Інтерактивна консоль зберігає історію команд, доступ до якої можна
використовувати стрілки вгору та вниз. Історія зберігається у файлі
`~/.php_history`.

Модуль CLI SAPI надає дві нові налаштування в `php.ini`:
`cli.pager` та `cli.prompt`. Налаштування `cli.pager` дозволяє використовувати
зовнішню програму (таку як `less`) для посторінкового перегляду даних
замість їхнього прямого виведення на екран. Налаштування `cli.prompt` дозволяє
ставити запрошення `php>` на введення команди.

Також можна встановлювати налаштування `php.ini` в інтерактивній консолі,
використовуючи спеціальне скорочення.

**Приклад #3 Встановлення налаштування `php.ini` в інтерактивній консолі**

Налаштування `cli.prompt`:

`` shellcode
php > #cli.promptu003dhello world :>
hello world :>
````

Використовуючи зворотні апострофи можна задати PHP-код, який виконається в
запрошення на введення команди:

`` shellcode
php > #cli.promptu003d`echo date('H:i:s');` php >
15:49:35 php > echo 'hi';
hi
15:49:43 php > sleep(2);
15:49:45 php >
````

Установка `less` для посторінкового виведення даних:

`` shellcode
php > #cli.pageru003dless
php > phpinfo();
(output displayed in less)
php >
````

Налаштування `cli.prompt` підтримує кілька керуючих
послідовностей:

| Керуюча послідовність Опис |
|--------------------------------|---------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ------|
| `` | Використовується для додавання кольорів до запрошення на введення команди. Приклад: `[032m [031m [34m\>] [0m` |
| `` | Версія PHP. |
| `` | Відображає, в якій частині PHP ми знаходимося. Наприклад `/*` показує, що ми перебуваємо у багаторядковому коментарі. Зовнішня область видимості позначається як php. |
| `\>` | Вказує запрошення символ. За промовчанням це символ `>`, але можна змінити, коли оболонка знаходиться всередині незакритого блоку або рядка. Можливі символи: ``{ (>` |

**Управляючі послідовності `cli.prompt`**

> **Примітка**:
>
> Файли, підключені за допомогою опцій
> [auto_prepend_file](ini.core.md#ini.auto-prepend-file) та
> [auto_append_file](ini.core.md#ini.auto-append-file) обробляються
> у цьому режимі з деякими обмеженнями, наприклад, функції повинні
> бути оголошені до використання.

## Інтерактивний режим

Якщо модуль readline недоступний, то до PHP 8.1.0 виклик файлу CLI SAPI з
параметром **-a** забезпечував інтерактивний режим. У цьому режимі
передбачається, що повний скрипт PHP передається через STDIN, а після
завершення скрипт оцінюється за допомогою `CRTL+d` (POSIX) або `CTRL+z` з
наступним `ENTER` (Windows). По суті це те саме, що й виклик CLI
SAPI без параметра **-a**. option.

Починаючи з PHP 8.1.0, виклик CLI SAPI з параметром **-a** завершується
помилка, якщо модуль readline недоступний.
