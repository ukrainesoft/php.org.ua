{"pageProps":{"page":{"slug":"function.mysql-xdevapi-getsession.md","content":"# getSession\n\n(No version information available, might only be in Git)\n\ngetSession — Підключається до сервера MySQL\n\n### Опис\n\n```methodsynopsis\nmysql_xdevapi\\getSession(string $uri): mysql_xdevapi\\Session\n```\n\nПідключається до MySQL.\n\n### Список параметрів\n\n`uri`\n\nURI до сервера MySQL, як `mysqlx://user:password@host`\n\nФормат URI:\n\n`scheme://[user[:[password]]@]target[:port][?attribute1=value1&attribute2=value2...`\n\n-   `scheme`: обов'язковий протокол з'єднання\n    \n    У mysql\\_xdevapi це завжди 'mysqlx' (для X Protocol)\n    \n-   `user`: необов'язковий, обліковий запис користувача MySQL для автентифікації\n    \n-   `password`: необов'язковий пароль користувача MySQL для аутентифікації\n    \n-   `target`: обов'язковий екземпляр сервера, до якого відноситься з'єднання:\n    \n    \\*TCP-з'єднання (ім'я хоста, адреса IPv4 або IPv6)\n    \n    \\*Шлях до сокету Unix (локальний шлях до файлу)\n    \n    \\*Іменований канал Windows (локальний шлях до файлу)\n    \n-   `port`: необов'язковий мережевий порт сервера MySQL.\n    \n    за замовчуванням порт для X Protocol дорівнює 33060\n    \n-   `?attribute=value`: цей елемент є необов'язковим та визначає словник даних, який містить різні параметри, у тому числі:\n    \n    -   Атрибут`auth`(механізм аутентифікації), оскільки він відноситься до зашифрованих з'єднань. Для отримання додаткової інформації дивіться[» Параметри команди для зашифрованих з'єднань](https://dev.mysql.com/doc/refman/8.0/en/encrypted-connection-options.md). Підтримуються такі значення:`plain` `mysql41` `external`, и`sha256_mem`\n        \n    -   Атрибут`connect-timeout`впливає з'єднання, а чи не на наступні операції. Він встановлюється для кожного з'єднання на одному або кількох хостах.\n        \n        Введіть позитивне ціле число, щоб визначити час очікування з'єднання в секундах, або введіть 0 (нуль), щоб вимкнути час очікування (нескінченно). Не визначаючи час очікування на підключення, ви використовуєте значення за замовчуванням 10.\n        \n        Пов'язані, змінні середовища MYSQLX\\_CONNECTION\\_TIMEOUT (час очікування в секундах) та MYSQLX\\_TEST\\_CONNECTION\\_TIMEOUT (використовуються під час виконання тестів) можуть бути встановлені та використані замість connect-timeout з'єднання в URI. Параметр URI підключення до connect-timeout має пріоритет над змінними середовищами.\n        \n    -   Необов'язковий атрибут`compression`приймає такі значення:`preferred`(клієнт домовляється з сервером, щоб знайти підтримуваний алгоритм; з'єднання не стисло, якщо взаємно підтримуваний алгоритм не знайдено),`required` (як \"preferred\", але з'єднання розривається, якщо взаємно підтримуваний алгоритм не знайдено), або `disabled`(з'єднання не стисло). За замовчуванням використовується`preferred`\n        \n        Опцію було додано у версії 8.0.20.\n        \n    -   Необов'язковий атрибут`compression-algorithms`визначає бажані алгоритми стиснення (та їх кращий порядок використання):`zstd_stream`(псевдонім: zstd),`lz4_message`(псевдонім: lz4) або`deflate_stream`(псевдоніми: deflate чи zlib). За замовчуванням використовується порядок (залежно від доступності системи): lz4\\_message, zstd\\_stream, потім deflate\\_stream. Наприклад, під час передачі compression-algorithms=\\[lz4, zstd\\_stream\\]використовується lz4, якщо він доступний, інакше використовується zstd\\_stream. Якщо обидва недоступні, поведінка залежить від значення стиснення, наприклад, якщо compression=required, збій з помилкою.\n        \n        Опцію було додано у версії 8.0.22.\n        \n\n**Приклад #1 Приклади URI**\n\n```php\nmysqlx://foobar\nmysqlx://root@localhost?socket=%2Ftmp%2Fmysqld.sock%2F\nmysqlx://foo:bar@localhost:33060\nmysqlx://foo:bar@localhost:33160?ssl-mode=disabled\nmysqlx://foo:bar@localhost:33260?ssl-mode=required\nmysqlx://foo:bar@localhost:33360?ssl-mode=required&auth=mysql41\nmysqlx://foo:bar@(/path/to/socket)\nmysqlx://foo:bar@(/path/to/socket)?auth=sha256_mem\nmysqlx://foo:bar@[localhost:33060, 127.0.0.1:33061]\nmysqlx://foobar?ssl-ca=(/path/to/ca.pem)&ssl-crl=(/path/to/crl.pem)\nmysqlx://foo:bar@[localhost:33060, 127.0.0.1:33061]?ssl-mode=disabled\nmysqlx://foo:bar@localhost:33160/?connect-timeout=0\nmysqlx://foo:bar@localhost:33160/?connect-timeout=10&compression=required\nmysqlx://foo:bar@localhost:33160/?connect-timeout=10&compression=required&compression-algorithms=[lz4,zstd_stream]\n```\n\nДля получения дополнительной информации смотрите MySQL Shell[» Підключення з використанням рядка URI](https://dev.mysql.com/doc/refman/8.0/en/mysql-shell-connection-using-uri.md)\n\n### Значення, що повертаються\n\nОб'єкт **Session**\n\n### Помилки\n\nПомилка з'єднання викликає [Exception](class.exception.md)\n\n### Приклади\n\n**Приклад #2 Приклад використання** mysql\\_xdevapi\\\\getSession()\\*\\*\\*\\*\n\n```php\n<?php\ntry {\n    $session = mysql_xdevapi\\getSession(\"mysqlx://user:password@host\");\n} catch(Exception $e) {\n    die(\"Не удалось установить соединение: \" . $e->getMessage());\n}\n\n$schemas = $session->getSchemas();\nprint_r($schemas);\n\n$mysql_version = $session->getServerVersion();\nprint_r($mysql_version);\n\nvar_dump($collection->find(\"name = 'Alfred'\")->execute()->fetchOne());\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\nArray\n(\n    [0] => mysql_xdevapi\\Schema Object\n        (\n            [name] => helloworld\n        )\n    [1] => mysql_xdevapi\\Schema Object\n        (\n            [name] => information_schema\n        )\n    [2] => mysql_xdevapi\\Schema Object\n        (\n            [name] => mysql\n        )\n    [3] => mysql_xdevapi\\Schema Object\n        (\n            [name] => performance_schema\n        )\n    [4] => mysql_xdevapi\\Schema Object\n        (\n            [name] => sys\n        )\n)\n\n80012\n\narray(4) {\n  [\"_id\"]=>\n  string(28) \"00005ad66abf0001000400000003\"\n  [\"age\"]=>\n  int(42)\n  [\"job\"]=>\n  string(7) \"Butler\"\n  [\"name\"]=>\n  string(4) \"Alfred\"\n}\n```\n","title":"getSession","contentType":2,"navigation":[{"function.mysql-xdevapi-expression.md":"« expression"},{"class.mysql-xdevapi-baseresult.md":"mysql\\_xdevapi\\\\BaseResult »"},{"index.md":"PHP Manual"},{"ref.mysql-xdevapi.md":"Функції Mysql\\_xdevapi"}]}},"__N_SSG":true}