{"pageProps":{"page":{"slug":"function.com-event-sink.md","content":"# com\\_event\\_sink\n\n(PHP 4 >= 4.2.0, PHP 5, PHP 7, PHP 8)\n\ncom\\_event\\_sink — Зв'язати повідомлення COM з об'єктом PHP\n\n### Опис\n\n```methodsynopsis\ncom_event_sink(variant $variant, object $sink_object, array|string|null $sink_interface = null): bool\n```\n\nЗобов'язує об'єкт COM прокидати повідомлення, створені `variant` в об'єкт PHP `sink_object`\n\nБудьте обережні з цією можливістю. Якщо ви робитимете щось схоже на приклад нижче, то це не матиме жодного сенсу під час запуску в контексті веб-сервера.\n\n### Список параметрів\n\n`variant`\n\n`sink_object`\n\n`sink_object` повинен бути екземпляром класу з методами, названими як у вибраному диспетчерському інтерфейсі; ви можете використовувати функцію [com\\_print\\_typeinfo()](function.com-print-typeinfo.md)для помощи в генерации шаблона класса.\n\n`sink_interface`\n\nPHP намагатиметься використовувати тип диспетчерського інтерфейсу за промовчанням, як зазначено в бібліотеці типів, пов'язаної з `variant`, але ви можете змінити таку поведінку, поставивши в `sink_interface` ім'я бажаного диспетчерського інтерфейсу.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| 8.0.0 | `sink_interface` тепер допускає значення null. |\n\n### Приклади\n\n**Приклад #1 Приклад com\\_event\\_sink**\n\n```php\n<?php\nclass IEEventSinker {\n    var $terminated = false;\n\n   function ProgressChange($progress, $progressmax) {\n      echo \"Прогресс загрузки: $progress / $progressmax\\n\";\n    }\n\n    function DocumentComplete(&$dom, $url) {\n      echo \"Загрузка $url завершена\\n\";\n    }\n\n    function OnQuit() {\n      echo \"Quit!\\n\";\n      $this->terminated = true;\n    }\n}\n$ie = new COM(\"InternetExplorer.Application\");\n$sink = new IEEventSinker();\ncom_event_sink($ie, $sink, \"DWebBrowserEvents2\");\n$ie->Visible = true;\n$ie->Navigate(\"http://www.example.org\");\nwhile(!$sink->terminated) {\n  com_message_pump(4000);\n}\n$ie = null;\n?>\n```\n\n### Примітки\n\n**Застереження**\n\nДо PHP 8.0.0 виклик [exit()](function.exit.md) з будь-якого оброблювача події не підтримувався і міг призвести до зависання PHP. Це можна обійти, викидаючи виняток із обробника події, перехоплюючи виняток в основному коді та викликаючи звідти [exit()](function.exit.md)\n\n### Дивіться також\n\n-   [com\\_print\\_typeinfo()](function.com-print-typeinfo.md) \\- Друкує визначення класу PHP для інтерфейсу, що наслідує IDispatch\n-   [com\\_message\\_pump()](function.com-message-pump.md) \\- Обробка повідомлень COM, що прийшли не пізніше timeoutms мілісекунд після її запуску\n","title":"com\\_event\\_sink","contentType":2,"navigation":[{"function.com-create-guid.md":"« com\\_create\\_guid"},{"function.com-get-active-object.md":"com\\_get\\_active\\_object »"},{"index.md":"PHP Manual"},{"ref.com.md":"Функції COM"}]}},"__N_SSG":true}