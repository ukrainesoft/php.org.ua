- [« Нові глобальні константи](migration72.constants.md)
- [Функціонал, оголошений застарілим у PHP 7.2.x
»](migration72.deprecated.md)

- [PHP Manual](index.md)
- [Міграція з PHP 7.1.x на PHP 7.2.x](migration72.md)
- Зміни, що ламають зворотну сумісність

## Зміни, що ламають зворотну сумісність

### Запобігання поверненню негативного нуля з [number_format()](function.number-format.md)

Раніше функція [number_format()](function.number-format.md) повертала
`-0`. Хоча це абсолютно правильно відповідно до специфікації
чисел з плаваючою точкою IEEE 754, ця дивина небажана для
відображення відформатованих чисел у легкочитаній формі.

`<?phpvar_dump(number_format(-0.01)); // тепер виводить string(1) "0" замість string(2) "-0" `

### Перетворення числових ключів при приведенні об'єктів та масивів

Тепер числові ключі краще обробляються при приведенні масивів до
об'єктів та об'єктів до масивів (через явне приведення, або використовуючи
[settype()](function.settype.md)).

Це означає, що числові (або числа у вигляді рядків) ключі з масивів,
конвертовані в об'єкти тепер будуть доступні:

`<?php// приведення масиву к об'єкту$arr u003d [0 u003d> 1];$obj u003d (object)$arr;var_dump(   $obj,    $obj->{'0'},   ->{0} // тепер працює); `

Результат виконання цього прикладу:

object(stdClass)#1 (1) {
["0"]u003d> // тепер це рядковий ключ, а не числовий
int(1)
}
int(1)
int(1)

І тепер числові (або числа у вигляді рядків) ключі об'єктів доступні при
конвертації в масиви:

` <?php// приведення об'єкту в масив$obj u003d new class {    public function __construct()    {        $this->{0} u003d| } }; `

Результат виконання цього прикладу:

array(1) {
[0]u003d> // тепер це числовий ключ, а не рядковий
int(1)
}
int(1)
int(1)

### Заборонено передачу **`null`** в [get_class()](function.get-class.md)

Раніше передача **`null`** у функцію
[get_class()](function.get-class.md) повертала ім'я класу, з
якого було зроблено виклик. Ця поведінка була видалена і тепер замість
цього буде викликана помилка рівня **`E_WARNING`**. Для досягнення того
ж поведінки, як і раніше, слід просто опустити аргумент.

### Попередження при підрахунку нечисленних типів

Тепер при використанні [count()](function.count.md) з параметром,
який не можна порахувати буде виникати помилка рівня **`E_WARNING`**
(це також стосується [sizeof()](function.sizeof.md) як псевдоніма цієї
функції).

` <?phpvar_dump(    count(null), // NULL нельзя подсчитать    count(1), // числа нельзя подсчитать    count('abc'), // строки нельзя подсчитать    count(new stdclass), // объекты, не реализующие интерфейс Countable, не можна підрахувати count ([1,2]) // Масиви можна підрахувати); `

Результат виконання цього прикладу:

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d

Warning: count(): Parameter must be an array or an object that implements Countable in %s on line %d
int(0)
int(1)
int(1)
int(1)
int(2)

### Перехід від ресурсів до об'єктів у модулі Hash

В рамках довгострокової міграції відмови від ресурсів, модуль
[Hash](book.hash.md) було оновлено для використання об'єктів замість
ресурсів. Ця зміна повинна бути плавною для PHP-розробників,
винятком випадків, коли використовуються перевірки
[is_resource()](function.is-resource.md) (які потрібно замінити на
використання [is_object()](function.is-object.md)).

### Покращено значення за замовчуванням у SSL/TLS

Були зроблені такі зміни до значень за промовчанням:

- `tls://` тепер за замовчуванням використовується TLSv1.0 або TLSv1.1 або
TLSv1.2
- `ssl://` псевдонім `tls://`
- Константи `STREAM_CRYPTO_METHOD_TLS_*` за промовчанням рівні TLSv1.0
або TLSv1.1 + TLSv1.2 замість TLSv1.0

### Повертається значення [gettype()](function.gettype.md) для закритих ресурсів

Раніше використання [gettype()](function.gettype.md) на закритому
ресурсі повертало рядок "unknown type". Тепер буде повернуто
рядок ``resource (closed)``.

### [is_object()](function.is-object.md) та **\_\_PHP_Incomplete_Class**

Раніше використання [is_object()](function.is-object.md) на класі
**\_\_PHP_Incomplete_Class** повертало **`false`**. Тепер буде
повертатися **`true`**.

### Підвищено рівні помилок невизначених констант

Не повністю визначені посилання на невизначені константи тепер
генеруватимуть **`E_WARNING`** (замість **`E_NOTICE`**). У наступному
основної версії PHP вони будуть генерувати винятки
[Error](class.error.md).

### Підтримка Windows

Офіційно підтримувані мінімальні версії Windows тепер є
Windows 7/Server 2008 R2.

### Перевірка значень властивостей за промовчанням трейту

Перевірка сумісності значень властивостей за промовчанням трейту більше не
виконують наведення типу.

### `object` для імен класів

Ім'я `object` раніше було м'яко зарезервоване з PHP 7.0. Тепер воно
повноцінне зарезервоване слово, що забороняє використовувати його в
як ім'я класу, трейту або інтерфейсу.

### Підтримка NetWare

Підтримка NetWare була вилучена.

### [array_unique()](function.array-unique.md) with **`SORT_STRING`**

Якщо `sort_flags` дорівнює **`SORT_STRING`**, раніше масив `array`
копіювався, а не унікальні елементи видалялися (зберігаючи значення
цифрових індексів), але тепер створюється новий масив шляхом додавання
унікальні елементи. Це може призвести до різних числових індексів.

### Зміни [bcmod()](function.bcmod.md) з числами з плаваючою точкою

Функція [bcmod()](function.bcmod.md) більше не обрізає числа з
плаваючою точкою до цілих. Таким чином, її поведінка тепер
відповідає [fmod()](function.fmod.md), а не оператору `%`.
Наприклад, `bcmod('4', '3.5') тепер повертає `0.5` замість `1`.

### Функції хешування та некриптографічні хеші

Функції [hash_hmac()](function.hash-hmac.md),
[hash_hmac_file()](function.hash-hmac-file.md),
[hash_pbkdf2()](function.hash-pbkdf2.md) та
[hash_init()](function.hash-init.md) (з **`HASH_HMAC`**) більше не
приймають некриптографічні хеші.

### Опції функції [json_decode()](function.json-decode.md)

Опція функції [json_decode()](function.json-decode.md),
**`JSON_OBJECT_AS_ARRAY`**, тепер використовується, якщо другий параметр
(assoc) дорівнює **`null`**. Раніше **`JSON_OBJECT_AS_ARRAY`** завжди
ігнорувався.

### Висновок [rand()](function.rand.md) та [mt_rand()](function.mt-rand.md)

Числа, що генеруються [rand()](function.rand.md) та
[mt_rand()](function.mt-rand.md) для певного параметра
переініціалізації (seed), можуть відрізнятися від PHP 7.1 на 64-бітних
машинах (через виправлення помилки модульного зміщення у реалізації).

### Видалення ini-налаштування [`sql.safe_mode`](ini.core.md#ini.sql.safe-mode)

Налаштування конфігурації `sql.safe_mode` було видалено.

### Зміни в [date_parse()](function.date-parse.md) та [date_parse_from_format()](function.date-parse-from-format.md)

Елемент масиву `zone`, що повертається функціями
[date_parse_from_format()](function.date-parse-from-format.md) та
[date_parse()](function.date-parse.md) тепер відображає секунди
замість хвилин, яке знак інвертується. Наприклад, `-120` тепер буде
`7200`.

### Вхідні Cookies

Починаючи з PHP 7.2.34 *імена* вхідних cookie більше не декодуються з
URL-закодованого рядка з міркувань безпеки.
