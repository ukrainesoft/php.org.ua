- [«com](class.com.md)
- [dotnet »](class.dotnet.md)

- [PHP Manual](index.md)
- [com](class.com.md)
- Конструктор класу com

# com::\_\_construct

(PHP 4 \> 4.1.0, PHP 5, PHP 7, PHP 8)

com::\_\_construct — Конструктор класу com

### Опис

public **com::\_\_construct**(
string `$module_name`,
array\|string\|null `$server_name` u003d **`null`**,
int `$codepage` u003d **`CP_ACP`**,
string `$typelib` u003d ""
)

Створює об'єкт класу com.

### Список параметрів

`module_name`
ProgID, Class ID або Moniker, що вказує на компонент для завантаження.
Зазвичай ProgID це ім'я програми або DLL і ім'я об'єкта, розділені
точкою. Наприклад: `Word.Application`. Class ID – це UUID, унікальний
для заданого класу Moniker - спеціальна форма іменування, схожа на
концепції до URL, яка ідентифікує ресурс та спосіб його завантаження.
Наприклад, ви можете завантажити Word та отримати об'єкт, що представляє
документ, вказавши повний шлях до документа word як ім'я модуля, або ж
використовувати `LDAP:` як монікер для використання ADSI
інтерфейс до LDAP.

`server_name`
Ім'я сервера DCOM, на якому компонент має бути завантажений та запущений.
Якщо задано як **`null`**, об'єкт буде запущений на сервері
замовчуванням для програми. Зазвичай сервер за промовчанням – це локальний
комп'ютер, якщо адміністратор не налаштував інакше. Якщо для сервера
вказано значення відмінне від **`null`**, PHP не завантажуватиме об'єкт,
доки ви не встановите опцію конфігурації `php.ini`
[com.allow_dcom](com.configuration.md#ini.com.allow-dcom) у
**`true`**.

Якщо `server_name` заданий як масив, цей масив повинен містити
наступні елементи (реєстр символів важливий). Зверніть увагу, що вони
всі необов'язкові (єдине, що Username і Password повинні йти
парою); Якщо ви не вкажете Server, то буде обрано сервер за замовчуванням та
створення об'єкта не залежатиме від значення налаштування директиви
`php.ini` [com.allow_dcom](com.configuration.md#ini.com.allow-dcom).

| ключ | тип | опис |
|----------|---------|---------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------------------------|
| Server | string | Ім'я сервера. |
| Username | string | Ім'я користувача. |
| Password | string | Пароль для `Username`. |
| Domain | string | Домен для `server`. |
| Flags | integer | Одна або кілька констант, об'єднаних логічним АБО: **`CLSCTX_INPROC_SERVER`**, **`CLSCTX_INPROC_HANDLER`**, **`CLSCTX_LOCAL_SERVER`**, **`CLSCTX_REMOTE_SERVER`**, **`CLSCTX_SERVER`** * *`CLSCTX_ALL`**. Значення за умовчанням **`CLSCTX_SERVER`**, якщо `Server` не заданий і **`CLSCTX_REMOTE_SERVER`**, якщо заданий. Про призначення цих констант можна прочитати в документації Microsoft CoCreateInstance. Але насправді вони вам навряд чи знадобляться. |

**Ім'я сервера DCOM**

`codepage`
Кодова сторінка для перетворення на юнікод і назад. Конвертація
відбувається коли рядок PHP передається як параметр COM об'єкту і коли
від нього надходить відповідь. Зверніть увагу, що ця кодова сторінка
буде використовуватися для всіх об'єктів та варіантів, що повертаються даним
об'єктом. Допустимі значення: **`CP_ACP`** (Значення за замовчуванням).
Системна кодова сторінка ANSI), **`CP_MACCP`**, **`CP_OEMCP`**,
**`CP_SYMBOL`**, **`CP_THREAD_ACP`** (Використовувати кодову
сторінку/локаль, встановлену для запущеного потоку), **`CP_UTF7`** та
**`CP_UTF8`**. Також можна використовувати число, що означає кодову
сторінку. Подробиці читайте у документації Microsoft.
