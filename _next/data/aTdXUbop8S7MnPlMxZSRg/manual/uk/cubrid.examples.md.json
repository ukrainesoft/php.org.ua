{"pageProps":{"page":{"slug":"cubrid.examples.md","content":"# Приклади\n\nПростий приклад, у якому встановлюється з'єднання з CUBRID. У цьому розділі розповідається про самі базові речі та особливості, на які слід звернути увагу. Наступний код здійснюватиме з'єднання з CUBRID, що передбачає, що сервер та брокер CUBRID запущені.\n\nПриклад нижче використовує базу даних demodb, яка створюється за умовчанням під час встановлення. Переконайтеся, що її створено.\n\n**Приклад #1 Приклад отримання даних**\n\n```php\n<html>\n    <head>\n    <meta http-equiv=\"content-type\" content=\"text/html; charset=euc-kr\">\n    </head>\n    <body>\n    <center>\n    <table border=2>\n    <?php\n        /**\n         * Задаём информация для соединения. host_ip - это IP адрес,\n         * на котором запущен брокер CUBRID (наПриклад, localhost).\n         * host_port - соответственно его порт.\n         * Порт задаётся по умолчанию при установке.\n         * Подробности можно узнать в \"Administrator's Guide.\"\n         */\n        $host_ip = \"localhost\";\n        $host_port = 33000;\n        $db_name = \"demodb\";\n        /**\n         * Соединяемся с сервером CUBRID. Не производим фактического соединения, а\n         * только получаем информацию о нем. Причина, по которой мы не делаем\n         * фактического соединения в том, чтобы транзакции обрабатывались более\n         * эффективно в трёхзвенной архитектуре.\n         */\n        $cubrid_con = @cubrid_connect($host_ip, $host_port, $db_name);\n\n        if (!$cubrid_con) {\n            echo \"Ошибка подключения к базе данных\";\n            exit;\n        }\n    ?>\n    <?php\n        $sql = \"select sports, count(players) as players from event group by sports\";\n        /**\n         * Запрашиваем у сервера CUBRID результат SQL-запроса.\n         * Теперь производим фактическое соединение с сервером CUBRID.\n         */\n        $result = cubrid_execute($cubrid_con, $sql);\n\n        if ($result) {\n            /**\n             * Получаем имена столбцов из результирующего набора.\n             */\n            $columns = cubrid_column_names($result);\n            /**\n             * Получаем количество столбцов в результирующем наборе.\n             */\n            $num_fields = cubrid_num_cols($result);\n            /**\n             * Выводим имена столбцов на экран.\n             */\n            echo \"<tr>\";\n\n            while (list($key, $colname) = each($columns)) {\n                echo \"<td align=center>$colname</td>\";\n            }\n\n            echo \"</tr>\";\n\n            /**\n             * получаем результаты из результирующего набора.\n             */\n            while ($row = cubrid_fetch($result)) {\n                echo \"<tr>\";\n\n                for ($i = 0; $i < $num_fields; $i++) {\n                    echo \"<td align=center>\";\n                    echo $row[$i];\n                    echo \"</td>\";\n                }\n\n                echo \"</tr>\";\n            }\n        }\n        /**\n         * Модуль PHP в CUBRID работает в трёхуровневой архитектуре. Даже когда\n         * вызывается SELECT для обработки транзакций, он обрабатывается как часть\n         * транзакции. action. Следовательно, транзакцию надо либо подтвердить, либо\n         * откатить, даже когда вызывается SELECT.\n         */\n        cubrid_commit($cubrid_con);\n        cubrid_disconnect($cubrid_con);\n    ?>\n    </body>\n    </html>\n```\n\n**Приклад #2 Приклад вставки даних**\n\n```php\n<html>\n    <head>\n    <meta http-equiv=\"content-type\" content=\"text/html; charset=euc- kr\">\n    </head>\n    <body>\n    <center>\n    <table border=2>\n    <?php\n        /**\n         * host_ip - IP адрес сервера, где установлен брокер CUBRID\n         * host_port - порт, на котором он слушает\n         * db_name - имя базы данных CUBRID\n         */\n        $host_ip = \"localhost\";\n        $host_port = 33000;\n        $db_name = \"demodb\";\n        $cubrid_con = @cubrid_connect($host_ip, $host_port, $db_name);\n\n        if (!$cubrid_con) {\n            echo \"Ошибка подключения к базе данных\";\n            exit;\n        }\n    ?>\n    <?php\n        $sql = \"insert into olympic (host_year,host_nation,host_city,\"\n            . \"opening_date,closing_date) values (2008, 'China', 'Beijing',\"\n            . \"to_date('08-08-2008','mm-dd- yyyy'),to_date('08-24-2008','mm-dd-yyyy')) ;\";\n        $result = cubrid_execute($cubrid_con, $sql);\n        if ($result) {\n            /**\n             * Обработали успешно, можно фиксировать.\n             */\n            cubrid_commit($cubrid_con);\n            echo \"Inserted successfully\";\n        } else {\n            /**\n             * Произошла ошибка, значит выводим её на экран и откатываемся.\n             */\n            echo cubrid_error_msg();\n            cubrid_rollback($cubrid_con);\n        }\n        cubrid_disconnect($cubrid_con);\n    ?>\n    </body>\n    </html>\n```\n","title":"Приклади","contentType":2,"navigation":[{"cubrid.constants.md":"« Зумовлені константи"},{"ref.cubrid.md":"Функції CUBRID »"},{"index.md":"PHP Manual"},{"book.cubrid.md":"CUBRID"}]}},"__N_SSG":true}