- [« Робота зі з'єднаннями OCI8 та Connection
Pooling] (oci8.connection.md)
- [Підтримка прозорого для програм відновлення після відмови
(Transparent Application Failover або TAF) для OCI8
»](oci8.taf.md)

- [PHP Manual](index.md)
- [OCI8](book.oci8.md)
- Підтримка OCI8 Fast Application Notification (FAN)

# Підтримка OCI8 Fast Application Notification (FAN)

Підтримка FAN забезпечує швидке перепідключення у разі збоїв, що
забезпечує високу доступність бази даних Oracle. Ця
функціональність дозволяє PHP OCI8 скрипту отримувати оповіщення у разі
якщо база даних або сервер, на якому вона запущена, стають
недоступні. Без FAN, OCI8 може підвиснути, доки не буде перевищено
час очікування підключення та повернена помилка, що може зайняти
кілька хвилин. Дозвіл FAN в OCI8 дозволяє програмам визначати
такі помилки та перепідключатися до доступного екземпляра бази даних без
очікування відповіді від недоступної бази.

Підтримка FAN доступна, якщо клієнтські бібліотеки Oracle, з якими
зібраний PHP, і база даних Oracle мають версію 10gR2 або пізнішу.

FAN дає переваги користувачам кластерної технології Oracle (RAC),
оскільки підключення до доступної бази даних може бути зроблено
миттєво. Користувачі Oracle Data Guard із брокером можуть спостерігати
події FAN, створені при переході резервної бази в режим основної.
Окремі встановлені екземпляри бази даних надсилатимуть події
FAN під час свого перезапуску.

Для активних з'єднань, коли сервер або екземпляр бази стають
недоступні, буде повернено помилку з'єднання для поточної запущеної
функції модуля OCI8. При наступному перепідключенні PHP-скрипту буде
встановлено з'єднання з діючим екземпляром бази даних. Також
модуль OCI8 прозоро зачищає всі очікувані з'єднання, які торкнулися
падінням сервера або бази даних, так що нові з'єднання будуть
нормально встановлюватися без огляду на будь-які проблеми із сервісом.

Якщо [oci8.events](oci8.configuration.md#ini.oci8.events) встановлено
як `On`, то передбачається, що
[oci8.ping_interval](oci8.configuration.md#ini.oci8.ping-interval)
встановлено в значення -1, оскільки включення подій FAN надає
проактивне керування з'єднаннями, що очікують.

Щоб увімкнути підтримку FAN у PHP OCI8, зберіть PHP OCI8 з бібліотеками
Oracle 10gR2 або пізнішими і виконайте такі кроки:

- під обліковим записом привілейованого адміністратора баз даних, з
за допомогою програм типу SQL\*Plus дозвольте сервісу бази надсилати
оповіщення FAN, наприклад:
SQL> execute dbms_service.modify_service(
SERVICE_NAME u003d> 'sales',
AQ_HA_NOTIFICATIONS u003d> TRUE);
- Додайте до php.ini
oci8.events u003d On
- Якщо програма не обробляє помилки з'єднання OCI8,
модифікуйте його таким чином, щоб обробляло та виробляло,
наприклад, перепідключення та перезапуск запитів.
- Запустіть програму з'єднуючись з базою даних Oracle версії 10gR2
або вище.
