- [«stream_socket_accept](function.stream-socket-accept.md)
- [stream_socket_enable_crypto
»](function.stream-socket-enable-crypto.md)

- [PHP Manual](index.md)
- [Функції для роботи з потоками](ref.stream.md)
- Відкрити з'єднання з інтернет-сокетом або доменним сокетом Unix

#stream_socket_client

(PHP 5, PHP 7, PHP 8)

stream_socket_client — Відкрити з'єднання з інтернет-сокетом або з
доменним сокетом Unix

### Опис

**stream_socket_client**(
string `$address`,
int `&$error_code` u003d **`null`**,
string `&$error_message` u003d **`null`**,
?float `$timeout` u003d **`null`**,
int `$flags` u003d **`STREAM_CLIENT_CONNECT`**,
?resource `$context` u003d **`null`**
): resource \ | false

Починає з'єднання потоку або датаграми з віддаленим сокетом, вказаним
параметром `address`. Тип сокету, що створюється, визначається за
транспорту, вказаному з використанням стандартного форматування URL:
`transport://target`. Для інтернет-сокетів, (AF_INET) таких, як TCP та
UDP, частина `target` параметра `address` має складатися з імені хоста
або IP-адреси, за якою слідує двокрапка та номер порту. Для доменних
сокетів Unix, частина `target` повинна вказувати на файл сокету у файловій
системі.

> **Примітка**:
>
> За замовчуванням потік буде відкритий у режимі блокування. Ви можете
> переключити його на неблокуючий режим, використовуючи функцію
> [stream_set_blocking()](function.stream-set-blocking.md).

### Список параметрів

`address`
Адреса дистанційного сокету для з'єднання.

`error_code`
Буде надано номер системної помилки, якщо з'єднання не вдалося
встановити.

`error_message`
Буде надано повідомлення про системну помилку, якщо з'єднання не вдалося
встановити.

`timeout`
Число секунд, протягом яких має відбутися час очікування
системного виклику `connect()`. За замовчуванням використовується значення
[default_socket_timeout](filesystem.configuration.md#ini.default-socket-timeout).

> **Примітка**: Цей параметр застосовується лише якщо не відбувається
> Спроба асинхронного з'єднання.

> **Примітка**:
>
> Щоб вказати час очікування для читання/запису даних через сокет,
> Використовуйте функцію
> [stream_set_timeout()](function.stream-set-timeout.md), оскільки
> параметр `timeout` застосовується лише при створенні з'єднання через
> Сокет.

`flags`
Поле бітової маски, яке може набувати значення будь-якої комбінації
прапори з'єднання. В даний час набір прапорів з'єднання обмежений
наступними значеннями **`STREAM_CLIENT_CONNECT`** (за замовчуванням),
**`STREAM_CLIENT_ASYNC_CONNECT`** та **`STREAM_CLIENT_PERSISTENT`**.

`context`
Ресурс контексту, що діє, створений за допомогою функції
[stream_context_create()](function.stream-context-create.md).

### Значення, що повертаються

У разі успішного виконання повертається ресурс потоку, який може
використовувати з іншими файловими функціями (такими, як
[fgets()](function.fgets.md), [fgetss()](function.fgetss.md),
[fwrite()](function.fwrite.md), [fclose()](function.fclose.md), та
[feof()](function.feof.md)), у разі виникнення помилки
повертається **`false`**.

### Помилки

У разі невдалого виклику функції аргументи `error_code` та
`error_message` будуть заповнені системною помилкою, що сталася при
системний виклик `connect()`. Якщо значення, повернене в аргументі
`error_code` дорівнює `0` і функція повернула значення **`false`**, це
означає, що помилка сталася до виклику `connect()`. Це відбулося
швидше за все через проблему ініціалізації сокету. Зауважте,
що аргументи `error_code` та `error_message` завжди будуть передаватися
за посиланням.

### Список змін

| Версія | Опис |
|--------|---------------------------------------- ---------------|
| 8.0.0 | `timeout` та `context` тепер допускають значення null. |

### Приклади

**Приклад #1 Приклад використання **stream_socket_client()****

` <?php$fp u003d stream_socket_client("tcp://www.example.com:80", $errno, $errstr, 30);if (!$fp) {    echo "$errstr ($errno)< >
";} else {   fwrite($fp, "GET / HTTP/1.0
Host: www.example.com
Accept: */*

");   while (!feof($fp)) {        echo fgets($fp, 1024);    }   fclose($fp);}?> `

**Приклад #2 Використання UDP-з'єднання**

Отримання дня та часу від UDP-сервісу "daytime" (порт 13) на localhost.

` <?php$fp u003d stream_socket_client("udp://127.0.0.1:13", $errno, $errstr);if (!$fp) {    echo "ПОМИЛКА: $errno - $
";} else {   fwrite($fp, "
");   echofread($fp, 26);   fclose($fp);}?> `

### Примітки

**Увага**

UDP-сокети іноді можуть відкриватися без помилки, навіть якщо віддалений хост
недоступний. Помилка стане помітною тільки коли ви читатимете або
писати дані з/в сокет. Причина цього в тому, що UDP – це протокол
без з'єднання, що означає, що операційна система не намагається
встановити з'єднання з сокетом доти, доки їй насправді
не потрібно надсилати або отримати дані.

> **Примітка**: Якщо вказувати числову адресу IPv6 (наприклад,
> `fe80::1`) ви повинні укладати його у квадратні дужки. Наприклад,
> `tcp://[fe80::1]:80`.

> **Примітка**:
>
> Залежно від оточення, Unix-домени або довільний час
> очікування з'єднання можуть бути недоступними. Список доступних
> транспортів можна отримати використовуючи функцію
> [stream_get_transports()](function.stream-get-transports.md).
> Дивіться список вбудованих транспортів на сторінці [Список
> підтримуваних транспортних протоколів](transports.md).

### Дивіться також

- [stream_socket_server()](function.stream-socket-server.md) -
Створює інтернет-сокет або доменний сокет Unix
- [stream_set_blocking()](function.stream-set-blocking.md) -
Встановити блокуючий/неблокуючий режим у потоці
- [stream_set_timeout()](function.stream-set-timeout.md) -
Встановити час очікування для потоку
- [stream_select()](function.stream-select.md) - Запускає
еквівалент системного виклику select() на заданих масивах потоків
з часом очікування, вказаним параметрами seconds та microseconds
- [fgets()](function.fgets.md) - Читає рядок із файлу
- [fgetss()](function.fgetss.md) - Читає рядок з файлу та видаляє
HTML-теги
- [fwrite()](function.fwrite.md) - Бінарно-безпечний запис у файл
- [fclose()](function.fclose.md) - Закриває відкритий дескриптор
файлу
- [feof()](function.feof.md) - Перевіряє, чи кінець файлу досягнуто
- [Функції cURL](ref.curl.md)
