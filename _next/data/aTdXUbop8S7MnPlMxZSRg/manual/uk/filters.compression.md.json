{"pageProps":{"page":{"slug":"filters.compression.md","content":"## Компресійні фільтри\n\nВ той час як [Компресійні обгортки](wrappers.compression.md) забезпечують спосіб створення gzip-і bz2-сумісних файлів у локальній файловій системі, вони не надають загальних засобів для компресії в мережевих потоках, як і не надають засобів для створення потоку без компресії з подальшим перетворенням на компресований. Для цього до будь-яких потокових ресурсів у будь-який час можуть застосовуватися компресійні фільтри.\n\n> **Зауваження**: Компресійні фільтри. *не* генерують заголовків та закінчень, які використовують утиліти командного рядка, такі як `gzip`. Вони просто компресують (стискають) і декомпресують (розтискають) порції даних у потіку даних, що компресується.\n\n## zlib.deflate та zlib.inflate\n\n`zlib.deflate`(компрессия) и`zlib.inflate` (декомпресія) є реалізаціями методів стиснення, описаних у [» RFC 1951](http://www.faqs.org/rfcs/rfc1951). `deflate` приймає три аргументи, передані у вигляді асоціативного масиву . `level` визначає, який рівень компресії використати (1-9). Підвищення цього значення призведе до зменшення обсягів даних рахунок збільшення часу обробки. Існують також два спеціальні рівні компресії: 0 (для відключення компресії) і -1 (внутрішнє значення за замовчуванням бібліотеки zlib - на поточний момент дорівнює 6) . `window` - це логарифм із основою 2 від розміру вікна діапазону стиснення. Високі значення (аж до 15 - 32768 байт) призводять до поліпшення компресії рахунок збільшення необхідної пам'яті, тоді як низькі значення (аж до 9 - 512 байт) призводять до погіршення компресії рахунок зменшення необхідної пам'яті. Значення аргументу `window`по умолчанию на текущий момент является\\*\\*`15`\\*\\*. . `memory` визначає масштаб пам'яті, що резервується. Допустимі значення знаходяться в діапазоні від 1 (мінімальне резервування) до 9 (максимальне резервування). Таке резервування пам'яті впливає лише на швидкість і не впливає на розмір даних, що генеруються.\n\n> **Зауваження**: Так як рівень компресії є найбільш часто використовуваним аргументом, ви можете передати тільки його як звичайне ціле число (integer), замість того щоб передавати масив з одного елемента.\n\nкомпресійні фільтри zlib.\\* доступні, якщо активовано підтримку [zlib](ref.zlib.md)\n\n**Приклад #1`zlib.deflate`и`zlib.inflate`**\n\n```php\n<?php\n$params = array('level' => 6, 'window' => 15, 'memory' => 9);\n\n$original_text = \"This is a test.\\nThis is only a test.\\nThis is not an important string.\\n\";\necho \"Оригинальный текст длиной \" . strlen($original_text) . \" символов.\\n\";\n\n$fp = fopen('test.deflated', 'w');\nstream_filter_append($fp, 'zlib.deflate', STREAM_FILTER_WRITE, $params);\nfwrite($fp, $original_text);\nfclose($fp);\n\necho \"Сжатый файл размером \" . filesize('test.deflated') . \" байт.\\n\";\necho \"Оригинальный текст:\\n\";\n/* Использование readfile и zlib.inflate для декомпресии на лету */\nreadfile('php://filter/zlib.inflate/resource=test.deflated');\n\n/* Генерирует вывод:\n\nОригинальный текст длиной 70 символов.\nСжатый файл размером 56 байт.\nОригинальный текст:\nThis is a test.\nThis is only a test.\nThis is not an important string.\n\n */\n?>\n```\n\n**Приклад #2 Спрощене використання `zlib.deflate`**\n\n```php\n<?php\n$original_text = \"This is a test.\\nThis is only a test.\\nThis is not an important string.\\n\";\necho \"Оригинальный текст длиной \" . strlen($original_text) . \" символов.\\n\";\n\n$fp = fopen('test.deflated', 'w');\n/* Здесь \"6\" указывает уровень компрессии 6 */\nstream_filter_append($fp, 'zlib.deflate', STREAM_FILTER_WRITE, 6);\nfwrite($fp, $original_text);\nfclose($fp);\n\necho \"Сжатый файл размером \" . filesize('test.deflated') . \" байт.\\n\";\n\n/* Генерирует вывод:\n\nОригинальный текст длиной 70 символов.\nСжатый файл размером 56 байт.\n\n */\n?>\n```\n\n## bzip2.compress та bzip2.decompress\n\n`bzip2.compress`и`bzip2.decompress` працюють так само, як і фільтри zlib, описані вище. Фільтр `bzip2.compress` приймає два аргументи у вигляді елементів асоціативного масиву: `blocks` є цілим (integer) значенням в діапазоні від 1 до 9 і вказує на кількість 100-кілобайтових блоків пам'яті для резервування в якості робочого простору . `work` - це так само ціле чисельне (integer) значення в діапазоні від 0 до 250, що визначає скільки зусиль потрібно витратити на звичайний метод компресії перед перемиканням на повільний, але більш надійний метод. Зміна цього параметра впливає лише швидкість компресії. Ні розмір стисненого результату, ні обсяг пам'яті, що використовується, не змінюються за допомогою цієї настройки. Значення 0 вказує бібліотеці bzip використовувати власне внутрішнє значення за промовчанням. Фільтр `bzip2.decompress` приймає лише один аргумент, який може бути переданий або як звичайне boolean-значення, або як елемент `small`ассоциативного массива. Когда`small`установлен в\\*\\*`true`\\*\\*, бібліотека bzip зробить декомпресію з мінімальною витратою пам'яті рахунок зниження швидкості.\n\nКомпресійні фільтри bzip2\\* доступні, якщо активовано підтримку [bz2](ref.bzip2.md)\n\n**Приклад #3`bzip2.compress`и`bzip2.decompress`**\n\n```php\n<?php\n$param = array('blocks' => 9, 'work' => 0);\n\necho \"Оригинальный файл размером \" . filesize('LICENSE') . \" байт.\\n\";\n\n$fp = fopen('LICENSE.compressed', 'w');\nstream_filter_append($fp, 'bzip2.compress', STREAM_FILTER_WRITE, $param);\nfwrite($fp, file_get_contents('LICENSE'));\nfclose($fp);\n\necho \"Сжатый файл размером \" . filesize('LICENSE.compressed') . \" байт.\\n\";\n\n/* Генерирует вывод:\n\nОригинальный файл размером 3288 байт.\nСжатый файл размером 1488 байт.\n\n */\n?>\n```\n","title":"Компресійні фільтри","contentType":2,"navigation":[{"filters.convert.md":"« Перетворювальні фільтри"},{"filters.encryption.md":"Фільтри, що шифрують »"},{"index.md":"PHP Manual"},{"filters.md":"Список доступних фільтрів"}]}},"__N_SSG":true}