{"pageProps":{"page":{"slug":"soapclient.construct.md","content":"# SoapClient::\\_\\_construct\n\n(PHP 5, PHP 7, PHP 8)\n\nSoapClient::\\_\\_construct - Конструктор класу SoapClient\n\n### Опис\n\npublic **SoapClient::\\_\\_construct**(?string`$wsdl`, array`$options` \\[\\]) .\n\nСтворює об'єкт [SoapClient](class.soapclient.md)для подключения к службе SOAP.\n\n### Список параметрів\n\n`wsdl`\n\nURI WSDL-файлу, який описує сервіс, який використовується для автоматичного налаштування клієнта. Якщо він не вказаний, клієнт працюватиме в режимі без WSDL. mode.\n\n> **Зауваження** :\n> \n> За промовчанням файл WSDL кешуватиметься для підвищення продуктивності. Щоб вимкнути або налаштувати кешування, див. розділ Опції налаштування SOAP та [параметр`cache_wsdl`](soapclient.construct.md#soapclient.construct.options.cache-wsdl)\n\n`options`\n\nАсоціативний масив, що визначає додаткові параметри клієнта SOAP. Якщо вказано параметр `wsdl`, це необов'язково, в іншому випадку, принаймні параметри `location`и`url` мають бути вказані.\n\n`location`string\n\nURL-адреса сервера SOAP для надсилання запиту.\n\nОбязателен, если параметр`wsdl` не вказано. Якщо надано і параметр `wsdl`и`location`, параметр`location` буде пріоритетнішим за розташування, зазначене у WSDL-файлі.\n\n`uri`string\n\nЦільовий простір імен SOAP.\n\nОбязателен, если параметр`wsdl` не вказано; інакше ігнорується.\n\n`style`int\n\nВизначає стиль зв'язування, який використовуватиме клієнт, використовуючи константи **`SOAP_RPC`** і **`SOAP_DOCUMENT`**Константа**`SOAP_RPC`** вказує на прив'язку у стилі RPC, де тіло запиту SOAP містить стандартне кодування виклику функції. Константа **`SOAP_DOCUMENT`** вказує на прив'язку в стилі документа, де тіло запиту SOAP містить документ XML з певною службою значенням.\n\nЕсли указан параметр`wsdl`, цей параметр ігнорується, а стиль зчитується з WSDL-файлу.\n\nЯкщо ні цей параметр, ні параметр `wsdl` не вказано, використовується стиль RPC.\n\n`use`int\n\nВизначає стиль кодування, який використовуватиметься клієнтом, використовуючи константи **`SOAP_ENCODED`** або **`SOAP_LITERAL`**Константа**`SOAP_ENCODED`** вказує на кодування з використанням типів, визначених у специфікації SOAP. Константа **`SOAP_LITERAL`** вказує на кодування з використанням схеми певною службою.\n\nЕсли указан параметр`wsdl`, цей параметр ігнорується, а кодування зчитується з файлу WSDL.\n\nЯкщо ні цей параметр, ні параметр `wsdl` не вказано, використовується стиль \"encoded\".\n\n`soap_version`int\n\nВизначає версію протоколу SOAP: Константа \\*\\*`SOAP_1_1`**для SOAP 1.1, или**`SOAP_1_2`\\*\\*для SOAP 1.2.\n\nЯкщо опущено, використовується SOAP 1.1.\n\n`authentication`int\n\nВказує метод аутентифікації під час використання HTTP-аутентифікації у запитах. Значення може бути або **`SOAP_AUTHENTICATION_BASIC`**, либо\\*\\*`SOAP_AUTHENTICATION_DIGEST`\\*\\*\n\nЯкщо параметр не вказано, але вказано параметр `login`використовується Basic Authentication.\n\n`login`string\n\nІм'я користувача для використання під час аутентифікації HTTP Basic або Digest.\n\n`password`string\n\nПароль для використання під час аутентифікації HTTP Basic або Digest.\n\nНе слід плутати з параметром `passphrase`, який використовується для автентифікації сертифіката клієнта HTTPS.\n\n`local_cert`string\n\nШлях до сертифіката клієнта для використання з автентифікацією HTTPS. Має бути файл у кодуванні PEM, що містить сертифікат і закритий ключ.\n\nФайл також може включати ланцюжок емітентів, який повинен йти після сертифіката клієнта.\n\nТакож може бути задано за допомогою параметра [`stream_context`](soapclient.construct.md#soapclient.construct.options.stream-context), який також підтримує вказівку окремого файлу закритого ключа.\n\n`passphrase`string\n\nКлючевая фраза для клиентского сертификата, указанного в параметре`local_cert`\n\nНе слід плутати з параметром `password`який використовується для аутентифікації Basic або Digest.\n\nМожно также установить с помощью параметра[`stream_context`](soapclient.construct.md#soapclient.construct.options.stream-context)\n\n`proxy_host`string\n\nІм'я хоста для використання як проксі-сервер для HTTP-запитів.\n\nТакож має бути зазначений параметр `proxy_port`\n\n`proxy_port`int\n\nTCP-порт для использования при подключении к прокси-серверу, указанному в параметре`proxy_host`\n\n`proxy_login`string\n\nНеобов'язкове ім'я користувача для аутентифікації на проксі-сервері, вказаному у параметрі `proxy_host`за допомогою HTTP Basic Authentication.\n\n`proxy_password`string\n\nНеобов'язковий пароль для аутентифікації на проксі-сервері, вказаному у параметрі `proxy_host`за допомогою HTTP Basic Authentication.\n\n`compression`int\n\nВключає стиснення HTTP SOAP запитів та відповідей.\n\nЗначення має бути побітовим АБО з трьох частин: необов'язкова \\*\\*`SOAP_COMPRESSION_ACCEPT`\\*\\*для надсилання заголовка \"Accept-Encoding\"; або константа **`SOAP_COMPRESSION_GZIP`** або **`SOAP_COMPRESSION_DEFLATE`** для вказівки використовуваного алгоритму стискування; число від 1 до 9, щоб вказати рівень стиснення, який використовуватиметься у запиті. Наприклад, щоб увімкнути двосторонній стиск gzip з максимальним рівнем стиснення, використовуйте `SOAP_COMPRESSION_ACCEPT | SOAP_COMPRESSION_GZIP | 9`\n\n`encoding`string\n\nВизначає внутрішнє кодування символів. Запити завжди надсилаються в UTF-8 і перетворюються на це кодування і назад.\n\n`trace`bool\n\nЗахоплює інформацію про запит та відповідь, яка потім може бути доступна за допомогою методів: [SoapClient::\\_\\_getLastRequest()](soapclient.getlastrequest.md) [SoapClient::\\_\\_getLastRequestHeaders()](soapclient.getlastrequestheaders.md) [SoapClient::\\_\\_getLastResponse()](soapclient.getlastresponse.md) і [SoapClient::\\_\\_getLastResponseHeaders()](soapclient.getlastresponseheaders.md)\n\nЕсли опущено, по умолчанию используется значение\\*\\*`false`\\*\\*\n\n`classmap`array\n\nВикористовується для зіставлення типів, визначених у WSDL із класами PHP. Має бути вказаний асоціативний масив (array) з іменами типів з WSDL як ключі та іменами класів PHP як значень. Зверніть увагу, що назва типу елемента не обов'язково збігається з ім'ям елемента (тега).\n\nНадані імена класів завжди повинні бути повністю визначені за допомогою будь-яких [просторів імен](language.namespaces.md) і ніколи не повинні починатися з ведучого слєша (`\\`). Правильна форма може бути вказана за допомогою [::class](language.oop5.basic.md#language.oop5.basic.class.class)\n\nЗверніть увагу, що при створенні класу конструктор не викликатиметься, але магічні методи [\\_\\_set()](language.oop5.overloading.md#object.set) і [\\_\\_get()](language.oop5.overloading.md#object.get) будуть викликатися окремих властивостей.\n\n`typemap`array\n\nВикористовується для визначення зіставлень типів за допомогою визначених користувачем callback-функцій. Кожне зіставлення типів повинно бути масивом з ключами. `type_name` (Рядок (string), що визначає тип елемента XML); `type_ns` (рядок (string), що містить простір імен URI); `from_xml` [callable](language.types.callable.md), що приймає один рядковий параметр і повертає об'єкт) і `to_xml` [callable](language.types.callable.md), що приймає один об'єктний параметр і повертає рядок).\n\n`exceptions`bool\n\nВизначає, чи помилки викидатимуть виняток типу [SoapFault](class.soapfault.md)\n\nПо умолчанию значение\\*\\*`true`\\*\\*\n\n`connection_timeout`int\n\nВизначає час очікування в секундах для підключення до SOAP. Параметр не визначає час очікування служб із повільними відповідями. Щоб обмежити час очікування завершення дзвінків, можна налаштувати конфігурацію. [default\\_socket\\_timeout](filesystem.configuration.md#ini.default-socket-timeout)\n\n`cache_wsdl`int\n\nЕсли указан параметр`wsdl`, а также параметр[soap.wsdl\\_cache\\_enabled](soap.configuration.md#ini.soap.wsdl-cache-enabled) Увімкнено, цей параметр визначає тип кешування. Одне із значень: **`WSDL_CACHE_NONE`** **`WSDL_CACHE_DISK`** **`WSDL_CACHE_MEMORY`** або **`WSDL_CACHE_BOTH`**\n\nДоступні два типи кешу: кешування у пам'яті, яке кешує WSDL у пам'яті поточного процесу та дискове кешування, яке кешує WSDL у файлі на диску, що поділяється між усіма процесами. Каталог, який використовуватиметься для дискового кешу, визначається параметром [soap.wsdl\\_cache\\_dir](soap.configuration.md#ini.soap.wsdl-cache-dir)Оба кеша используют одинаковое время жизни, определяемое параметром[soap.wsdl\\_cache\\_ttl](soap.configuration.md#ini.soap.wsdl-cache-ttl). У кеша в пам'яті також є максимальна кількість записів, що визначається параметром [soap.wsdl\\_cache\\_limit](soap.configuration.md#ini.soap.wsdl-cache-limit)\n\nЯкщо не вказано, використовуватиметься параметр конфігурації [soap.wsdl\\_cache](soap.configuration.md#ini.soap.wsdl-cache)\n\n`user_agent`string\n\nЗначение для использования в HTTP-заголовке`User-Agent` під час виконання запитів.\n\nМожно также установить с помощью параметра[`stream_context`](soapclient.construct.md#soapclient.construct.options.stream-context)\n\nЯкщо не вказано, User-Agent буде `\"PHP-SOAP/\"` за яким слідує значення **`PHP_VERSION`**\n\n`stream_context`resource\n\nКонтекст[stream context](context.md), створений за допомогою функції [stream\\_context\\_create()](function.stream-context-create.md), яка дає змогу встановити додаткові параметри.\n\nКонтекст може містити [параметри контексту сокету](context.socket.md) [параметри контексту SSL](context.ssl.md), а також вибрані [опції контексту HTTP](context.http.md) `content_type` `header` `max_redirects` `protocol_version`, и`user_agent`\n\nЗверніть увагу, що наступні заголовки HTTP генеруються автоматично або на основі інших параметрів і будуть ігноруватися, якщо вказані в параметрі контексту `'header'` `host` `connection` `user-agent` `content-length` `content-type` `cookie` `authorization`и`proxy-authorization`\n\n`features`int\n\nБітова маска для включення однієї або кількох таких функцій:\n\n**`SOAP_SINGLE_ELEMENT_ARRAYS`**\n\nПри декодуванні відповіді масив за замовчуванням визначається, чи з'являється ім'я елемента один чи кілька разів у певному батьківському елементі. Для елементів, які з'являються лише один раз, властивість об'єкта дозволяє отримати прямий доступ до вмісту; для елементів, які з'являються більше одного разу, властивість містить масив із вмістом кожного відповідного елемента.\n\nЯкщо увімкнено функцію **`SOAP_SINGLE_ELEMENT_ARRAYS`**, елементи, які з'являються лише один раз, поміщаються в одноелементний масив, щоб доступ був послідовним для всіх елементів. Це буде працювати лише при використанні WSDL, що містить схему відповіді. Для демонстрації дивіться розділ із прикладами.\n\n**`SOAP_USE_XSI_ARRAY_TYPE`**\n\nЯкщо [параметру`use`](soapclient.construct.md#soapclient.construct.options.use)или свойству WSDL передано значение`encoded`, масиви примусово використовують тип `SOAP-ENC:Array`, а чи не специфічний для схеми.\n\n**`SOAP_WAIT_ONE_WAY_CALLS`**\n\nОчікування відповіді, навіть якщо WSDL вказує на односторонній запит.\n\n`keep_alive`bool\n\nЛогічне значення, що визначає, чи слід надсилати заголовок `Connection: Keep-Alive`или`Connection: close`\n\nПо умолчанию\\*\\*`true`\\*\\*\n\n`ssl_method`string\n\nВизначає версію протоколу SSL або TLS для використання у захищених з'єднаннях HTTP замість узгодження за промовчанням. Вказівка **`SOAP_SSL_METHOD_SSLv2`** або **`SOAP_SSL_METHOD_SSLv3`** змусить використовувати SSL 2 або SSL 3 відповідно. Вказівка ​​константи **`SOAP_SSL_METHOD_SSLv23`** немає сенсу; константа існує лише зворотної сумісності. Починаючи з PHP 7.2, вказівка ​​константи **`SOAP_SSL_METHOD_TLS`** також немає сенсу; у попередніх версіях константа визначала примусове використання TLS 1.0.\n\nЗверніть увагу, що SSL версій 2 і 3 вважаються небезпечними і можуть не підтримуватись встановленою бібліотекою OpenSSL.\n\nПараметр оголошено *Застарілим*починаючи з PHP 8.1.0. Більш гнучкою альтернативою, яка дозволяє вказувати окремі версії TLS, можна використовувати параметр [`stream_context`](soapclient.construct.md#soapclient.construct.options.stream-context) з параметром контексту 'crypto\\_method'.\n\n**Приклад #1 Вказівка ​​використання тільки TLS 1.3**\n\n```php\n<?php\n$context = stream_context_create([\n    'ssl' => [\n        'crypto_method' => STREAM_CRYPTO_METHOD_TLSv1_3_CLIENT\n     ]\n]);\n$client = new SoapClient(\"some.wsdl\", ['context' => $context]);\n```\n\n### Помилки\n\nМетод**SoapClient::\\_\\_construct()** виводить помилку рівня **`E_ERROR`**, якщо параметри `location`и`uri` не вказано у режимі не-WSDL.\n\nВикидається виняток [SoapFault](class.soapfault.md), якщо параметр `wsdl` URI не може бути завантажено.\n\n### Приклади\n\n**Приклад #2 Приклад використання** SoapClient::\\_\\_construct()\\*\\*\\*\\*\n\n```php\n<?php\n\n$client = new SoapClient(\"some.wsdl\");\n\n$client = new SoapClient(\"some.wsdl\", array('soap_version'   => SOAP_1_2));\n\n$client = new SoapClient(\"some.wsdl\", array('login'          => \"some_name\",\n                                            'password'       => \"some_password\"));\n\n$client = new SoapClient(\"some.wsdl\", array('proxy_host'     => \"localhost\",\n                                            'proxy_port'     => 8080));\n\n$client = new SoapClient(\"some.wsdl\", array('proxy_host'     => \"localhost\",\n                                            'proxy_port'     => 8080,\n                                            'proxy_login'    => \"some_name\",\n                                            'proxy_password' => \"some_password\"));\n\n$client = new SoapClient(\"some.wsdl\", array('local_cert'     => \"cert_key.pem\"));\n\n$client = new SoapClient(null, array('location' => \"http://localhost/soap.php\",\n                                     'uri'      => \"http://test-uri/\"));\n\n$client = new SoapClient(null, array('location' => \"http://localhost/soap.php\",\n                                     'uri'      => \"http://test-uri/\",\n                                     'style'    => SOAP_DOCUMENT,\n                                     'use'      => SOAP_LITERAL));\n\n$client = new SoapClient(\"some.wsdl\",\n  array('compression' => SOAP_COMPRESSION_ACCEPT | SOAP_COMPRESSION_GZIP | 9));\n\n$client = new SoapClient(\"some.wsdl\", array('encoding'=>'ISO-8859-1'));\n\nclass MyBook {\n    public $title;\n    public $author;\n}\n\n$client = new SoapClient(\"books.wsdl\", array('classmap' => array('book' => \"MyBook\")));\n\n$typemap = array(\n    array(\"type_ns\"  => \"http://schemas.example.com\",\n         \"type_name\" => \"book\",\n         \"from_xml\"  => \"unserialize_book\",\n         \"to_xml\"    => \"serialize_book\")\n);\n$client = new SoapClient(\"books.wsdl\", array('typemap' => $typemap));\n\n?>\n```\n\n**Приклад #3 Приклад використання** `SOAP_SINGLE_ELEMENT_ARRAYS`\\*\\*\\*\\*\n\n```php\n/* Предполагая, что ответ, подобный этому, и соответствующий WSDL:\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns=\"urn:example\">\n    <SOAP-ENV:Body>\n        <response>\n            <collection>\n                <item>Single</item>\n            </collection>\n            <collection>\n                <item>First</item>\n                <item>Second</item>\n            </collection>\n        </response>\n    </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>\n*/\n\necho \"По умолчанию:\\n\";\n\n$client = new TestSoapClient(__DIR__ . '/temp.wsdl');\n$response = $client->exampleRequest();\nvar_dump( $response->collection[0]->item );\nvar_dump( $response->collection[1]->item );\n\necho \"\\nС помощью SOAP_SINGLE_ELEMENT_ARRAYS:\\n\";\n\n$client = new TestSoapClient(__DIR__ . '/temp.wsdl', ['features' => SOAP_SINGLE_ELEMENT_ARRAYS]);\n$response = $client->exampleRequest();\nvar_dump( $response->collection[0]->item );\nvar_dump( $response->collection[1]->item );\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nПо умолчанию:\nstring(6) \"Single\"\narray(2) {\n  [0] =>\n  string(5) \"First\"\n  [1] =>\n  string(6) \"Second\"\n}\n\nС помощью SOAP_SINGLE_ELEMENT_ARRAYS:\narray(1) {\n  [0] =>\n  string(6) \"Single\"\n}\narray(2) {\n  [0] =>\n  string(5) \"First\"\n  [1] =>\n  string(6) \"Second\"\n}\n```\n","title":"SoapClient::\\_\\_construct","contentType":2,"navigation":[{"soapclient.call.md":"« SoapClient::\\_\\_call"},{"soapclient.dorequest.md":"SoapClient::\\_\\_doRequest »"},{"index.md":"PHP Manual"},{"class.soapclient.md":"SoapClient"}]}},"__N_SSG":true}