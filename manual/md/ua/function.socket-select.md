- [«socket_recvmsg](function.socket-recvmsg.md)
- [socket_send »](function.socket-send.md)

- [PHP Manual](index.md)
- [Функції сокету](ref.sockets.md)
- Запускає системний виклик select() для заданих масивів сокетів з
вказаним часом очікування

# socket_select

(PHP 4 \>u003d 4.1.0, PHP 5, PHP 7, PHP 8)

socket_select — Запуск системного виклику select() для заданих масивів
сокетів із зазначеним часом очікування

### Опис

**socket_select**(
?array `&$read`,
?array `&$write`,
?array `&$except`,
?int `$seconds`,
int `$microseconds` u003d 0
): int\|false

**socket_select()** приймає масиви сокетів і чекає їх зміни
статусу. Ті, хто знайомий із сокетами BSD, виявлять, що масиви сокетів
насправді є так званими наборами дескрипторів файлів.
Спостерігаються три незалежні масиви ресурсів сокетів.

### Список параметрів

`read`
Сокети, перелічені в масиві `read` будуть спостерігатися для перегляду
є доступні символи для читання ( точніше, щоб бачити, чи не буде
читання блокуватися, зокрема, сокет вже досяг кінця файлу, і в
цьому випадку [socket_read()](function.socket-read.md) поверне рядок з
нульовою довжиною).

`write`
Сокети, перелічені в масиві `write` будуть спостерігатися для перегляду,
чи запис блокуватиметься.

`except`
Сокети, перераховані в масиві `except` будуть спостерігатися для
винятків.

`seconds`
`seconds` та `microseconds` разом утворюють параметр `timeout`. Параметр
`timeout` - максимальний проміжок часу до повернення
**socket_select()**. `seconds` може бути нулем, змушуючи
**socket_select()** до негайного повернення. Це корисно для опитування.
Якщо `seconds` дорівнює **`null`** (немає часу очікування),
**socket_select()** може блокуватися нескінченно.

`microseconds`

**Увага**

При завершенні масиви змінюються для позначення, який сокет насправді
справі змінив статус.

Не потрібно передавати кожен масив **socket_select()**. Ви можете
пропустити його і використовувати порожній масив або **`null`** замість цього.
Також не забувайте, що ці масиви передаються за посиланням і будуть
змінено після завершення **socket_select()**.

> **Примітка**:
>
> Через обмеження поточного двигуна Zend неможливо передати модифікатор
> константи, такий як **`null`**, безпосередньо як параметр
> у функцію, яка очікує, що цей параметр буде передано за посиланням.
> Натомість використовуйте тимчасову змінну або вираз, де ліва
> сторона є тимчасовою змінною:
>
> **Приклад #1 Використання **`null`** у **socket_select()****
>
> ` <?php$e u003d NULL;socket_select($r, $w, $e, 0);?> `

### Значення, що повертаються

У разі успішного виконання **socket_select()** повертає кількість
сокетів, що містяться в змінених масивах, яке може бути рівним
нулю, якщо час очікування закінчиться до того, як станеться щось
цікаве. У разі виникнення помилки повертається **`false`**. Код
помилки може бути отримано за допомогою
[socket_last_error()](function.socket-last-error.md).

> **Примітка**:
>
> Обов'язково використовуйте оператор `u003du003du003d` під час перевірки помилки.
> Оскільки **socket_select()** може повертати 0, порівняння з `u003du003d`
> оцінюватиметься як **`true`**:
>
> **Приклад #2 Аналіз результату **socket_select()****
>
> ` <?php$e u003d NULL;if (false u003du003du003d socket_select($r, $w, $e, 0)) {    echo "Невдалий виклик socket_select(), причина: " . socket_strerror(socket_last_error()) . "
";}?> `

### Приклади

**Приклад #3 Приклад використання **socket_select()****

`<?php/* Підготувати масив сокетів для читання */$read    u003d array($socket1, $socket2);$write  u003d NULL;$except u003d NULL;$num_changed_$ );if ($num_changed_sockets u003du003du003d false) {    /* Обработка ошибок */} else if ($num_changed_sockets > 0) {    /* По крайней мере, в одном из сокетов произошло что-то интересное */}?> `

### Примітки

> **Примітка**:
>
> Майте на увазі, що деякі реалізації сокетів необхідно
> обробляти дуже обережно. Декілька основних правил:
>
> - Ви завжди повинні спробувати використати **socket_select()** без
> Час очікування. Ваша програма нічого не повинна робити, якщо ні
> Доступні дані. Код, що залежить від часу очікування, звичайно не
> дуже переносимий і важкий для налагодження.
> - Сокет не повинен додаватися до будь-якого з масивів, якщо ви не
> збираєтеся перевіряти результат після дзвінка **socket_select()**.
> Після повернення **socket_select()** всі сокети у всіх масивах
> повинні бути перевірені. Будь-який сокет, доступний для запису або
> читання, повинен використовуватися для запису чи читання.
> - Якщо ви читаєте або записуєте з сокету, який повертається в
> масивах, майте на увазі, що він необов'язково зможе прочитати або
> записати дані, що повністю запитуються вами. Будьте готові
> прочитати або записати лише один байт.
> - Зазвичай для більшості реалізацій сокетів єдине
> виняток, спійманий за допомогою масиву `except` - це дані без
> прив'язки, отримані у сокеті.

### Дивіться також

- [socket_read()](function.socket-read.md) - Читає рядок
максимальну довжину байт із сокету
- [socket_write()](function.socket-write.md) - Запис у сокет
- [socket_last_error()](function.socket-last-error.md) - Повертає
останню помилку на сокеті
- [socket_strerror()](function.socket-strerror.md) - Повертає
рядок, що описує помилку сокету
