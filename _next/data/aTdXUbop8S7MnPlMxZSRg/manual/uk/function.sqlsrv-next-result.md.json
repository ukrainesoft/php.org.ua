{"pageProps":{"page":{"slug":"function.sqlsrv-next-result.md","content":"# sqlsrv\\_next\\_result\n\n(No version information available, might only be in Git)\n\nsqlsrv\\_next\\_result — Робить активним наступний результат вказаного оператора\n\n### Опис\n\n```methodsynopsis\nsqlsrv_next_result(resource $stmt): mixed\n```\n\nРобить активним наступний результат вказаного оператора. Результати включають набори результатів, кількість рядків та вихідні параметри.\n\n### Список параметрів\n\n`stmt`\n\nОператор, яким викликається наступний результат.\n\n### Значення, що повертаються\n\nПовертає \\*\\*`true`**якщо наступний результат був успішно отриманий, **`false`**, если произошла ошибка и**`null`\\*\\*якщо результатів для отримання більше немає.\n\n### Приклади\n\n**Приклад #1 Приклад використання** sqlsrv\\_next\\_result()\\*\\*\\*\\*\n\nУ наступному прикладі виконується пакетний запит, який додає записи таблицю, а потім вибирає дані з таблиці. Це дає два результати оператора: один для рядків, на які впливає INSERT, і один для рядків, які повертаються SELECT. Щоб перейти до рядків, які повертаються SELECT, необхідно викликати **sqlsrv\\_next\\_result()**, щоб пройти повз перший результат.\n\n```php\n<?php\n$serverName = \"serverName\\sqlexpress\";\n$connectionInfo = array(\"Database\"=>\"dbName\", \"UID\"=>\"userName\", \"PWD\"=>\"password\");\n$conn = sqlsrv_connect( $serverName, $connectionInfo);\n\n$query = \"INSERT INTO Table_1 (id, data) VALUES (?,?); SELECT * FROM TABLE_1;\";\n$params = array(1, \"some data\");\n$stmt = sqlsrv_query($conn, $query, $params);\n\n// Использовать первый результат (строки, затронутые INSERT) без вызова sqlsrv_next_result.\necho \"Затронуто строк: \".sqlsrv_rows_affected($stmt).\"<br />\";\n\n// Переход к следующему результату и отображение результатов.\n$next_result = sqlsrv_next_result($stmt);\nif( $next_result ) {\n   while( $row = sqlsrv_fetch_array( $stmt, SQLSRV_FETCH_ASSOC)){\n      echo $row['id'].\": \".$row['data'].\"<br />\";\n   }\n} elseif( is_null($next_result)) {\n     echo \"Больше строк нет.<br />\";\n} else {\n     die(print_r(sqlsrv_errors(), true));\n}\n?>\n```\n\n### Дивіться також\n\n-   [sqlsrv\\_query()](function.sqlsrv-query.md) \\- готує та виконує запит\n-   [sqlsrv\\_fetch\\_array()](function.sqlsrv-fetch-array.md) \\- Повертає рядок як масив\n-   [sqlsrv\\_rows\\_affected()](function.sqlsrv-rows-affected.md) \\- Повертає кількість рядків, змінених останнім виконаним запитом INSERT, UPDATE чи DELETE\n","title":"sqlsrv\\_next\\_result","contentType":2,"navigation":[{"function.sqlsrv-has-rows.md":"« sqlsrv\\_has\\_rows"},{"function.sqlsrv-num-fields.md":"sqlsrv\\_num\\_fields »"},{"index.md":"PHP Manual"},{"ref.sqlsrv.md":"Функції SQLSRV"}]}},"__N_SSG":true}