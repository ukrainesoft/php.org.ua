- [«PHP та HTML](faq.md.md)
- [Різні питання »](faq.misc.md)

- [PHP Manual](index.md)
- [FAQ.md)
- PHP та COM

# PHP та COM

PHP може бути використаний для доступу до об'єктів COM та DCOM на
платформи Win32.

1. [Я зібрав DLL для деяких обчислень. Чи можна запустити цю DLL
з PHP?](#faq.com.q1)
2. [Що означає 'Unsupported variant type: xxxx (0xxxxx)'?](#faq.com.q2)
3. [ Чи можливе маніпулювання візуальними об'єктами в
PHP?](#faq.com.q3)
4. [Чи можу я зберігати об'єкт COM у сесії?](#faq.com.q4)
5. [Як я можу зловити помилки COM?](#faq.com.q5)
6. [Чи можна генерувати DLL-файли з PHP-скриптів так, як це можна
робити в Perl?](#faq.com.q6)
7. [Що означає 'Unable to obtain IDispatch interface for CLSID
{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}'?](#faq.com.q7)
8. [Як можна запускати COM-об'єкти з віддаленого сервера?](#faq.com.q8)
9. [Я отримую 'DCOM is disabled in C:\path...\scriptname.php on line
6 ', що робити?] (#faq.com.q9)
10. [Чи можливо за допомогою PHP завантажити/маніпулювати об'єктом ActiveX
на сторінці?](#faq.com.q10)
11. [Чи можливо отримати екземпляр, що виконується
компонента?](#faq.com.q11)
12. [Чи є спосіб обробити подію, надіслану об'єктом
COM?](#faq.com.q12)
13. [У мене виникають проблеми при спробі викликати метод об'єкта COM,
який надає більш ніж один інтерфейс. Що я можу
зробити?](#faq.com.q13)
14. [Отже PHP працює з COM, як щодо COM+?](#faq.com.q14)
15. [Якщо PHP може маніпулювати COM-об'єктами, можна уявити
собі використання MTS для управління ресурсами компонентів
з'єднанні з PHP?](#faq.com.q15)

**Я зібрав DLL для деяких обчислень. Чи можна запустити цю DLL із PHP?**
Якщо це проста DLL, то поки що немає можливості викликати її з PHP.
Якщо DLL містить COM-сервер, то ви можете отримати доступ до неї, якщо
вона реалізує інтерфейс IDispatch.



**Що означає 'Unsupported variant type: xxxx (0xxxxx)'?**
Існують дюжини типів VARIANT та їх комбінацій. Більшість із них уже
підтримуються, але дещо ще не реалізовані. Масиви
підтримуються в повному обсязі. Тільки одновимірні індексовані масиви
можуть передаватися між PHP та COM. Якщо ви виявите непідтримувані
типи, будь ласка, повідомте про них як про помилку (якщо це ще не зроблено)
та надайте всю доступну інформацію.



** Чи можливе маніпулювання візуальними об'єктами в PHP?**
Загалом так, але оскільки PHP в основному використовується як скриптова мова
для веб і виконується в контексті веб-сервера, то візуальні об'єкти
ніколи не з'являться на робочому столі сервера. Якщо ви використовуєте PHP
як скрипт для програм, наприклад у зв'язці з PHP-GTK, тоді немає
обмежень на доступ та маніпулювання візуальними об'єктами через COM.



**Чи можу я зберігати об'єкт COM у сесії?**
Ні не можете. Оскільки екземпляри COM розглядаються як ресурси, то
вони доступні лише у контексті одного скрипта.



**Як я можу зловити помилки COM?**
Модуль COM викидає виняток `com_exception`, який ви можете
перехопити і потім перевірити в нього поле code, щоб зрозуміти, що
робити далі.



**Чи можна генерувати DLL-файли з PHP-скриптів так, як це можна робити в Perl?**
Ні, на жаль, такий засіб недоступний для PHP.



**Що означає 'Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}'?**
Ця помилка може виникнути з різних причин:

- неправильний CLSID
- відсутня запитана DLL
- Запитаний компонент не реалізує інтерфейс IDispatch



**Як можна запускати COM-об'єкти з віддаленого сервера?**
Так само як ви запускаєте локальні об'єкти. Вам тільки треба
передати IP дистанційної машини як другий параметр конструктора COM.

Переконайтеся, що у вашому `php.ini` ви встановили
[com.allow_dcom](com.configuration.md#ini.com.allow-dcom)`u003d`**`true`**



**Я отримую 'DCOM is disabled in C:\path...\scriptname.php on line 6', що робити?**
Відредагуйте ваш `php.ini` та встановіть
[com.allow_dcom](com.configuration.md#ini.com.allow-dcom)`u003d`**`true`**.



**Чи можливо за допомогою PHP завантажити/маніпулювати об'єктом ActiveX на сторінці?**
PHP тут не до того. Об'єкти ActiveX завантажуються на стороні клієнта,
якщо їх запросили з HTML документа. Зв'язки з PHP-скриптом тут
ні і, отже, пряма взаємодія з серверною стороною
неможливо.



** Чи можливо отримати екземпляр компонента, що виконується?**
Це можливо за допомогою монікерів (monikers). Якщо ви хочете отримати
кілька посилань на один і той же екземпляр Word, ви можете створити цей
екземпляр як показано:

` <?php$word u003d new COM("C:\docs\word.doc");?> `

Це створить новий екземпляр, якщо немає доступного виконуваного
екземпляра або буде повернуто посилання на екземпляр, що виконується, якщо
такий доступний.



**Чи є спосіб обробити подію, надіслану об'єктом COM?**
Використовуючи [com_event_sink()](function.com-event-sink.md) ви можете
визначити приймач події та прив'язати його. Ви можете змусити PHP
згенерувати скелет класу приймача подій, використовуючи
[com_print_typeinfo()](function.com-print-typeinfo.md).



**У мене виникають проблеми при спробі викликати метод об'єкта COM, який надає більш ніж один інтерфейс. Що я можу зробити?**
Відповідь така проста, як і незадовільна. Не знаю точно, але думаю,
що ви не можете зробити нічого. Якщо у когось є точна інформація
з цього питання, будь ласка, дайте [мені](mailto:harald.radi@nme.at)
знати :)



**Значить PHP працює з COM, як щодо COM+?**
COM+ розширює COM, надаючи систему управління компонентами
через MTS і MSMQ, але тут немає нічого особливого, що PHP повинен
підтримувати для використання таких компонентів.



**Якщо PHP може маніпулювати COM-об'єктами, чи можна уявити використання MTS для управління ресурсами компонентів у з'єднанні з PHP?**
Сам PHP ще не обробляє транзакції. Таким чином, якщо виникає
помилка, відкат не ініціюється. Якщо ви використовуєте компоненти,
підтримують транзакції, вам буде необхідно реалізувати управління
транзакціями самим.
