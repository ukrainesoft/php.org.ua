{"pageProps":{"page":{"slug":"mysqlnd.plugin.api.md","content":"## API плагінів mysqlnd\n\nAPI плагінів `mysqlnd`предоставляет следующие функции:\n\n-   mysqlnd\\_plugin\\_register()\n    \n-   mysqlnd\\_plugin\\_count()\n    \n-   mysqlnd\\_plugin\\_get\\_plugin\\_connection\\_data()\n    \n-   mysqlnd\\_plugin\\_get\\_plugin\\_result\\_data()\n    \n-   mysqlnd\\_plugin\\_get\\_plugin\\_stmt\\_data()\n    \n-   mysqlnd\\_plugin\\_get\\_plugin\\_net\\_data()\n    \n-   mysqlnd\\_plugin\\_get\\_plugin\\_protocol\\_data()\n    \n-   mysqlnd\\_conn\\_get\\_methods()\n    \n-   mysqlnd\\_result\\_get\\_methods()\n    \n-   mysqlnd\\_result\\_meta\\_get\\_methods()\n    \n-   mysqlnd\\_stmt\\_get\\_methods()\n    \n-   mysqlnd\\_net\\_get\\_methods()\n    \n-   mysqlnd\\_protocol\\_get\\_methods()\n    \n\nНемає стандартних визначень того, що таке плагін та як він працює.\n\nЧасто зустрічаються в плагінах компоненти:\n\n-   Менеджер плагіна\n    \n-   API плагіна\n    \n-   Сервіси програми (або модулі)\n    \n-   API сервісів програми (або API модулів)\n    \n\nКонцепция плагина`mysqlnd` експлуатує цю функціональність і, крім того, тішить нас відкритою архітектурою.\n\n**Немає заборон**\n\nПлагін має повний доступ до всіх нутрощів. `mysqlnd`. Немає обмежень або заборон, пов'язаних із безпекою. Все, що завгодно, можна переписати для реалізації дружніх або ворожих алгоритмів, так що рекомендується ставити плагіни тільки з довірених джерел.\n\nЯк обговорювалося вище, плагіни можуть вільно використовувати покажчики. Ці покажчики нічим не обмежені і можуть вказувати дані іншого плагіна. Найпростіша арифметична операція дозволить отримати доступ до даних іншого плагіна.\n\nРекомендується писати плагіни, що співпрацюють, які можуть працювати спільно з іншими плагінами і завжди викликати батьківські методи. Плагіни ніколи не повинні поводитися вороже до самого `mysqlnd`\n\n**Проблеми: приклад співробітництва та побудови ланцюжка**\n\n| Модуль | Указатель mysqlnd.query() | Стек вызова, если вызывается родитель |\n| --- | --- | --- |\n| ext/mysqlnd | mysqlnd.query() | mysqlnd.query |\n| ext/mysqlnd\\_cache | mysqlnd\\_cache.query() |  |\n\n1.  mysqlnd\\_cache.query()\n    \n2.  mysqlnd.query\n    \n\n| | ext/mysqlnd\\_monitor | mysqlnd\\_monitor.query() |\n\n1.  mysqlnd\\_monitor.query()\n    \n2.  mysqlnd\\_cache.query()\n    \n3.  mysqlnd.query\n    \n\nУ цьому сценарії завантажені плагіни кеша (`ext/mysqlnd_cache`) та моніторингу (`ext/mysqlnd_monitor`). Оба наследуют класс`Connection::query()`. реєстрація плагінів відбувається на етапі `MINIT` відповідно до описаної вище логіки. PHP за замовчуванням викликає модулі в алфавітному порядку. Плагіни не знають один про одного і не накладають будь-яких залежностей.\n\nЗа умовчанням, плагіни викликають батьківський метод query зі своєї, перевизначеної, версії цього методу.\n\n**Резюме з модуля PHP**\n\nПовторення пройденого матеріалу на прикладі поведінки плагіна `ext/mysqlnd_plugin`, що використовує API плагінів `mysqlnd`для PHP:\n\n-   Будь-яка програма PHP, що використовує MySQL намагається встановити з'єднання за адресою 192.168.2.29\n    \n-   Додаток використовує один із наступних модулів`ext/mysql` `ext/mysqli`или`PDO_MYSQL`. Усі три модулі використовують`mysqlnd`для з'єднання з 192.168.2.29.\n    \n-   `Mysqlnd`викликає метод з'єднання, який успадковується плагіном`ext/mysqlnd_plugin`\n    \n-   `ext/mysqlnd_plugin`викликає зареєстрований користувачем метод`proxy::connect()`\n    \n-   Цей метод підміняє IP адресу з'єднання з 192.168.2.29 на 127.0.0.1 та повертає встановлене`parent::connect()`соединение.\n    \n-   `ext/mysqlnd_plugin`робить те саме, що і`parent::connect(127.0.0.1)`викликаючи оригінальний метод`mysqlnd`для соединения.\n    \n-   `ext/mysqlnd`встановлює з'єднання та повертає його`ext/mysqlnd_plugin`. . `ext/mysqlnd_plugin`, своєю чергою, передає його далі.\n    \n-   Не має значення, який модуль був використаний, він все одно отримає з'єднання до 127.0.0.1. Після цього модуль повертає це з'єднання додатку. Коло замкнулося.\n","title":"API плагінів mysqlnd","contentType":2,"navigation":[{"mysqlnd.plugin.architecture.md":"« Архітектура плагінів MySQL Native Driver"},{"mysqlnd.plugin.developing.md":"Розпочинаємо розробку плагіна mysqlnd »"},{"index.md":"PHP Manual"},{"mysqlnd.plugin.md":"API для плагінів до вбудованого драйвера MySQL"}]}},"__N_SSG":true}