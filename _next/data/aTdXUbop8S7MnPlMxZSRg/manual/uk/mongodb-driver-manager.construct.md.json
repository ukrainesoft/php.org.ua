{"pageProps":{"page":{"slug":"mongodb-driver-manager.construct.md","content":"# MongoDB\\\\Driver\\\\Manager::\\_\\_construct\n\n(mongodb >=1.0.0)\n\nMongoDB\\\\Driver\\\\Manager::\\_\\_construct — Створює новий Manager MongoDB\n\n### Опис\n\n```methodsynopsis\nfinal public MongoDB\\Driver\\Manager::__construct(?string $uri = null, ?array $uriOptions = null, ?array $driverOptions = null)\n```\n\nСтворює новий об'єкт [MongoDB\\\\Driver\\\\Manager](class.mongodb-driver-manager.md) із переданими параметрами.\n\n> **Зауваження**: В[» специфікації з виявлення та моніторингу сервера](https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.rst#single-threaded-client-construction), цей конструктор не виконує введення-виведення. З'єднання ініціалізуватимуться на вимогу, коли виконується перша операція.\n\n> **Зауваження**: Під час передачі будь-яких URI-опцій, пов'язаних з SSL або TLS, через рядок підключення або параметр `uriOptions`драйвер неявно включає TLS при з'єднаннях. Щоб запобігти цьому, або явно вимкніть опцію `tls`, або не передавайте TLS-опцій.\n\n> **Зауваження**: На Unix, драйвер MongoDB чутливий до сценаріїв, які використовують системний виклик fork() без наступного exec(). Користувачам рекомендується не перевикористовувати екземпляр [MongoDB\\\\Driver\\\\Manager](class.mongodb-driver-manager.md)в дочернем процессе. child process.\n\n### Список параметрів\n\n`uri`\n\nURI-адрес подключения[» mongodb://](https://www.mongodb.com/docs/manual/reference/connection-string/) :\n\nmongodb://\\[username:password@\\]host1\\[:port1\\]\\[,host2\\[:port2\\],...\\[,hostN\\[:portN\\]\\]\\]\\[ \\[defaultAuthDb\\]\\[?options\\]\\]\n\nДокладніше про параметри, що підтримуються URI, дивіться розділ [» Параметри рядка підключення](https://www.mongodb.com/docs/manual/reference/connection-string/#connections-connection-options)в руководстве MongoDB[» Параметри пулу підключення](https://www.mongodb.com/docs/manual/reference/connection-string/#connection-pool-options) не підтримуються, тому що PHP-драйвер не реалізує пули підключень.\n\n`uri` — це URL, тому будь-які спеціальні символи в його компонентах мають бути закодовані відповідно [» RFC 3986](http://www.faqs.org/rfcs/rfc3986). Це особливо актуально для імені користувача та пароля, які часто можуть містити спеціальні символи, такі як `@` `:` , или`%`. При підключенні через доменний сокет Unix шлях сокету може містити спеціальні символи, наприклад сліші, які необхідно закодувати. Функція [rawurlencode()](function.rawurlencode.md) може використовуватися для кодування складових частин URI-адреси.\n\nКомпонент`defaultAuthDb` може використовуватися для визначення імені бази даних, пов'язаної з обліковими даними користувача; однак параметр URI `authSource` матиме пріоритет, якщо він зазначений. Якщо не `defaultAuthDb`, ни`authSource` не вказано, база даних `admin`будет использоваться по умолчанию. Компонент`defaultAuthDb` немає сенсу за відсутності облікових даних користувача.\n\n`uriOptions`\n\nДодаткові [» параметри рядка підключення](https://www.mongodb.com/docs/manual/reference/connection-string/#connections-connection-options), які будуть перезаписувати будь-які параметри з тим самим ім'ям у параметрі `uri`\n\n**uriOptions**\n\n| Название опции | Тип | Опис |\n| --- | --- | --- |\n| appname | string |  |\n| У MongoDB 3.4+ з'явилася можливість додавати анотації до з'єднань з метаданими, що надаються клієнтом, що підключається. Ці метадані включаються до журналів логування сервера під час встановлення з'єднання, а також записуються до журналів повільних запитів, якщо увімкнено профіль бази даних. |  |  |\n\nЦя опція може використовуватися для вказівки імені програми, яка буде включена до метаданих. Значення не може перевищувати 128 символів.\n\n| | authMechanism | string |\n\nМеханізм автентифікації, який MongoDB використовуватиме для автентифікації з'єднання. Щоб переглянути додаткові відомості та список підтримуваних значень, див. [» Параметри аутентифікації](https://www.mongodb.com/docs/manual/reference/connection-string/#urioption.authMechanism)в руководстве MongoDB.\n\n| | authMechanismProperties | array |\n\nВластивості обраного механізму аутентифікації. Щоб переглянути додаткові відомості та список підтримуваних значень, див. [» Специфікація аутентифікації драйвера](https://github.com/mongodb/specifications/blob/master/source/auth/auth.rst#auth-related-options)\n\n> **Зауваження**: Якщо не вказано у рядку URI-адреси, ця опція подається у вигляді масиву пар ключ-значення. Ключі та значення в цьому масиві мають бути рядками.\n\n| | authSource | string |\n\nІм'я бази даних, пов'язане з обліковими даними користувача. За замовчуванням використовується компонент бази даних із URI-адреси з'єднання або база даних `admin`якщо обидва не вказані.\n\nДля механізмів автентифікації, які делегують зберігання облікових даних іншим службам (наприклад, GSSAPI), значення має бути `\"$external\"`\n\n| | canonicalizeHostname | bool |\n\nЯкщо **`true`**, драйвер буде перетворювати реальне ім'я хоста для IP-адреси сервера перед автентифікацією через SASL. Деякі базові шари GSSAPI вже роблять це, але ця функціональність може бути відключена в їхній конфігурації (наприклад, `krb.conf`). По умолчанию\\*\\*`false`\\*\\*\n\nЦей параметр є застарілим псевдонімом для якості `\"CANONICALIZE_HOST_NAME\"`параметра URI`\"authMechanismProperties\"`\n\n| | compressors | string |\n\nТой, хто має пріоритет, список розділених комами компресорів, які клієнт хоче використовувати. Повідомлення стиснуті лише в тому випадку, якщо клієнт та сервер спільно використовують будь-які компресори, а компресор, який використовується в кожному напрямку, залежатиме від індивідуальної конфігурації сервера чи драйвера. Дивіться [» Специфікація компресії драйвера](https://github.com/mongodb/specifications/blob/master/source/compression/OP_COMPRESSED.rst#compressors) для отримання додаткової інформації.\n\n| | connectTimeoutMS | int |\n\nЧас очікування в мілісекундах під час спроби з'єднання. За замовчуванням – 10 000 мілісекунд.\n\n| | directConnection | bool |\n\nЦей параметр можна використовувати для керування поведінкою виявлення набору реплік, якщо в рядку підключення вказано лише один хост. За промовчанням надання одного члена в рядку підключення призведе до встановлення прямого підключення або виявлення додаткових членів залежно від того, відсутня або відсутня опція URI `\"replicaSet\"`соответственно. Укажите\\*\\*`false`\\*\\*, щоб викликати виявлення (якщо `\"replicaSet\"` опущений) або вкажіть **`true`**, щоб форсувати пряме з'єднання (якщо `\"replicaSet\"` присутній).\n\n| | gssapiServiceName | string |\n\nВстановлює ім'я Kerberos при підключенні до керберизованих екземплярів MongoDB. Це значення має співпадати з ім'ям служби, встановленим в примірниках MongoDB (тобто з параметром сервер, [» saslServiceName](https://www.mongodb.com/docs/manual/reference/parameters/#param.saslServiceName)). По умолчанию используется`\"mongodb\"`\n\nЦей параметр є застарілим псевдонімом для якості `\"SERVICE_NAME\"`параметра URI`\"authMechanismProperties\"`\n\n| | heartbeatFrequencyMS | int |\n\nЗадає інтервал у мілісекундах між перевірками драйвера топології MongoDB, які відраховуються з кінця попередньої перевірки до початку наступної. За замовчуванням – 60 000 мілісекунд.\n\nСогласно[» Специфікації з виявлення та моніторингу сервера](https://github.com/mongodb/specifications/blob/master/source/server-discovery-and-monitoring/server-discovery-and-monitoring.rst#heartbeatfrequencyms), це значення не може бути менше 500 мілісекунд.\n\n| | journal | bool |\n\nВідповідає параметру гарантій запису `journal`. Якщо **`true`**, для запису буде потрібно підтвердження MongoDB, що операція була записана в журнал. Детальніше дивіться [MongoDB\\\\Driver\\\\WriteConcern](class.mongodb-driver-writeconcern.md)\n\n| | loadBalanced | bool |\n\nВказує, чи драйвер підключається до кластера MongoDB через балансувальник навантаження. Якщо **`true`**, драйвер може підключатися тільки до одного вузла (зазначеному або рядком підключення, або пошуком SRV), параметр URI `\"directConnection\"` не може бути \\*\\*`true`\\*\\*и опция URI`\"replicaSet\"` має бути опущена. За замовчуванням **`false`**\n\n| | localThresholdMS | int |\n\nРозмір у мілісекундах вікна затримки для вибору серед кількох відповідних екземплярів MongoDB при вирішенні переваги читання. За замовчуванням – 15 мілісекунд.\n\n| | maxStalenessSeconds | int |\n\nСоответствует параметру предпочтения чтения`\"maxStalenessSeconds\"`. Вказує в секундах, наскільки застарілим може бути вторинний вузол у наборі реплік, перш ніж клієнт перестане використовувати його для операцій читання. За замовчуванням не встановлено максимального відставання реплікації (staleness) і клієнти не враховуватимуть відставання вторинного вузла при виборі напрямку операції читання. Докладніше про це розказано в описі класу [MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md)\n\nЯкщо зазначено, максимальне відставання має бути 32-бітовим цілим числом, більшим або рівним **`MongoDB\\Driver\\ReadPreference::SMALLEST_MAX_STALENESS_SECONDS`**(т. е. 90 секунд).\n\n| | password | string | Пароль для автентифікації користувача. Ця опція є корисною, якщо пароль містить спеціальні символи, які в іншому випадку повинні були закодовані для URI-адреси підключення. | | readConcernLevel | string | Відповідає параметру гарантій читання `level`Определяет уровень изоляции чтения. Подробнее смотрите[MongoDB\\\\Driver\\\\ReadConcern](class.mongodb-driver-readconcern.md)| | readPreference | string |\n\nСоответствует параметру предпочтениям чтения`mode`По умолчанию —`\"primary\"`Подробнее смотрите[MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md)\n\n| | readPreferenceTags | array |\n\nСоответствует параметру предпочтениям чтения`tagSets`. Набір тегів дозволяє настроїти операції читання для певних членів набору репліки. Детальніше дивіться [MongoDB\\\\Driver\\\\ReadPreference](class.mongodb-driver-readpreference.md)\n\n> **Зауваження**: Якщо у рядку URI не вказано, цей параметр подається як масив, що відповідає формату, що очікується [MongoDB\\\\Driver\\\\ReadPreference::\\_\\_construct()](mongodb-driver-readpreference.construct.md)\n\n| | replicaSet | string |\n\nВказує ім'я набору репліки.\n\n| | retryReads | bool |\n\nВказує, чи має драйвер автоматично повторювати певні операції читання, які не виконуються через тимчасові мережеві помилки або вибори набору реплік. Потрібен MongoDB 3.6+. За замовчуванням **`true`**\n\nСмотрите[» Специфікацію з Retryable Reads](https://github.com/mongodb/specifications/blob/master/source/retryable-reads/retryable-reads.rst) для отримання додаткової інформації.\n\n| | retryWrites | bool |\n\nВказує, чи повинен драйвер автоматично повторювати певні операції запису, які не виконуються через тимчасові помилки мережі або вибір набору реплік. Потрібен MongoDB 3.6+. За замовчуванням **`true`**\n\nСмотрите[» Retryable Writes](https://www.mongodb.com/docs/manual/core/retryable-writes/) у посібнику MongoDB для отримання додаткової інформації.\n\n| | safe | bool |\n\nЯкщо **`true`**, вказує для параметра`w` гарантії запису за замовчуванням. Якщо **`false`**, вказується Подробнее смотрите[MongoDB\\\\Driver\\\\WriteConcern](class.mongodb-driver-writeconcern.md)\n\nЦя опція застаріла і не повинна використовуватись.\n\n| | serverSelectionTimeoutMS | int |\n\nВказує як довго в мілісекунді блокувати вибір сервера перед викидом виключення. За замовчуванням – 30 000 мілісекунд.\n\n| | serverSelectionTryOnce | bool |\n\nЯкщо **`true`**, то повідомляє драйверу сканувати розгортання MongoDB лише один раз після невдалої спроби вибору сервера, а потім або вибрати сервер або створити помилку. Коли **`false`**, драйвер блокує вибір і виконує пошук сервера до закінчення часу, вказаного у параметрі `\"serverSelectionTimeoutMS\"`По умолчанию -**`true`**\n\n| | socketCheckIntervalMS | int |\n\nЯкщо не використовувався сокет останнім часом, драйвер повинен перевірити за допомогою команди `hello`, перш ніж використовувати його для будь-якої операції. За замовчуванням – 5 000 мілісекунд.\n\n| | socketTimeoutMS | int |\n\nЧас у мілісекундах, щоб спробувати відправити або отримати в сокет до закінчення часу. За замовчуванням – 300 000 мілісекунд (тобто 5 хвилин).\n\n| | srvMaxHosts | int |\n\nМаксимальна кількість результатів SRV для випадкового вибору при початковому заповненні посівного списку або під час опитування SRV при додаванні нових вузлів до топології. За замовчуванням (т. е. без максимума).\n\n| | srvServiceName | string |\n\nІм'я служби, що використовується для пошуку SRV в початковому списку DNS seedlist виявлення та опитування SRV. За замовчуванням `\"mongodb\"`\n\n| | ssl | bool |\n\nСтворює з'єднання з TLS/SSL, якщо **`true`**По умолчанию -**`false`**\n\nПараметр является устаревшим псевдонимом для параметра URI`\"tls\"`\n\n| | tls | bool |\n\nІніціює з'єднання з TLS/SSL, якщо **`true`**По умолчанию**`false`**\n\n| | tlsAllowInvalidCertificates | bool |\n\nВказує, чи має драйвер видавати помилку, якщо сертифікат сервера TLS недійсний. За замовчуванням **`false`**\n\n**Увага**\n\nВимкнення перевірки сертифіката створює вразливість.\n\n| | tlsAllowInvalidHostnames | bool |\n\nВказує, чи має драйвер видавати помилку при невідповідності імені хоста сервера та імені хоста, вказаного в сертифікаті TLS. За замовчуванням **`false`**\n\n**Увага**\n\nВимкнення перевірки сертифіката створює вразливість. Дозвіл неприпустимих імен хоста може призвести до атаки типу [\"¦\"людина посередині\" (man-in-the-middle)](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n\n| | tlsCAFile | string |\n\nШлях до файлу з одним або декількома центрами сертифікації, які слід вважати довіреними під час встановлення з'єднання TLS. За умовчанням використовуватиметься сховище системних сертифікатів.\n\n| | tlsCertificateKeyFile | string |\n\nШлях до файлу сертифіката клієнта або закритого ключа клієнта; якщо вони обидва необхідні, файли повинні бути об'єднані.\n\n| | tlsCertificateKeyFilePassword | string |\n\nПароль для розшифрування закритого ключа клієнта (тобто параметра URI `\"tlsCertificateKeyFile\"`), який використовуватиметься для з'єднань TLS.\n\n| | tlsDisableCertificateRevocationCheck | bool |\n\nЯкщо **`true`**, драйвер не намагатиметься перевірити статус відкликання сертифіката (наприклад, OCSP, CRL). За замовчуванням **`false`**\n\n| | tlsDisableOCSPEndpointCheck | bool |\n\nЯкщо **`true`**, драйвер не намагатиметься зв'язатися з кінцевою точкою відповіді OCSP, якщо це необхідно (тобто відповідь OCSP не зшивається). За замовчуванням **`false`**\n\n| | tlsInsecure | bool |\n\nПослабте обмеження TLS максимально можливо. При значенні **`true`** цей параметр має той самий ефект, що і вказівка ​​значення **`true`** для обох параметрів URI `\"tlsAllowInvalidCertificates\"`и`\"tlsAllowInvalidHostnames\"`По умолчанию\\*\\*`false`\\*\\*\n\n**Увага**\n\nВимкнення перевірки сертифіката створює вразливість. Дозвіл неприпустимих імен хоста може призвести до атаки типу [\"¦\"людина посередині\" (man-in-the-middle)](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n\n| | username | string | Ім'я користувача для автентифікації. Ця опція є корисною, якщо ім'я користувача містить спеціальні символи, які в іншому випадку повинні бути закодовані в URL для URI-адреси підключення. | | w | int | string |\n\nВідповідає параметру гарантій запису `w`Подробнее смотрите[MongoDB\\\\Driver\\\\WriteConcern](class.mongodb-driver-writeconcern.md)\n\n| | wTimeoutMS | int|string |\n\nВідповідає параметру гарантій запису `wtimeout`. Вказує термін у мілісекундах для гарантії запису. Детальніше дивіться [MongoDB\\\\Driver\\\\WriteConcern](class.mongodb-driver-writeconcern.md)\n\nЯкщо зазначено, `wTimeoutMS` має бути 32-бітовим цілим числом зі знаком, великим або рівним нулю.\n\n| | zlibCompressionLevel | int |\n\nВказує рівень стиснення для використання zlib. Ця опція нічого не робить, якщо `zlib` не включений до URL опції `\"compressors\"`Смотрите[» Специфікація компресії драйвера](https://github.com/mongodb/specifications/blob/master/source/compression/OP_COMPRESSED.rst#zlibcompressionlevel) для отримання додаткової інформації.\n\n`driverOptions`\n\n**driverOptions**\n\n| Опция | Тип | Опис |\n| --- | --- | --- |\n| allow\\_invalid\\_hostname | bool |  |\n| Відключає перевірку імені хоста, якщо **`true`**По умолчанию —**`false`** |  |  |\n\nДозвіл неприпустимих імен хоста може призвести до атаки типу [\"¦\"людина посередині\" (man-in-the-middle)](https://en.wikipedia.org/wiki/Man-in-the-middle_attack)\n\nЦей параметр є застарілим псевдонімом для URI `\"tlsAllowInvalidHostnames\"`\n\n| | autoEncryption | array |\n\nНадає опції для увімкнення автоматичного шифрування на рівні поля на стороні клієнта.\n\n> **Зауваження** :\n> \n> Автоматичне шифрування — це функція тільки для Enterprise версії, яка застосовується лише до операцій над колекцією. Автоматичне шифрування не підтримується для операцій над базою даних або поданням, а операції, які не обходяться, призведуть до помилки (див. [» libmongocrypt: Список дозволів на автоматичне шифрування](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#libmongocrypt-auto-encryption-allow-list)). Щоб обійти автоматичне шифрування для всіх операцій, установіть `bypassAutoEncryption`в значение\\*\\*`true`\\*\\*\n> \n> Автоматичне шифрування вимагає, щоб у автентифікованого користувача був привілей [» listCollections](https://www.mongodb.com/docs/manual/reference/command/listCollections/#required-access)\n> \n> Явне шифрування/дешифрування та автоматичне розшифрування – це функція Community версії. Драйвер все ще може автоматично розшифровувати, якщо у опції `bypassAutoEncryption`установлено значение\\*\\*`true`\\*\\*\n\nПідтримуються такі опції:\n\n**Опції для автоматичного шифрування**\n\n| Опция | Тип | Опис |\n| --- | --- | --- |\n| keyVaultClient | [MongoDB\\\\Driver\\\\Manager](class.mongodb-driver-manager.md) | Менеджер маршрутизації запитів ключів даних окремий кластер MongoDB. За замовчуванням метод вибирає поточний менеджер та кластер. |\n| keyVaultNamespace | string | Повний простір імен (наприклад, `\"databaseName.collectionName\"`), що означає колекцію, яка містить усі ключі даних, що використовуються для шифрування та дешифрування. Обов'язковий параметр. |\n| kmsProviders | array |  |\n| Документ, який містить конфігурацію для одного або кількох провайдерів KMS, які використовуються для шифрування ключів даних. Підтримуються провайдери `\"aws\"` `\"azure\"` `\"gcp\"`и`\"local\"`, і принаймні один з них повинен бути вказаний. |  |  |\n\nЯкщо для `\"aws\"` `\"azure\"`или`\"gcp\"` вказано порожній документ, драйвер спробує налаштувати провайдера, використовуючи [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\nФормат для`\"aws\"` виглядає наступним чином:\n\naws: { accessKeyId:, secretAccessKey:, sessionToken:}\n\nФормат для`\"azure\"` виглядає наступним чином:\n\nazure: { tenantId:, clientId:, clientSecret:, identityPlatformEndpoint: // За замовчуванням \"login.microsoftonline.com\"\n\n}\n\nФормат для`\"gcp\"` виглядає наступним чином:\n\ngcp: { email:, privateKey:|<MongoDB\\\\BSON\\\\Binary>, endpoint: // За замовчуванням \"oauth2.googleapis.com\"\n\n}\n\nФормат для`\"kmip\"` виглядає наступним чином:\n\nkmip: { endpoint:}\n\nФормат для`\"local\"` виглядає наступним чином:\n\nlocal: { // 96-байтовий головний ключ, який використовується для шифрування/дешифрування ключів даних key: |<MongoDB\\\\BSON\\\\Binary> }\n\n| | tlsOptions | array |\n\nДокумент, який містить конфігурацію TLS для одного або кількох KMS провайдерів. Підтримуються провайдери `\"aws\"` `\"azure\"` `\"gcp\"`и`\"kmip\"`. Усі провайдери підтримують такі опції:\n\n: { tlsCaFile:, tlsCertificateKeyFile:, tlsCertificateKeyFilePassword:, tlsDisableOCSPEndpointCheck:}\n\n| | schemaMap | array|object |\n\nКарта просторів імен колекції у локальну схему JSON. Використовується для налаштування автоматичного шифрування. Додаткову інформацію дивіться у [» Правила автоматичного шифрування](https://www.mongodb.com/docs/manual/reference/security-client-side-automatic-json-schema/) в посібнику з MongoDB. Помилкою є вказівка ​​колекції як у `schemaMap`, так і в `encryptedFieldsMap`\n\n> **Зауваження**: Добавление`schemaMap` забезпечує більшу безпеку, ніж використання схем JSON, отриманих із сервера. Це захищає від шкідливого сервера, що рекламує помилкову схему JSON, яка може змусити клієнта надсилати незашифровані дані, які мають бути зашифровані.\n\n> **Зауваження**: Схеми, що постачаються в `schemaMap`, використовуються лише для налаштування автоматичного шифрування на стороні клієнта. Інші правила перевірки у схемі JSON не будуть використовуватися драйвером і призведуть до помилки.\n\n| | bypassAutoEncryption | bool | Если\\*\\*`true`\\*\\* `mongocryptd` не з'являтиметься автоматично. Використовується для вимкнення автоматичного шифрування. За замовчуванням **`false`**| | bypassQueryAnalysis | bool | Если\\*\\*`true`**, автоматичний аналіз вихідних команд буде вимкнено та `mongocryptd` не з'являтиметься автоматично. Це дозволяє використовувати явне шифрування для запиту індексованих полів без необхідності використання ліцензованої корпоративної бібліотеки `crypt_shared`или процесса`mongocryptd`По умолчанию установлено значение**`false`\\*\\*| | encryptedFieldsMap | array|object |\n\nКарта просторів імен колекції у документі `encryptedFields`. Використовується для налаштування шифрування із можливістю запиту. Дивіться [» Шифрування полів та можливість запитів](https://www.mongodb.com/docs/manual/core/queryable-encryption/fundamentals/encrypt-and-query/) у посібнику MongoDB для отримання додаткової інформації. Помилкою є вказівка ​​колекції як у `encryptedFieldsMap`, так і в `schemaMap`\n\n> **Зауваження**: Указание`encryptedFieldsMap` забезпечує більшу безпеку, ніж покладатися на `encryptedFields`отримані від сервера. Це захищає від зловмисного сервера, що рекламує помилкові `encryptedFields`\n\n| | extraOptions | array |\n\n`extraOptions` відноситься до процесу `mongocryptd`. Підтримуються такі параметри:\n\n-   `mongocryptdURI`(string): URI для підключення до існуючого процесу`mongocryptd`По умолчанию`\"mongodb://localhost:27020\"`\n-   `mongocryptdBypassSpawn`(bool): Якщо\\*\\*`true`**, запобігає створенню драйвером`mongocryptd`По умолчанию**`false`\\*\\*\n-   `mongocryptdSpawnPath`(string): Абсолютний шлях для пошуку двійкового файлу`mongocryptd`. За промовчанням це порожній рядок, який використовує системні шляхи.\n-   `mongocryptdSpawnArgs`(array): Масив рядкових аргументів для передачі в`mongocryptd`при створенні. За замовчуванням`[\"--idleShutdownTimeoutSecs=60\"]`\n-   `cryptSharedLibPath`(string): Абсолютний шлях до бібліотеки загального доступу`crypt_shared`. За промовчанням — порожній рядок і використовує системні шляхи.\n-   `cryptSharedLibRequired`(bool): Якщо\\*\\*`true`**, вимагає, щоб драйвер завантажував`crypt_shared`По умолчанию**`false`\\*\\*\n\nСмотрите[» Посібник із шифрування на стороні клієнта](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#extraoptions)отримати більше інформації.\n\n> **Зауваження**: Автоматичне шифрування – це лише корпоративна функція, яка застосовується лише до операцій над колекцією. Автоматичне шифрування не підтримується для операцій з базою даних або поданням, операції, які не вдасться обійти, призведуть до помилки. Щоб обійти автоматичне шифрування для всіх операцій, установіть `bypassAutoEncryption=true`в`autoEncryption`. Для отримання додаткової інформації про дозволені операції дивіться [» Посібник із шифрування на стороні клієнта](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#libmongocrypt-auto-encryption-whitelist)\n\n| | ca\\_dir | string |\n\nШлях до коректно захешованого каталогу сертифікатів. За умовчанням використовуватиметься сховище системних сертифікатів.\n\n| | ca\\_file | string |\n\nШлях до файлу з одним або декількома центрами сертифікації, які слід вважати довіреними під час встановлення з'єднання TLS. За умовчанням використовуватиметься сховище системних сертифікатів.\n\nПараметр является устаревшим псевдонимом для параметра URI`\"tlsCAFile\"`\n\n| | context | resource |\n\n[Параметри контексту SSL](context.ssl.md) для використання як запасний варіант, якщо не вказано опцію драйвера або еквівалентну їй опцію URI. Зверніть увагу, що драйвер не звертається до контексту за промовчанням (тобто . [stream\\_context\\_get\\_default()](function.stream-context-get-default.md)). Підтримуються такі параметри контексту:\n\n**Резервні параметри контексту SSL**\n\n| Параметр драйвера | Параметр контекста (запасной вариант) |\n| --- | --- |\n| ca\\_dir | capath |\n| ca\\_file | cafile |\n| pem\\_file | local\\_cert |\n| pem\\_pwd | passphrase |\n| weak\\_cert\\_validation | allow\\_self\\_signed |\n\nПараметр підтримується для зворотної сумісності, але слід вважати застарілим.\n\n| | crl\\_файл | string | Шлях до файлу списку анульованих сертифікатів. | | disableClientPersistence | bool |\n\nЯкщо **`true`**, Manager буде використовувати новий libmongoc клієнт, який не буде зберігатися або використовуватися іншими об'єктами Manager. Коли цей об'єкт Manager буде звільнений, його клієнт буде знищений, а всі з'єднання будуть закриті. За замовчуванням **`false`**\n\n> **Зауваження**: Disabling client persistence is not generally recommended.\n\n| | driver | array |\n\nДозволяє користувацьким драйверам додавати свої метадані до рукостискання сервера. За замовчуванням драйвер передає своє власне ім'я, версію та платформу (тобто версію PHP) у рукостискання. Драйвери користувача можуть вказувати рядки для ключів `\"name\"` `\"version\"`и`\"platform\"` цього масиву, які будуть додані до відповідних полів у документі рукостискання.\n\n> **Зауваження**: Інформація про рукостискання обмежена 512 байтами. Драйвер урізає дані рукостискання, щоб відповідати цьому 512-байтовому рядку. Рекомендовано зберігати стислість метаданих драйверам і ODM.\n\n| | pem\\_file | string |\n\nШлях до сертифікату у форматі PEM для автентифікації клієнта.\n\nЦей параметр є застарілим псевдонімом для URI `\"tlsCertificateKeyFile\"`\n\n| | pem\\_pwd | string |\n\nПарольна фраза до PEM-закодованому сертифікату (якщо є).\n\nЦей параметр є застарілим псевдонімом для URI `\"tlsCertificateKeyFilePassword\"`\n\n| | serverApi |[MongoDB\\\\Driver\\\\ServerApi](class.mongodb-driver-serverapi.md)\n\nОпція використовується для оголошення версії сервера API для менеджера. Якщо не вказано, версія API не оголошується.\n\n| | weak\\_cert\\_validation | bool |\n\nВідключає перевірку сертифікат, якщо **`true`**По умолчанию —**`false`**\n\nЦей параметр є застарілим псевдонімом для URI `\"tlsAllowInvalidCertificates\"`\n\n### Помилки\n\n-   При помилці парсингу аргумент кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\InvalidArgumentException](class.mongodb-driver-exception-invalidargumentexception.md)\n-   При неправильному форматі`uri` викидає виняток [MongoDB\\\\Driver\\\\Exception\\\\RuntimeException](class.mongodb-driver-exception-runtimeexception.md)\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| PECL mongodb 1.16.0 |  |\n| Провайдер AWS KMS для шифрування на стороні клієнта тепер приймає параметр `\"sessionToken\"`, який можна використовувати для автентифікації з тимчасовими обліковими даними AWS. |  |\n\nДобавлено`\"tlsDisableOCSPEndpointCheck\"`в поле`\"tlsOptions\"`поля`\"autoEncryption\"`опции драйвера.\n\nЯкщо для KMS-провайдерів `\"azure\"`или`\"gcp\"` вказано порожній документ, драйвер спробує налаштувати провайдера, заповнивши [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\n| | PECL mongodb 1.15.0 |\n\nЯкщо для KMS-провайдера `\"aws\"` вказано порожній документ, драйвер спробує налаштувати провайдера, заповнивши [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\n| | PECL mongodb 1.14.0 |\n\nДодані опції автоматичного шифрування `\"bypassQueryAnalysis\"`и`\"encryptedFieldsMap\"`. Додаткові опції, що стосуються `crypt_shared`, тепер підтримуються в опції автоматичного шифрування `\"extraOptions\"`option.\n\n| | PECL mongodb 1.13.0 |\n\nДодані URI опції `\"srvMaxHosts\"`и`\"srvServiceName\"`\n\n| | PECL mongodb 1.12.0 |\n\nKMIP тепер підтримується як KMS провайдер для шифрування на стороні клієнта і може бути налаштований за допомогою поля `\"kmsProviders\"`параметра драйвера`\"autoEncryption\"`. Крім того, параметри TLS для KMS-провайдерів тепер можна налаштувати у полі `\"tlsOptions\"`параметра драйвера`\"autoEncryption\"`\n\n| | PECL mongodb 1.11.0 |\n\nДобавлена опция URI`\"loadBalanced\"`\n\n| | PECL mongodb 1.10.0 |\n\nДобавлена опция драйвера`\"disableClientPersistence\"`\n\nAzure та GCP тепер підтримуються як постачальники KMS для шифрування на стороні клієнта і можуть бути налаштовані в полі `\"kmsProviders\"`параметра драйвера`\"autoEncryption\"`. Рядки в кодуванні Base64 тепер приймаються як альтернатива [MongoDB\\\\BSON\\\\Binary](class.mongodb-bson-binary.md)для параметров внутри`\"kmsProviders\"`\n\n| | PECL mongodb 1.8.0 |\n\nДодано опції URI `\"directConnection\"` `\"tlsDisableCertificateRevocationCheck\"`, и`\"tlsDisableOCSPEndpointCheck\"`\n\nДобавлен параметр драйвера`\"driver\"`\n\n| | PECL mongodb 1.7.0 |\n\nДобавлена опция драйвера`\"autoEncryption\"`\n\nВказує будь-яку опцію SSL або TLS у параметрі `driverOptions` тепер неявно вмикає TLS, як це робиться для відповідних опцій URI.\n\n| | PECL mongodb 1.6.0 |\n\nДодано параметри URI `\"retryReads\"` `\"tls\"` `\"tlsAllowInvalidCertificates\"` `\"tlsAllowInvalidHostnames\"` `\"tlsCAFile\"` `\"tlsCertificateKeyFile\"` `\"tlsCertificateKeyFilePassword\"`, и`\"tlsInsecure\"`\n\nПараметр URI`\"retryWrites\"`по умолчанию\\*\\*`true`\\*\\*\n\nПередача URI-опції SSL або TLS через рядок підключення або параметр `uriOptions` тепер неявно включає TLS, за умови, якщо `ssl`или`tls` не рівні \\*\\*`false`\\**TSL*не\\* включається неявно для будь-яких опцій у параметрі `driverOptions`, як у попередніх версіях.\n\n| | PECL mongodb 1.5.0 |\n\n`\"wtimeoutMS\"` тепер завжди перевіряється та застосовується до гарантії запису. Раніше ця опція ігнорувалась, якщо `\"w\"` був <= 1, оскільки час очікування застосовується лише до реплікації.\n\n| | PECL mongodb 1.4.0 |\n\nДодано опції URI `\"compressors\"` `\"retryWrites\"`и`\"zlibCompressionLevel\"`\n\n| | PECL mongodb 1.3.0 |\n\nВ аргументе`uriOptions` тепер є опції `\"authMechanism\"`и`\"authMechanismProperties\"`. Раніше ці опції підтримувалися лише у аргументі `uri`\n\n| | PECL mongodb 1.2.0 |\n\nАргумент`uri`по умолчанию теперь`\"mongodb://127.0.0.1/\"`Порт по умолчанию не изменился -`27017`\n\nДобавлен URI-параметр`\"appname\"`\n\nДодані параметри драйвера `\"allow_invalid_hostname\"` `\"ca_file\"` `\"ca_dir\"` `\"clr_file\"` `\"pem_file\"` `\"pem_pwd\"`и`\"weak_cert_validation\"`\n\nAPI потоків PHP більше не використовується для підключення до сокету. Параметр URI `\"connectTimeoutMS\"`теперь по умолчанию равен 10 секунд вместо[default\\_socket\\_timeout](filesystem.configuration.md#ini.default-socket-timeout) у попередніх версіях. Крім того, драйвер більше не підтримує все [параметри SSL-контексту](context.ssl.md)через параметр драйвера`\"context\"`\n\n| | PECL mongodb 1.1.0 |\n\nАргумент`uri` є необов'язковим і за умовчанням дорівнює `\"mongodb://localhost:27017/\"`\n\n### Приклади\n\n**Приклад #1 Приклади використання **MongoDB\\\\Driver\\\\Manager::\\_\\_construct()****\n\nПідключення до автономного вузла MongoDB:\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://example.com:27017\");\n\n?>\n```\n\nПідключення до автономного сайту MongoDB через доменний сокет Unix. Шлях сокету може містити спеціальні символи, наприклад сліші, які мають закодувати за допомогою [rawurlencode()](function.rawurlencode.md)\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://\" . rawurlencode(\"/tmp/mongodb-27017.sock\"));\n\n?>\n```\n\nПідключення до набору реплік:\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://rs1.example.com,rs2.example.com/?replicaSet=myReplicaSet\");\n\n?>\n```\n\nПідключення до сегментованого кластера (тобто одну або кілька екземплярів mongos):\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://mongos1.example.com,mongos2.example.com/\");\n\n?>\n```\n\nПідключення до MongoDB з обліковими даними аутентифікації для конкретного користувача та бази даних:\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://myusername:mypassword@example.com/?authSource=databaseName\");\n\n?>\n```\n\nПідключення до MongoDB з обліковими даними аутентифікації для конкретного користувача та бази даних, де ім'я користувача або пароль містять спеціальні символи (наприклад, `@` `:` `%`). В следующем Прикладе, строка с паролем`myp@ss:w%rd` була вручну екранована; однак [rawurlencode()](function.rawurlencode.md) може використовуватися для екранування URI компонентів, які можуть містити спеціальні символи.\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\"mongodb://myusername:mypassword@example.com/?authSource=databaseName\");\n\n?>\n```\n\nПідключення до MongoDB з автентифікацією X509:\n\n```php\n<?php\n\n$manager = new MongoDB\\Driver\\Manager(\n    \"mongodb://example.com/?ssl=true&authMechanism=MONGODB-X509\",\n    [],\n    [\n        \"pem_file\" => \"/path/to/client.pem\",\n    ]\n);\n?>\n```\n\n### Дивіться також\n\n-   [Обробка підключення та збереження](mongodb.connection-handling.md)\n-   [» Формат рядка з'єднання MongoDB](https://www.mongodb.com/docs/manual/reference/connection-string/)\n","title":"MongoDB\\\\Driver\\\\Manager::\\_\\_construct","contentType":2,"navigation":[{"mongodb-driver-manager.addsubscriber.md":"« MongoDB\\\\Driver\\\\Manager::addSubscriber"},{"mongodb-driver-manager.createclientencryption.md":"MongoDB\\\\Driver\\\\Manager::createClientEncryption »"},{"index.md":"PHP Manual"},{"class.mongodb-driver-manager.md":"MongoDB\\\\Driver\\\\Manager"}]}},"__N_SSG":true}