{"pageProps":{"page":{"slug":"gearmanworker.wait.md","content":"# GearmanWorker::wait\n\n(PECL gearman >= 0.6.0)\n\nGearmanWorker::wait — Очікування запиту з одного із сервера завдань\n\n### Опис\n\n```methodsynopsis\npublic GearmanWorker::wait(): bool\n```\n\nПри роботі в неблокуючому режимі введення/виводу змушує оброблювача чекати завдання від сервера завдань Gearman. У разі відмови буде видано попередження \\*\\*`E_WARNING`\\*\\*с указанием последней произошедшей ошибки.\n\n### Список параметрів\n\nЦя функція не має параметрів.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Запуск оброблювача в режимі неблокування**\n\n```php\n<?php\n\necho \"Запуск\\n\";\n\n# создание объекта обработчика\n$worker= new GearmanWorker();\n\n# включение неблокирующего режима\n$worker->addOptions(GEARMAN_WORKER_NON_BLOCKING);\n\n# добавление сервера по умолчанию (localhost на порту 4730)\n$worker->addServer();\n\n# добавление callback-функции\n$worker->addFunction('reverse', 'reverse_fn');\n\n# попробуем получить задание\nwhile (@$worker->work() ||\n       $worker->returnCode() == GEARMAN_IO_WAIT ||\n       $worker->returnCode() == GEARMAN_NO_JOBS)\n{\n  if ($worker->returnCode() == GEARMAN_SUCCESS)\n    continue;\n\n  echo \"Ожидание следующего задания...\\n\";\n  if (!@$worker->wait())\n  {\n    if ($worker->returnCode() == GEARMAN_NO_ACTIVE_FDS)\n    {\n      # мы не подключены ни к одному из серверов, подождём немного\n      # и попробуем переподключиться\n      sleep(5);\n      continue;\n    }\n    break;\n  }\n}\n\necho \"Ошибка в обработчике: \" . $worker->error() . \"\\n\";\n\nfunction reverse_fn($job)\n{\n  return strrev($job->workload());\n}\n\n\n?>\n```\n\n### Дивіться також\n\n-   [GearmanWorker::work()](gearmanworker.work.md) \\- Очікування та виконання завдань\n","title":"GearmanWorker::wait","contentType":2,"navigation":[{"gearmanworker.unregisterall.md":"« GearmanWorker::unregisterAll"},{"gearmanworker.work.md":"GearmanWorker::work »"},{"index.md":"PHP Manual"},{"class.gearmanworker.md":"GearmanWorker"}]}},"__N_SSG":true}