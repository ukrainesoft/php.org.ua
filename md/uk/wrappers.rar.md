- [« ssh2://](wrappers.ssh2.md)
- [ogg:// »](wrappers.audio.md)

- [PHP Manual](index.md)
- [Підтримувані протоколи та обгортки](wrappers.md)
- RAR

#rar

rar:// — RAR

### Опис

Ця обгортка приймає URL-кодований шлях до RAR-архіву (відносний
або абсолютний), необов'язковий символ зірочки (`*`), необов'язковий
символ ґрат (`#`) та необов'язкове URL-кодоване ім'я таке, як
зберігається у архіві. Для вказівки імені вмісту потрібний символ
ґрат, початковий зворотний сліш у назві вмісту необов'язковий.

Ця обгортка може відкривати файли та каталоги. Коли відкриваються
директорії, знак зірочки вимагає, щоб імена об'єктів директорії були
закодовані unencode. Якщо такий знак не вказано, вони будуть повернуті до
URL-кодування. Сенс цього в тому, щоб дозволити обгортці коректно
використовувати вбудовану функціональність, таку як
[RecursiveDirectoryIterator](class.recursivedirectoryiterator.md)
коли є імена файлів, які здаються як url-закодовані
дані.

Якщо символ решітки та частина імені запису не увімкнено, буде відображено
корінь архіву. Це відрізняється від звичайних директорій тим, що
результуючий потік не міститиме таку інформацію, як час
модифікації, оскільки коренева директорія не зберігається як окрема
запис у архіві. Використання обгортки з
[RecursiveDirectoryIterator](class.recursivedirectoryiterator.md)
вимагає, щоб символ решітки був увімкнений в URL, коли відбувається доступ
до кореня, так що URL нащадків міг бути сконструйований правильно.

> **Примітка**: **Ця обгортка не включена за замовчуванням**
> Для того щоб використовувати обгортку `rar://`, вам необхідно
> встановити модуль [» rar](https://pecl.php.net/package/rar), доступний
> з репозиторію [»PECL](https://pecl.php.net/).

`rar://` Доступно з PECL rar 3.0.0

### Використання

- `rar://<url encoded archive name>[*][#[<url encoded entry name>]]`

### Опції

| Атрибут Підтримка
|------------------------------------------------- ----------------------------------------|--------- --|
| Обмеження на [allow_url_fopen](filesystem.configuration.md#ini.allow-url-fopen) | Ні |
| Обмеження на [allow_url_include](filesystem.configuration.md#ini.allow-url-include) | Ні |
| Читання | Так |
| Запис | Ні |
| Додавання | Ні |
| Одночасне читання та запис | Ні |
| Підтримка [stat()](function.stat.md) | Так |
| Підтримка [unlink()](function.unlink.md) | Ні |
| Підтримка [rename()](function.rename.md) | Ні |
| Підтримка [mkdir()](function.mkdir.md) | Ні |
| Підтримка [rmdir()](function.rmdir.md) | Ні |

**Основна інформація**

| Назва | Використання | За замовчуванням |
|-------------------|----------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------------|--------------|
| `open_password` | Пароль використовується для шифрування заголовків архіву, якщо вони є. WinRAR шифруватиме всі файли з таким же паролем, як і пароль заголовків, коли останній присутній. Тому для архівів із зашифрованими заголовками опція `file_password` буде проігнорована. | |
| `file_password` | Пароль, який використовується для шифрування файлу, якщо такий є. Якщо заголовки також зашифровані, ця опція буде ігнорована на користь `open_password`. Причина цього в тому, що немає сенсу у використанні одночасно двох різних паролів для шифрування окремо заголовків та файлів. Немає таких архівів, де це знадобилося б. Зауважимо, що якщо архів відсутні зашифровані заголовки, то опція `open_password` буде ігнорована і ця опція повинна бути використана замість неї. | |
| `volume_callback` | Зворотний виклик визначення шляху відсутніх томів архіву. Дивіться [RarArchive::open()](rararchive.open.md) для більш детальної інформації. | |

**Опції контексту**

### Приклади

**Приклад #1 Обхід RAR-архіву**

`<?phpclass MyRecDirIt extends RecursiveDirectoryIterator {    function current() {        return rawurldecode($this->getSubPathName()) . (is_dir(parent::current())?"[DIR]":""); }}$f u003d "rar://" . rawurlencode(dirname(__FILE__)) . DIRECTORY_SEPARATOR . 'dirs_and_extra_headers.rar#';$it u003d new RecursiveTreeIterator(new MyRecDirIt($f));foreach ($it as $s) {    echo $s, "
";}?> `

Результатом виконання цього прикладу буде щось подібне:

|-allow_everyone_ni [DIR]
|-file1.txt
|-file2_אּ.txt
|-with_streams.txt
\-אּ [DIR]
|-אּ\%2Fempty%2E [DIR]
| \-אּ\%2Fempty%2E ile7.txt
|-אּ mpty [DIR]
|-אּ ile3.txt
|-אּ ile4_אּ.txt
\-אּ\אּ_2 [DIR]
|-אּ\אּ_2 ile5.txt
\-אּ\אּ_2 ile6_אּ.txt

**Приклад #2 Відкриття зашифрованого файлу (шифрування заголовка)**

` <?php$stream u003d fopen("rar://" .    rawurlencode(dirname(__FILE__)) . DIRECTORY_SEPARATOR .    'encrypted_headers.rar' . '#encfile1.txt', "r", false,    stream_context_create(        array(            ' rar' u003d>                array(                    'open_password' u003d> 'samplepassword'                )            )        )    );var_dump(stream_get_contents($stream));/* дата создания и дата последнего доступа включается опционально в WinRAR, поэтому у * большинства файлов их нет */ var_dump(fstat($stream));?> `

Результатом виконання цього прикладу буде щось подібне:

string(26) "Encrypted file 1 contents."
Array
(
[0] u003d> 0
[1] u003d> 0
[2] u003d> 33206
[3] u003d> 1
[4] u003d> 0
[5] u003d> 0
[6] u003d> 0
[7] u003d> 26
[8] u003d> 0
[9] u003d> 1259550052
[10] u003d> 0
[11] u003d> -1
[12] u003d> -1
[dev] u003d> 0
[ino] u003d> 0
[mode] u003d> 33206
[nlink] u003d> 1
[uid] u003d> 0
[gid] u003d> 0
[rdev] u003d> 0
[size] u003d> 26
[atime] u003d> 0
[mtime] u003d> 1259550052
[ctime] u003d> 0
[blksize] u003d> -1
[blocks] u003d> -1
)
