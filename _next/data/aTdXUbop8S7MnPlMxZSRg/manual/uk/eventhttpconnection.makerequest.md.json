{"pageProps":{"page":{"slug":"eventhttpconnection.makerequest.md","content":"# EventHttpConnection::makeRequest\n\n(PECL event >= 1.4.0-beta)\n\nEventHttpConnection::makeRequest — Робить HTTP-запит із зазначеного з'єднання.\n\n### Опис\n\n```methodsynopsis\npublic\n   EventHttpConnection::makeRequest(\n    EventHttpRequest\n     $req\n   , \n    int\n     $type\n   , \n    string\n     $uri\n   ): bool\n```\n\nРобить HTTP-запит із зазначеного з'єднання . `type`одна из констант`EventHttpRequest::CMD_*`\n\n### Список параметрів\n\n`req`\n\nОб'єкт підключення, через який надсилається запит.\n\n`type`\n\nодна из констант[`EventHttpRequest::CMD_*`](class.eventhttprequest.md#eventhttprequest.constants)\n\n`uri`\n\nURI, пов'язаний із запитом.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад використання** EventHttpConnection::makeRequest()\\*\\*\\*\\*\n\n```php\n<?php\nfunction _request_handler($req, $base) {\n    echo __FUNCTION__, PHP_EOL;\n\n    if (is_null($req)) {\n        echo \"Время вышло\\n\";\n    } else {\n        $response_code = $req->getResponseCode();\n\n        if ($response_code == 0) {\n            echo \"Соединение разорвано\\n\";\n        } elseif ($response_code != 200) {\n            echo \"Неожиданный ответ: $response_code\\n\";\n        } else {\n            echo \"Успешно: $response_code\\n\";\n            $buf = $req->getInputBuffer();\n            echo \"Тело ответа:\\n\";\n            while ($s = $buf->readLine(EventBuffer::EOL_ANY)) {\n                echo $s, PHP_EOL;\n            }\n        }\n    }\n\n    $base->exit(NULL);\n}\n\n$address = \"127.0.0.1\";\n$port = 80;\n\n$base = new EventBase();\n$conn = new EventHttpConnection($base, NULL, $address, $port);\n$conn->setTimeout(5);\n$req = new EventHttpRequest(\"_request_handler\", $base);\n\n$req->addHeader(\"Host\", $address, EventHttpRequest::OUTPUT_HEADER);\n$req->addHeader(\"Content-Length\", \"0\", EventHttpRequest::OUTPUT_HEADER);\n$conn->makeRequest($req, EventHttpRequest::CMD_GET, \"/index.cphp\");\n\n$base->loop();\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\n_request_handler\nSuccess: 200\nBody:\nPHP, date:\n2013-03-13T20:27:52+05:00\n```\n\n### Дивіться також\n\n-   [EventHttpRequest::addHeader()](eventhttprequest.addheader.md) \\- Додає заголовок HTTP до заголовків запиту\n","title":"EventHttpConnection::makeRequest","contentType":2,"navigation":[{"eventhttpconnection.getpeer.md":"« EventHttpConnection::getPeer"},{"eventhttpconnection.setclosecallback.md":"EventHttpConnection::setCloseCallback »"},{"index.md":"PHP Manual"},{"class.eventhttpconnection.md":"EventHttpConnection"}]}},"__N_SSG":true}