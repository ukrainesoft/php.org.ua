- [«Керування пам'яттю](mysqlnd.memory.md)
- [Порівняння плагінів mysqlnd з MySQL Proxy
»](mysqlnd.plugin.mysql-proxy.md)

- [PHP Manual](index.md)
- [Mysqlnd](book.mysqlnd.md)
- API для плагінів до вбудованого драйвера MySQL

# API для плагінів до вбудованого драйвера MySQL

## Зміст

- [Порівняння плагінів mysqlnd з MySQL
Proxy](mysqlnd.plugin.mysql-proxy.md)
- [Отримання API плагінів mysqlnd](mysqlnd.plugin.obtaining.md)
- [Архітектура плагінів MySQL Native
Driver](mysqlnd.plugin.architecture.md)
- [API плагінів mysqlnd](mysqlnd.plugin.api.md)
- [Починаємо розробку плагіна
mysqlnd](mysqlnd.plugin.developing.md)

API для плагінів до вбудованого драйвера MySQL є особливістю
вбудованого драйвера MySQL (`mysqlnd`). Плагіни `mysqlnd` працюють на
рівні між PHP-додатками та сервером MySQL. Це схоже на роботу
MySQL Proxy. Плагіни `mysqlnd` можуть реалізовувати стандартні завдання
MySQL Proxy, такі як балансування навантаження, моніторинг та оптимізація
швидкодії. При цьому, внаслідок іншої архітектури та
розташування, плагіни `mysqlnd` не мають деяких недоліків MySQL
Proxy. Наприклад, немає єдиної точки відмови, не потрібна установка
окремого proxy-сервера і немає потреби у вивченні нової мови
програмування Lua.

Плагін `mysqlnd` можна розглядати як модуль `mysqlnd`. Плагіни можуть
перехоплювати більшість функцій `mysqlnd`. Ці функції викликаються
модулями PHP, такими як `ext/mysql`, `ext/mysqli` та `PDO_MYSQL`. В
кінцевому рахунку, плагіни `mysqlnd` можуть перехоплювати всі запити,
зроблені цими модулями із клієнтської програми.

Внутрішні виклики функцій mysqlnd також можуть бути перехоплені або
замінені. Обмеження роботи з внутрішньою таблицею функцій `mysqlnd`
відсутні. Можливо налаштувати все таким чином, що під час виклику
певних функцій `mysqlnd` з модулів, що використовують `mysqlnd`, цей
виклик буде перенаправлятися у відповідну функцію плагіна
`mysqlnd`. Можливість маніпулювати внутрішньою таблицею функцій
`mysqlnd` дає плагінам максимум гнучкості.

Плагіни `mysqlnd` фактично є модулями PHP, написаними на C та
використовуючи API для плагінів `mysqlnd` (вбудований в драйвер
`mysqlnd`). Плагіни можуть бути повністю прозорими для програм PHP.
Змінювати програму не потрібно, оскільки плагіни працюють на іншому
рівні. Плагіни `mysqlnd` можна розглядати як такі, що працюють на рівень
нижче `mysqlnd`.

Нижченаведений список показує кілька можливих варіантів плагінів
`mysqlnd`.

- Балансування навантаження

- Поділ читання та запису. Прикладом є модуль
PECL/mysqlnd_ms (Master Slave). Модель поділяє запити на
читання та запис для налаштування реплікації.

- Відмовостійкість

- Рівномірне завантаження, запити на найменш завантажений сервер

- Моніторинг

- Логування запитів

- аналіз запитів

- аудит запитів. Прикладом є модуль PECL/mysqlnd_sip (SQL
Injection Protection, захист від SQL ін'єкцій). Модель
аналізує запити та виконує лише відповідні під набір
правил.

- продуктивність.

- кешування. Прикладом є модуль PECL/mysqlnd_qc (Query
Cache, кешування запитів).

- Обмеження ресурсів, що виділяються запитом

- Шардінг. Прикладом є модуль PECL/mysqlnd_mc (Multi
Connect). Модель намагається розбити запит SELECT на n частин,
використовуючи SELECT ... LIMIT part_1, SELECT LIMIT part_n. Він
відправляє запити на окремі MySQL-сервери та збирає
результат на клієнта.

*Доступні плагіни до вбудованого драйвера MySQL*

Існує кілька вже доступних плагінів mysqlnd. Список включає:

- *PECL/mysqlnd_mc* - Multi Connect plugin.

- *PECL/mysqlnd_ms* - Master Slave plugin.

- *PECL/mysqlnd_qc* - Query Cache (кешування запитів) plugin.

- *PECL/mysqlnd_pscache* - Prepared Statement Handle Cache plugin
(обробка кешування підготовлених запитів)

- *PECL/mysqlnd_sip* - SQL Injection Protection plugin (захист від
SQL-ін'єкцій)

- *PECL/mysqlnd_uh* - User Handler plugin (обробка користувачів)
