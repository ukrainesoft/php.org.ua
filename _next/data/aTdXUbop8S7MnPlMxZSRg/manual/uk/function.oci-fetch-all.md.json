{"pageProps":{"page":{"slug":"function.oci-fetch-all.md","content":"# oci\\_fetch\\_all\n\n(PHP 5, PHP 7, PHP 8, PECL OCI8 >= 1.1.0)\n\noci\\_fetch\\_all — Вибирає всі рядки з результату запиту на двовимірний масив.\n\n### Опис\n\n```methodsynopsis\noci_fetch_all(    resource $statement,    array &$output,    int $offset = 0,    int $limit = -1,    int $flags = OCI_FETCHSTATEMENT_BY_COLUMN | OCI_ASSOC): int\n```\n\nВибирає всі рядки з результату запиту двомірний масив. За промовчанням повертає всі рядки.\n\nЦя функція може бути викликана лише один раз для кожного запиту запущеного за допомогою [oci\\_execute()](function.oci-execute.md)\n\n### Список параметрів\n\n`statement`\n\nКоректний ідентифікатор виразу OCI8, отриманий з [oci\\_parse()](function.oci-parse.md) та виконаний функцією [oci\\_execute()](function.oci-execute.md), або ідентифікатор виразу `REF CURSOR`\n\n`output`\n\nЗмінна, що містить повернені рядки.\n\nLOB стовпці повертаються як рядки, для яких підтримується Oracle перетворення.\n\nСмотрите[oci\\_fetch\\_array()](function.oci-fetch-array.md) для більш детальної інформації про те, як проводиться вибірка даних та типів.\n\n`offset`\n\nЧисло рядків, які необхідно виключити з вибірки. За замовчуванням дорівнює 0, вибірка повертається з наступного ряду.\n\n`limit`\n\nЧисло рядків, що повертаються. За замовчуванням дорівнює -1, що означає повернення всіх рядків, починаючи із зазначених у `offset` + 1 попередній рядок.\n\n`flags`\n\nПараметр`flags` містить структуру масиву відбиває необхідність використання асоціативних масивів.\n\n**Структура массива**oci\\_fetch\\_all()\\*\\*\\*\\*\n\n| Константа | Опис |\n| --- | --- |\n| **`OCI_FETCHSTATEMENT_BY_ROW`** | Масив буде містити по одному підмасиву на кожен рядок запиту. |\n| **`OCI_FETCHSTATEMENT_BY_COLUMN`** | Масив міститиме по одному підмасиву на кожен стовпець. Використовується за промовчанням. |\n\nМасиви можуть бути проіндексовані або заголовками стовпців або пронумеровані. Повернеться лише один режим індексації.\n\n**Индексация массива**oci\\_fetch\\_all()\\*\\*\\*\\*\n\n| Константа | Опис |\n| --- | --- |\n| **`OCI_NUM`** | Для масиву кожного стовпця використовуються числові індекси. |\n| **`OCI_ASSOC`** | Для масиву кожного стовпця використовують асоціативні індекси. За замовчуванням. |\n\nВикористовуйте оператор додавання \"+\" для вибору певної комбінації структури та індексації масиву.\n\nРегістронезалежні (за замовчуванням у Oracle) імена полів у результуючому масиві матимуть асоціативні індекси у верхньому регістрі. Регістрозалежні імена полів матимуть індекси з тими самими регістрами символів, як і саме поле. Використовуйте [var\\_dump()](function.var-dump.md)на`output`, щоб перевірити відповідність регістрів символів для кожного запиту.\n\nУ запитах, у яких є кілька стовпців з однаковими іменами, необхідно використовувати псевдоніми. Інакше лише один із стовпців з'явиться в асоціативному масиві.\n\n### Значення, що повертаються\n\nПовертає кількість стовпців у `output`, який може набувати значення 0 або більше.\n\n### Приклади\n\n**Приклад #1 Приклад використання** oci\\_fetch\\_all()\\*\\*\\*\\*\n\n```php\n<?php\n\n$conn = oci_connect('hr', 'welcome', 'localhost/XE');\nif (!$conn) {\n    $e = oci_error();\n    trigger_error(htmlentities($e['message'], ENT_QUOTES), E_USER_ERROR);\n}\n\n$stid = oci_parse($conn, 'SELECT POSTAL_CODE, CITY FROM locations WHERE ROWNUM < 3');\noci_execute($stid);\n\n$nrows = oci_fetch_all($stid, $res);\n\necho \"$nrows строк получено<br>\\n\";\nvar_dump($res);\n\n// Вывод var_dump:\n//    2 строк получено\n//    array(2) {\n//      [\"POSTAL_CODE\"]=>\n//      array(2) {\n//        [0]=>\n//        string(6) \"00989x\"\n//        [1]=>\n//        string(6) \"10934x\"\n//      }\n//      [\"CITY\"]=>\n//      array(2) {\n//        [0]=>\n//        string(4) \"Roma\"\n//        [1]=>\n//        string(6) \"Venice\"\n//      }\n//    }\n\n// Форматирование результатов\necho \"<table border='1'>\\n\";\nforeach ($res as $col) {\n    echo \"<tr>\\n\";\n    foreach ($col as $item) {\n        echo \"    <td>\".($item !== null ? htmlentities($item, ENT_QUOTES) : \"\").\"</td>\\n\";\n    }\n    echo \"</tr>\\n\";\n}\necho \"</table>\\n\";\n\noci_free_statement($stid);\noci_close($conn);\n\n?>\n```\n\n**Приклад #2 Приклад використання** oci\\_fetch\\_all()**с**`OCI_FETCHSTATEMENT_BY_ROW`\\*\\*\\*\\*\n\n```php\n<?php\n\n$conn = oci_connect('hr', 'welcome', 'localhost/XE');\nif (!$conn) {\n    $e = oci_error();\n    trigger_error(htmlentities($e['message'], ENT_QUOTES), E_USER_ERROR);\n}\n\n$stid = oci_parse($conn, 'SELECT POSTAL_CODE, CITY FROM locations WHERE ROWNUM < 3');\noci_execute($stid);\n\n$nrows = oci_fetch_all($stid, $res, null, null, OCI_FETCHSTATEMENT_BY_ROW);\n\necho \"$nrows строк получено<br>\\n\";\nvar_dump($res);\n\n// Выведет:\n//    2 строк получено\n//    array(2) {\n//      [0]=>\n//      array(2) {\n//        [\"POSTAL_CODE\"]=>\n//        string(6) \"00989x\"\n//        [\"CITY\"]=>\n//        string(4) \"Roma\"\n//      }\n//      [1]=>\n//      array(2) {\n//        [\"POSTAL_CODE\"]=>\n//        string(6) \"10934x\"\n//        [\"CITY\"]=>\n//        string(6) \"Venice\"\n//      }\n//    }\n\noci_free_statement($stid);\noci_close($conn);\n\n?>\n```\n\n**Приклад #3 Приклад використання** oci\\_fetch\\_all()**с**`OCI_NUM`\\*\\*\\*\\*\n\n```php\n<?php\n\n$conn = oci_connect('hr', 'welcome', 'localhost/XE');\nif (!$conn) {\n    $e = oci_error();\n    trigger_error(htmlentities($e['message'], ENT_QUOTES), E_USER_ERROR);\n}\n\n$stid = oci_parse($conn, 'SELECT POSTAL_CODE, CITY FROM locations WHERE ROWNUM < 3');\noci_execute($stid);\n\n$nrows = oci_fetch_all($stid, $res, null, null, OCI_FETCHSTATEMENT_BY_ROW + OCI_NUM);\n\necho \"$nrows строк получено<br>\\n\";\nvar_dump($res);\n\n// Выведет:\n//    2 строк получено\n//    array(2) {\n//      [0]=>\n//      array(2) {\n//        [0]=>\n//        string(6) \"00989x\"\n//        [1]=>\n//        string(4) \"Roma\"\n//      }\n//      [1]=>\n//      array(2) {\n//        [0]=>\n//        string(6) \"10934x\"\n//        [1]=>\n//        string(6) \"Venice\"\n//      }\n//    }\n\noci_free_statement($stid);\noci_close($conn);\n\n?>\n```\n\n### Примітки\n\n> **Зауваження** :\n> \n> Использование`offset` неефективно. Всі ряди, що пропускаються, включаються в результат запиту повертається базою даних до PHP. Після цього вони виключаються. Більш ефективно використовувати SQL для відступу та обмеження рядів у запиті. Дивіться [oci\\_fetch\\_array()](function.oci-fetch-array.md)для Прикладов.\n\n> **Зауваження** :\n> \n> Запити, що повертають велику кількість рядів, можуть бути більш ефективними, якщо використовується однорядна функція вибірки, така як [oci\\_fetch\\_array()](function.oci-fetch-array.md)\n\n> **Зауваження** :\n> \n> Для запитів, що повертають велику кількість рядів, продуктивність може бути значно збільшена за допомогою збільшення значення опції [oci8.default\\_prefetch](oci8.configuration.md#ini.oci8.default-prefetch)или использования[oci\\_set\\_prefetch()](function.oci-set-prefetch.md)\n\n> **Зауваження** :\n> \n> Не повертає ряди для неявних результуючих наборів у Oracle Database 12*c*. Використовуйте замість цієї функції функцію [oci\\_fetch\\_array()](function.oci-fetch-array.md)\n\n### Дивіться також\n\n-   [oci\\_fetch()](function.oci-fetch.md) \\- Вибирає наступний рядок із результату в буфер\n-   [oci\\_fetch\\_array()](function.oci-fetch-array.md) \\- Повертає наступний рядок із результату запиту у вигляді асоціативного чи нумерованого масиву\n-   [oci\\_fetch\\_assoc()](function.oci-fetch-assoc.md) \\- Повертає наступний рядок із результату запиту у вигляді асоціативного масиву\n-   [oci\\_fetch\\_object()](function.oci-fetch-object.md) \\- Повертає наступний рядок із результату запиту у вигляді об'єкта\n-   [oci\\_fetch\\_row()](function.oci-fetch-row.md) \\- Повертає наступний рядок із результату запиту у вигляді нумерованого масиву\n-   [oci\\_set\\_prefetch()](function.oci-set-prefetch.md) \\- Встановлює кількість рядків, які будуть автоматично вибрані у буфер\n","title":"oci\\_fetch\\_all","contentType":2,"navigation":[{"function.oci-execute.md":"« oci\\_execute"},{"function.oci-fetch-array.md":"oci\\_fetch\\_array »"},{"index.md":"PHP Manual"},{"ref.oci8.md":"OCI8 Функції"}]}},"__N_SSG":true}