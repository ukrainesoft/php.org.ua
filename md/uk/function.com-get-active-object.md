- [«com_event_sink](function.com-event-sink.md)
- [com_load_typelib »](function.com-load-typelib.md)

- [PHP Manual](index.md)
- [Функції COM](ref.com.md)
- Повернути дескриптор на запущений екземпляр об'єкта COM

# com_get_active_object

(PHP 5, PHP 7, PHP 8)

com_get_active_object — Повернути дескриптор на запущений екземпляр.
об'єкт COM

### Опис

**com_get_active_object**(string `$prog_id`, ?int `$codepage` u003d
**`null`**): [variant](class.variant.md)

**com_get_active_object()** - це те саме, що і створення нового
екземпляра об'єкта [com](class.com.md), за винятком того, що
об'єкт буде повернутий, якщо його вже запущено. Програми OLE використовують
так звану "Таблицю Запущених Об'єктів" для можливості запускати
програми одного разу. Ця функція представляє обгортку над бібліотечною
COM-функцією GetActiveObject().

### Список параметрів

`prog_id`
`prog_id` має бути або ProgID або CLSID об'єкта, до якого ви хочете
отримати доступ (наприклад, `Word.Application`).

`codepage`
Робить те саме, що й у класі [com](class.com.md).

### Значення, що повертаються

Якщо запитаний об'єкт запущено, він буде повернутий вашому скрипту
як будь-який інший об'єкт COM.

### Помилки

Є безліч причин, з яких ця функція може завершитися з
помилкою. Найпоширеніша причина у тому, що об'єкт не запущений.
У такому разі буде викинуто виняток **`MK_E_UNAVAILABLE`**; ви
можете використовувати метод getCode для перевірки коду виключення.

### Список змін

| Версія | Опис |
|--------|---------------------------------------- ----|
| 8.0.0 | 'codepage' тепер допускає значення null. |

### Примітки

**Увага**

Використання **com_get_active_object()** у контексті веб-сервера - це
не найрозумніша ідея. Більшість програм COM/OLE спроектовані так,
що не можуть працювати одночасно з декількома користувачами, навіть
(або особливо) Microsoft Office. Більше корисної інформації читайте у
[» Considerations for Server-Side Automation of
Office](http://support.microsoft.com/kb/257757).
