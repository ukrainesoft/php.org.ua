- [« Основні поняття](mysqlinfo.concepts.md)
- [кодування символів »](mysqlinfo.concepts.charset.md)

- [PHP Manual](index.md)
- [Основні поняття](mysqlinfo.concepts.md)
- Буферизовані та небуферизовані запити

## Буферизовані та небуферизовані запити

За промовчанням запити використовують режим буферизації. Це означає що
результати запиту негайно надходять від сервера MySQL до PHP та
зберігаються у пам'яті PHP-процесу. Це дозволяє робити додаткові
операції, такі як підрахунок кількості рядків та переміщення (пошук)
поточного покажчика результату. Це також дає можливість виконувати
нові запити у тому ж з'єднанні під час роботи над результатом
останнього запиту. Недолік режиму буферизації є те, що
великі набори результатів можуть вимагати досить багато
оперативної пам'яті. Пам'ять залишається зайнятою до того часу, поки все
вказівники на результуючий набір не будуть видалені або результуючий
набір не буде явно звільнений, що автоматично відбувається під час
закінчення останнього запиту. Термін "результат збереження" ("store
result") також використовується для режиму буферизації, тому що весь
результуючий набір зберігається одразу.

> **Примітка**:
>
> При використанні libmysqlclient як бібліотеки обмеження
> пам'яті PHP не враховуватиме пам'ять, що використовується для результуючих
> наборів, якщо дані не будуть збережені у змінних PHP. З mysqlnd
> облік пам'яті також включатиме розмір результуючого набору.

Небуферизовані MySQL запити виконуються та повертають resource, поки
дані очікують на отримання на сервері MySQL. Це використовує менше пам'яті
на стороні PHP, але може збільшити навантаження на сервер. Поки що повний
результуючий набір не буде переданий із сервера, ніякі подальші
запити не можуть бути надіслані через це саме з'єднання.
Небуферизовані запити можуть бути відкладені як "use result".

Наступні характеристики буферизованих запитів мають бути
використані у випадках, коли ви очікуєте тільки обмежений
результуючий набір або хочете знати кількість рядків, що повертаються до
прочитання всіх рядків. Небуферизований режим має бути використаний
якщо ви очікуєте великі розміри результатів наборів.

Оскільки буферизовані запити застосовуються за замовчуванням, такі
приклади продемонструють як виконати небуферизовані запити
кожному з API

**Приклад #1 Приклад небуферизованого запиту: mysqli**

` <?php$mysqli u003du003dnew mysqli("localhost", "my_user", "my_password", "world");$uresult u003d $mysqli->query("SELECT Name FROM City", MYSQLI_USE_result ) {  while ($row u003d $uresult->fetch_assoc()) {      echo $row['Name'] . PHP_EOL; }}?> `

**Приклад #2 Приклад небуферизованого запиту: pdo_mysql**

` <?php$pdo u003d new PDO("mysql:hostu003dlocalhost;dbnameu003dworld", 'my_user', 'my_pass');$pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, false);$uresult u003d| ->query("SELECT Name FROM City");if ($uresult) {   while ($row u003d $uresult->fetch(PDO::FETCH_ASSOC)) {       echo $row'[' PHP_EOL; }}?> `
