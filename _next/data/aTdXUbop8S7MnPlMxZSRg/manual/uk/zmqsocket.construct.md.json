{"pageProps":{"page":{"slug":"zmqsocket.construct.md","content":"# ZMQSocket::\\_\\_construct\n\n(PECL zmq >= 0.5.0)\n\nZMQSocket::\\_\\_construct - Конструктор класу ZMQSocket\n\n### Опис\n\n```methodsynopsis\npublic ZMQSocket::__construct(    ZMQContext $context,    int $type,    string $persistent_id = null,    callable $on_new_socket = null)\n```\n\nСтворює екземпляр класу ZMQSocket. Параметр `persistent_id` може бути використаний для встановлення постійного з'єднання. Постійний сокет буде виділено з постійного контексту і залишатиметься активним протягом кількох запитів. Отримати той самий сокет для багатьох запитів можна за допомогою параметра `persistent_id`. Функція, задана в `on_new_socket` викликається лише за створенні нової структури сокету.\n\n### Список параметрів\n\n`context`\n\nОб'єкт класу ZMQContext.\n\n`type`\n\nТип сокету. Дивіться константи **`ZMQ::SOCKET_*`**\n\n`persistent_id`\n\nЯкщо параметр `persistent_id` вказано, що сокет буде доступний протягом декількох запитів. Якщо `context` не є постійним, сокет також повернеться до непостійного режиму.\n\n`on_new_socket`\n\nCallback-функція, яка буде викликана під час створення нового сокету. Ця функція не викликається у разі повторного використання постійного з'єднання.\n\n```methodsynopsis\ncallback(ZMQSocket $socket, string $persistent_id = null)\n```\n\n### Помилки\n\nВикидає **ZMQSocketException**в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад використання** ZMQSocket()\\*\\*\\*\\*\n\nВикористання функції зворотного дзвінка для зв'язку або підключення до сокету\n\n```php\n<?php\n\n/*\n  Здесь используется постоянный сокет, поэтому функция будет вызвана лишь\n  при первом обращении к скрипту.\n*/\nfunction on_new_socket_cb(ZMQSocket $socket, $persistent_id = null)\n{\n    if ($persistent_id === 'server') {\n        $socket->bind(\"tcp://localhost:12122\");\n    } else {\n        $socket->connect(\"tcp://localhost:12122\");\n    }\n}\n\n/* Создать новый контекст */\n$context = new ZMQContext();\n\n/* Создать сокет */\n$socket = $context->getSocket(ZMQ::SOCKET_REP, 'server', 'on_new_socket_cb');\n\n$message = $socket->recv();\necho \"Получено сообщение: {$message}\\n\";\n?>\n```\n","title":"ZMQSocket::\\_\\_construct","contentType":2,"navigation":[{"zmqsocket.connect.md":"« ZMQSocket::connect"},{"zmqsocket.disconnect.md":"ZMQSocket::disconnect »"},{"index.md":"PHP Manual"},{"class.zmqsocket.md":"ZMQSocket"}]}},"__N_SSG":true}