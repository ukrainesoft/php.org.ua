- [«fnmatch](function.fnmatch.md)
- [fpassthru»] (function.fpassthru.md)

- [PHP Manual](index.md)
- [Функції файлової системи](ref.filesystem.md)
- Відкриває файл або URL

# fopen

(PHP 4, PHP 5, PHP 7, PHP 8)

fopen — Відкриває файл або URL

### Опис

**fopen**(
string `$filename`,
string `$mode`,
bool `$use_include_path` u003d **`false`**,
?resource `$context` u003d **`null`**
): resource \ | false

**fopen()** закріплює іменований ресурс, зазначений у аргументі
`filename`, за потоком.

### Список параметрів

`filename`
Якщо `filename` передано у формі "scheme://...", він вважається URL і PHP
проведе пошук обробника протоколу (також відомого як "обертка")
для цієї схеми. Якщо жодна обгортка не закріплена за протоколом, PHP
видасть зауваження, щоб допомогти вам відстежити потенційну проблему
вашому скрипті і потім продовжить виконання, начебто `filename`
вказував на звичайний файл.

Якщо PHP встановлено, що `filename` вказує на локальний файл, тоді
спроба відкрити потік до цього файлу. Файл має бути
доступний PHP, так що вам слід переконатися, що права доступу на файл
це дозволяють. Якщо ви увімкнули
[open_basedir](ini.core.md#ini.open-basedir), то накладаються
подальші обмеження.

Якщо PHP встановив, що 'filename' вказує на зареєстрований
протокол і цей протокол зареєстрований як мережевий URL, PHP виконує
перевірку стану директиви
[allow_url_fopen](filesystem.configuration.md#ini.allow-url-fopen).
Якщо вона вимкнена, PHP видасть попередження та виклик fopen закінчиться
невдачею.

> **Примітка**:
>
> Список підтримуваних протоколів доступний у розділі [Підтримувані
> протоколи та обгортки](wrappers.md). Деякі протоколи (`обгортки`)
> підтримують `контекст` та/або опції `php.ini`. Зверніться до
> відповідній сторінці з описом використовуваного протоколу для
> отримання списку опцій, які можна встановити. (наприклад,
> значення `php.ini` `user_agent` використовується обгорткою `http`).

На платформі Windows, необхідно екранувати всі зворотні сліші в дорозі
до файлу або використовувати прямі сліші.

` <?php$handle u003dfopen("c:\folder\resource.txt", "r");?> `

`mode`
Параметр `mode` вказує тип доступу, який ви просите потоку.
Він може бути одним із наступних варіантів:

| `mode` | Опис |
|--------|---------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -----------|
| ``r'` | Відкриває файл лише для читання; поміщає покажчик на початок файлу. |
| ``r+'` | Відкриває файл для читання та запису; поміщає покажчик на початок файлу. |
| ``w'` | Відкриває файл для запису; в іншому випадку поводиться так само, як і "w +". |
| ``w+'` | Відкриває файл для читання та запису; поміщає покажчик на початок файлу і обрізає файл до нульової довжини. Якщо файл не існує – намагається його створити. |
| ``a'` | Відкриває файл для запису; поміщає покажчик у кінець файлу. Якщо файл не існує – намагається його створити. У цьому режимі функція [fseek()](function.fseek.md) не застосовується, записи завжди додаються до кінця. |
| ``a+'` | Відкриває файл для читання та запису; поміщає покажчик у кінець файлу. Якщо файл не існує – намагається його створити. У цьому режимі функція [fseek()](function.fseek.md) впливає лише на позицію читання, записи завжди додаються до кінця. |
| ``x'` | Створює та відкриває тільки для запису; поміщає покажчик на початок файлу. Якщо файл вже існує, виклик **fopen()** закінчиться невдачею, поверне **`false`** та видасть помилку рівня **`E_WARNING`**. Якщо файл не існує, він спробує його створити. Це еквівалентно вказівкам прапорів `O_EXCL|O_CREAT` для внутрішнього системного виклику `open(2)`. |
| ``x+'` | Створює та відкриває для читання та запису; в іншому має таку ж поведінку, що і ``x'`. |
| ``c'` | Відкриває файл лише для запису. Якщо файл не існує, він створюється. Якщо ж файл існує, то він не обрізається (на відміну від "w"), і виклик до цієї функції не викликає помилки (так само як і у випадку з "x"). Вказівник на файл буде встановлено на початок файлу. Це може бути корисно при бажанні заблокувати файл (дивіться [flock()](function.flock.md)) перед зміною, так як використання ``w'` може обрізати файл ще до того, як було отримано блокування (якщо ви хочете обрізати файл , Ви можете використовувати функцію [ftruncate()](function.ftruncate.md) після запиту на блокування). |
| ``c+'` | Відкриває файл для читання та запису; в іншому має таку ж поведінку, що і ``c'`. |
| ``e'` | Встановити прапорець close-on-exec (закрити під час запуску) на відкритий файловий дескриптор. Доступно лише в PHP скомпілюваному на системах, що підтримують POSIX.1-2008. |

**Список можливих режимів для **fopen()**, використовуючи `mode`**

> **Примітка**:
>
> Різні сімейства операційних систем мають різні угоди
> щодо закінчення рядків. Коли ви пишете текст і бажаєте вставити
> розрив рядка, ви повинні використовувати правильні символи (або символ)
> для операційної системи. Системи сімейства Unix використовують `
`
> як символ кінця рядка, системи сімейства Windows використовують
> `
` як символи закінчення рядка та системи сімейства
> Macintosh (Mac OS Classic) використовують `` як символ кінця
> Рядки.
>
> Якщо ви використовуєте неправильний символ кінця рядка під час редагування
> файлів, ви можете виявити, що при відкритті ці файли "дивно
> виглядають".
>
> Windows пропонує прапор режиму текстової трансляції (``t'`), який
> автоматично переведе `
`в`
` під час роботи з файлом. І
> навпаки - ви також можете використовувати "b", щоб примусово
> увімкнути бінарний режим, у якому ваші дані не будуть
> Перетворюватися. Щоб використовувати ці режими, вкажіть "b" або
> ``t'` останньою літерою параметра `mode`.
>
> Прапором трансляції за замовчуванням є "b". Ви можете використовувати
> режим ``t'`, якщо працюєте з текстовими файлами та використовуєте `
`
> для позначення кінця рядка у вашому скрипті, але при цьому
> припускаєте, що ваші файли будуть використовуватися в таких
> програмах, як "Блокнот" (у застарілих версіях). У всіх інших
> Використовуйте прапор "b".
>
> Якщо ви вкажете прапорець 't' під час роботи з бінарними файлами, ви
> можете зіткнутися з дивними проблемами з вашими даними, включаючи
> пошкоджені файли зображень та проблеми із символами `
`.

> **Примітка**:
>
> Знову ж таки з міркувань портованості рекомендується переписати
> старий код, який покладається на режим ``t'`, щоб натомість він
> використовував правильні кінці рядків та режим ``b'`.

> **Примітка**: Параметр `mode` ігнорується під час роботи з обгортками
> потоку `php://output`, `php://input`, `php://stdin`, `php://stdout`,
> `php://stderr` та `php://fd`.

`use_include_path`
Необов'язковий третій параметр use_include_path може бути встановлений
в '1' або **`true`**, якщо ви хочете провести пошук файлу в
[include_path](ini.core.md#ini.include-path).

`context`
Ресурс (resource) із [контекстом потоку](stream.contexts.md).

### Значення, що повертаються

Повертає покажчик на файл у разі успішного виконання або
**`false`** у разі виникнення помилки

### Помилки

У разі невдалого завершення роботи генерується помилка рівня
**`E_WARNING`**.

### Список змін

| Версія | Опис |
|---------------|------------------------|
| 7.0.16, 7.1.2 | Додана опція ``e'`. |

### Приклади

**Приклад #1 Приклади використання **fopen()****

` <?php$handle u003dfopen("/home/rasmus/file.txt", "r");$handle u003d fopen("/home/rasmus/file.gif", "wb");$handle u003dfopen ("http://www.example.com/", "r");$handle u003dfopen("ftp://user:password@example.com/somefile.txt", "w");?> `

### Примітки

**Увага**

При використанні SSL Microsoft IIS порушує протокол, закриваючи
з'єднання без надсилання індикатора `close_notify`. PHP повідомить про це
як "SSL: Fatal Protocol Error" в той момент, коли ви досягнете кінця
даних. Щоб обійти це, ви повинні встановити
[error_reporting](errorfunc.configuration.md#ini.error-reporting)
рівень, що виключає E_WARNING. PHP вміє визначати, що на стороні
сервера знаходиться проблемний IIS при відкритті потоку за допомогою обгортки
`https://` і виводить попередження. Якщо ви використовуєте
[fsockopen()](function.fsockopen.md) для створення `ssl://` сокету, ви
самі відповідаєте за визначення та придушення цього попередження.

> **Примітка**:
>
> Якщо ви стикаєтеся з проблемами під час читання або запису файлів,
> і ви використовуєте PHP у вигляді серверного модуля, переконайтеся, що
> процес сервера має доступ до використовуваних вами файлів та директорій.

> **Примітка**:
>
> Ця функція також може приймати директорії як параметр
> `filename`. Якщо ви не знаєте, чи є 'filename' файлом або
> директорією, то вам може знадобитися використовувати функцію
> [is_dir()](function.is-dir.md) до виклику функції **fopen()**.

### Дивіться також

- [Підтримувані протоколи та обгортки](wrappers.md)
- [fclose()](function.fclose.md) - Закриває відкритий дескриптор
файлу
- [fgets()](function.fgets.md) - Читає рядок із файлу
- [fread()](function.fread.md) - Бінарно-безпечне читання файлу
- [fwrite()](function.fwrite.md) - Бінарно-безпечний запис у файл
- [fsockopen()](function.fsockopen.md) - Відкриває з'єднання з
інтернет-сокетом або доменним сокетом Unix
- [file()](function.file.md) - Читає вміст файлу та поміщає
його в масив
- [file_exists()](function.file-exists.md) - Перевіряє існування
вказаного файлу чи каталогу
- [is_readable()](function.is-readable.md) - Визначає
існування файлу і чи доступний він для читання
- [stream_set_timeout()](function.stream-set-timeout.md) -
Встановити час очікування для потоку
- [popen()](function.popen.md) - Відкриває файловий покажчик
процесу
- [stream_context_create()](function.stream-context-create.md) -
Створює контекст потоку
- [umask()](function.umask.md) - Змінює поточну umask
- [SplFileObject](class.splfileobject.md)
