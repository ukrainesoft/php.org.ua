- [«Постійне з'єднання](mysqlnd.persist.md)
- [Примітки »](mysqlnd.notes.md)

- [PHP Manual](index.md)
- [Mysqlnd](book.mysqlnd.md)
- Статистика

# Статистика

*Використання статистичних даних*

MySQL Native Driver підтримує збір статистики щодо взаємодії
клієнт з сервером. Статистика збирається з двох основних точок:

- Клієнтська статистика

- Статистика з'єднання

Якщо ви використовуєте модуль `mysqli`, ця статистика доступна за допомогою
двох функцій, що звертаються до API:

- [mysqli_get_client_stats()](function.mysqli-get-client-stats.md)

- [mysqli_get_connection_stats()](mysqli.get-connection-stats.md)

> **Примітка**:
>
> Статистика агрегується з усіх модулів, які використовують MySQL Native
> Driver. Наприклад, якщо підключити і `ext/mysql` та `ext/mysqli` через
> MySQL Native Driver, як виклики функцій `ext/mysql` так і `ext/mysqli`
> будуть внесені до загальної статистики. Можливість розділити статистику в
> Залежно від використаного модуля відсутня. Ви можете
> конфігурувати драйвера PDO MySQL, `ext/mysql` та `ext/mysqli` для
> Опціональне використання MySQL Native Driver. При цьому всі три
> модулі змінюватимуть статистику.

*Доступ до клієнтської статистики*

Для отримання клієнтської статистики потрібно виконати функцію
[mysqli_get_client_stats()](function.mysqli-get-client-stats.md).
Функція викликається без настройок.

Функція повертає асоціативний масив, який використовує як ключі
назви метрик статистики та як значення цих метрик,
власне, значення.

Також клієнтська статистика доступна за допомогою функції
[phpinfo()](function.phpinfo.md).

*Доступ до статистики з'єднання*

Щоб отримати статистику з'єднання, виконайте функцію
[mysqli_get_connection_stats()](mysqli.get-connection-stats.md),
передавши як параметр ресурс з'єднання.

Функція повертає асоціативний масив, який використовує як ключі
назви метрик статистики та як значення цих метрик,
власне, значення.

*Буферизовані та небуферизовані результуючі набори*

Результуючі набори можуть бути буферизовані та небуферизовані.
При використанні налаштувань за промовчанням `ext/mysql` та `ext/mysqli`
працюють із буферизованими результуючими наборами при використанні
нормальних (не підготовлених) запитів. Буферизовані результуючі
набори кешуються за клієнта. Після виконання запиту, все
результати передаються на клієнта, де зберігаються у кеші. Перевага
буферизованих запитів у тому, що відразу вивільняються серверні
ресурси, пов'язані зі зберіганням результуючого набору

Небуферизовані результуючі набори, з іншого боку, зберігаються на
сервері набагато довше. Якщо ви хочете скоротити споживання пам'яті на
клієнта, але при цьому навантажити сервер, використовуйте небуферизовані
результуючі набори. Якщо вузьким місцем у вашій системі є сервер
баз даних, то вам варто задуматися про якнайшвидше переміщення результатів
на клієнта. Зазвичай клієнти масштабуються набагато легше, ніж сервер БД.
"Навантаження" лягає не тільки на пам'ять, але й на інші ресурси, які
повинна підтримувати базу даних для обслуговування з'єднання, такі як
відкриті файлові дескриптори та нитки виконання.

Підготовлені запити за замовчуванням використовують небуферизовані
результуючі набори. У будь-якому випадку, ви можете використати функцію
[mysqli_stmt_store_result()](mysqli-stmt.store-result.md) для
Буферизація результатів.

*Статистика, що повертається MySQL Native Driver*

Наступна таблиця демонструє список функцій, що повертаються.
[mysqli_get_client_stats()](function.mysqli-get-client-stats.md) та
[mysqli_get_connection_stats()](mysqli.get-connection-stats.md)
статистики.

[TABLE]

**Статистика mysqlnd: Мережа**

*Результуючий набір*

[TABLE]

**Статистика mysqlnd: результуючий набір**

[TABLE]

**Статистика mysqlnd: З'єднання**

[TABLE]

**Статистика mysqlnd: Команди COM\_\***

*Інше*

[TABLE]

**Статистика mysqlnd: Інше**
