{"pageProps":{"page":{"slug":"function.openssl-pkcs7-encrypt.md","content":"# openssl\\_pkcs7\\_encrypt\n\n(PHP 4 >= 4.0.6, PHP 5, PHP 7, PHP 8)\n\nopenssl\\_pkcs7\\_encrypt — Шифрує повідомлення S/MIME\n\n### Опис\n\n```methodsynopsis\nopenssl_pkcs7_encrypt(    string $input_filename,    string $output_filename,    OpenSSLCertificate|array|string $certificate,    ?array $headers,    int $flags = 0,    int $cipher_algo = OPENSSL_CIPHER_AES_128_CBC): bool\n```\n\n**openssl\\_pkcs7\\_encrypt()** читає повідомлення з файлу `input_filename`шифрує його за допомогою 40-бітного RC2 шифру таким чином, що розшифрувати його можуть тільки одержувачі, зазначеними в `certificate`\n\n### Список параметрів\n\n`input_filename`\n\n`output_filename`\n\n`certificate`\n\nМасив, або одиничний сертифікат X.509.\n\n`headers`\n\n`headers` задається масивом заголовків, які будуть додані на початок повідомлення перед шифруванням.\n\n`headers` може бути як асоціативним масивом, де як ключі використовуються імена заголовків, або індексованим масивом, що містить повні рядки заголовків.\n\n`flags`\n\n`flags`используется для настройки процесса шифрования. Смотрите[Константи PKCS7](openssl.pkcs7.flags.md)\n\n`cipher_algo`\n\nОдна из[констант шифрів](openssl.ciphers.md)\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| 8.1.0 | Алгоритм шифрування за замовчуванням (`cipher_algo`) тепер AES-128-CBC (**`OPENSSL_CIPHER_AES_128_CBC`**). Раніше використовувався алгоритм PKCS7/CMS (**`OPENSSL_CIPHER_RC2_40`** |\n| 8.0.0 | `certificate` тепер приймає екземпляр [OpenSSLCertificate](class.opensslcertificate.md); раніше приймався ресурс ([resource](language.types.resource.md)) типу`OpenSSL X.509 CSR` |\n\n### Приклади\n\n**Приклад #1 Приклад використання** openssl\\_pkcs7\\_encrypt()\\*\\*\\*\\*\n\n```php\n<?php\n// Сообщение, которое вы хотите зашифровать и отправить своему секретному\n// агенту с позывным Козодой. У вас есть его сертификат в файле nighthawk.pem\n$data = <<<EOD\nКозодой,\n\nСовершенно секретно! После прочтения сжечь!\n\nВраги приближаются! Связной с новым поддельным паспортом\nбудет ждать тебя завтра в кафе в 8.30 утра.\n\nПароль - \"У вас ус отклеился!\"\nОтзыв - \"Это не ус, а борода!\"\n\nEOD;\n\n// загружаем ключ\n$key = file_get_contents(\"nighthawk.pem\");\n\n// записываем сообщение в файл\n$fp = fopen(\"msg.txt\", \"w\");\nfwrite($fp, $data);\nfclose($fp);\n\n// шифруем\nif (openssl_pkcs7_encrypt(\"msg.txt\", \"enc.txt\", $key,\n    array(\"To\" => \"nighthawk@example.com\", // ассоциативный синтаксис\n          \"From: HQ <hq@example.com>\", // индексированный синтаксис\n          \"Subject\" => \"СРОЧНО!!! ВАЖНО!!!\"))) {\n    // сообщение зашифровано - отправляем!!\n    exec(ini_get(\"sendmail_path\") . \" < enc.txt\");\n}\n?>\n```\n","title":"openssl\\_pkcs7\\_encrypt","contentType":2,"navigation":[{"function.openssl-pkcs7-decrypt.md":"« openssl\\_pkcs7\\_decrypt"},{"function.openssl-pkcs7-read.md":"openssl\\_pkcs7\\_read »"},{"index.md":"PHP Manual"},{"ref.openssl.md":"Функції OpenSSL"}]}},"__N_SSG":true}