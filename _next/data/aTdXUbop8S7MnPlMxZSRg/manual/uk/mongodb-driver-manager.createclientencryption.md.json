{"pageProps":{"page":{"slug":"mongodb-driver-manager.createclientencryption.md","content":"# MongoDB\\\\Driver\\\\Manager::createClientEncryption\n\n(mongodb >=1.7.0)\n\nMongoDB\\\\Driver\\\\Manager::createClientEncryption — Створення нового об'єкта ClientEncryption\n\n### Опис\n\n```methodsynopsis\nfinal public MongoDB\\Driver\\Manager::createClientEncryption(array $options): MongoDB\\Driver\\ClientEncryption\n```\n\nСтворює новий об'єкт [MongoDB\\\\Driver\\\\ClientEncryption](class.mongodb-driver-clientencryption.md) із заданими параметрами.\n\n### Список параметрів\n\n`options`\n\n**options**\n\n| Параметр | Тип | Опис |\n| --- | --- | --- |\n| keyVaultClient | [MongoDB\\\\Driver\\\\Manager](class.mongodb-driver-manager.md) | Менеджер маршрутизації запитів ключів даних окремий кластер MongoDB. За замовчуванням метод вибирає поточний менеджер та кластер. |\n| keyVaultNamespace | string | Повний простір імен (наприклад, `\"databaseName.collectionName\"`), що означає колекцію, яка містить усі ключі даних, що використовуються для шифрування та дешифрування. Обов'язковий параметр. |\n| kmsProviders | array |  |\n| Документ, який містить конфігурацію для одного або кількох провайдерів KMS, які використовуються для шифрування ключів даних. Підтримуються провайдери `\"aws\"` `\"azure\"` `\"gcp\"`и`\"local\"`, і принаймні один з них повинен бути вказаний. |  |  |\n\nЯкщо для `\"aws\"` `\"azure\"`или`\"gcp\"` вказано порожній документ, драйвер спробує налаштувати провайдера, використовуючи [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\nФормат для`\"aws\"` виглядає наступним чином:\n\naws: { accessKeyId:, secretAccessKey:, sessionToken:}\n\nФормат для`\"azure\"` виглядає наступним чином:\n\nazure: { tenantId:, clientId:, clientSecret:, identityPlatformEndpoint: // За замовчуванням \"login.microsoftonline.com\"\n\n}\n\nФормат для`\"gcp\"` виглядає наступним чином:\n\ngcp: { email:, privateKey:|<MongoDB\\\\BSON\\\\Binary>, endpoint: // За замовчуванням \"oauth2.googleapis.com\"\n\n}\n\nФормат для`\"kmip\"` виглядає наступним чином:\n\nkmip: { endpoint:}\n\nФормат для`\"local\"` виглядає наступним чином:\n\nlocal: { // 96-байтовий головний ключ, який використовується для шифрування/дешифрування ключів даних key: |<MongoDB\\\\BSON\\\\Binary> }\n\n| | tlsOptions | array |\n\nДокумент, який містить конфігурацію TLS для одного або кількох KMS провайдерів. Підтримуються провайдери `\"aws\"` `\"azure\"` `\"gcp\"`и`\"kmip\"`. Усі провайдери підтримують такі опції:\n\n: { tlsCaFile:, tlsCertificateKeyFile:, tlsCertificateKeyFilePassword:, tlsDisableOCSPEndpointCheck:}\n\n### Значення, що повертаються\n\nПовертає новий екземпляр [MongoDB\\\\Driver\\\\ClientEncryption](class.mongodb-driver-clientencryption.md)\n\n### Помилки\n\n-   При помилці парсингу аргумент кидає виняток[MongoDB\\\\Driver\\\\Exception\\\\InvalidArgumentException](class.mongodb-driver-exception-invalidargumentexception.md)\n-   Викидає виняток [MongoDB\\\\Driver\\\\Exception\\\\RuntimeException](class.mongodb-driver-exception-runtimeexception.md)якщо модуль був скомпільований без підтримки libmongocrypt\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| PECL mongodb 1.16.0 |  |\n| Провайдер AWS KMS для шифрування на стороні клієнта тепер приймає параметр `\"sessionToken\"`, який можна використовувати для автентифікації з тимчасовими обліковими даними AWS. |  |\n\nДля налаштування `\"tlsOptions\"`добавлена настройка`\"tlsDisableOCSPEndpointCheck\"`\n\nЯкщо для KMS-провайдерів `\"azure\"`или`\"gcp\"` вказано порожній документ, драйвер спробує налаштувати провайдера, заповнивши [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\n| | PECL mongodb 1.15.0 |\n\nЯкщо для KMS-провайдера `\"aws\"` вказано порожній документ, драйвер спробує налаштувати провайдера, заповнивши [» Автоматичні облікові дані](https://github.com/mongodb/specifications/blob/master/source/client-side-encryption/client-side-encryption.rst#automatic-credentials)\n\n| | PECL mongodb 1.12.0 |\n\nKMIP тепер підтримується як KMS провайдер для шифрування на стороні клієнта і може бути налаштований за допомогою параметра `\"kmsProviders\"`\n\nДобавлен параметр`\"tlsOptions\"`\n\n| | PECL mongodb 1.10.0 Azure та GCP тепер підтримуються як постачальники KMS для шифрування на стороні клієнта і можуть бути налаштовані в полі `\"kmsProviders\"`параметра драйвера`\"autoEncryption\"`. Рядки в кодуванні Base64 тепер приймаються як альтернатива [MongoDB\\\\BSON\\\\Binary](class.mongodb-bson-binary.md)для параметров внутри`\"kmsProviders\"`.\n\n### Дивіться також\n\n-   [MongoDB\\\\Driver\\\\ClientEncryption::\\_\\_construct()](mongodb-driver-clientencryption.construct.md) \\- Створює новий об'єкт ClientEncryption\n-   Сторінка в посібнику з MongoDB:[» Явне (ручне) шифрування на рівні поля на стороні клієнта](https://www.mongodb.com/docs/manual/core/security-explicit-client-side-encryption/)\n","title":"MongoDB\\\\Driver\\\\Manager::createClientEncryption","contentType":2,"navigation":[{"mongodb-driver-manager.construct.md":"« MongoDB\\\\Driver\\\\Manager::\\_\\_construct"},{"mongodb-driver-manager.executebulkwrite.md":"MongoDB\\\\Driver\\\\Manager::executeBulkWrite »"},{"index.md":"PHP Manual"},{"class.mongodb-driver-manager.md":"MongoDB\\\\Driver\\\\Manager"}]}},"__N_SSG":true}