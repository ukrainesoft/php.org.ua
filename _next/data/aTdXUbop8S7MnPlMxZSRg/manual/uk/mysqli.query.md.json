{"pageProps":{"page":{"slug":"mysqli.query.md","content":"# mysqli::query\n\n# mysqli\\_query\n\n(PHP 5, PHP 7, PHP 8)\n\nmysqli::query -- mysqli\\_query — Виконує запит до бази даних\n\n### Опис\n\nОб'єктно-орієнтований стиль\n\n```methodsynopsis\npublic mysqli::query(string $query, int $result_mode = MYSQLI_STORE_RESULT): mysqli_result|bool\n```\n\nПроцедурний стиль\n\n```methodsynopsis\nmysqli_query(mysqli $mysql, string $query, int $result_mode = MYSQLI_STORE_RESULT): mysqli_result|bool\n```\n\nВиконує запит `query` до бази даних.\n\n**Увага**\n\n# Попередження безпеки: SQL-ін'єкція\n\nЗамість складання рядку запиту з включенням змінних значень необхідно [готувати запити](mysqli.quickstart.prepared-statements.md). Або рядки запиту мають бути екрановані функцією [mysqli\\_real\\_escape\\_string()](mysqli.real-escape-string.md) та правильно відформатовані.\n\nДля не DML-запитів (не INSERT, UPDATE чи DELETE), ця функція рівносильна виклику функції [mysqli\\_real\\_query()](mysqli.real-query.md), а затем[mysqli\\_use\\_result()](mysqli.use-result.md) або [mysqli\\_store\\_result()](mysqli.store-result.md)\n\n> **Зауваження** :\n> \n> Якщо довжина передається в функцію **mysqli\\_query()** вирази більше значення системної змінної `max_allowed_packet`сервера, будет сгенерирована ошибка. MySQL-драйвер (`mysqlnd`) та клієнтська бібліотека MySQL (`libmysqlclient`) викидають різні коди помилок. Поведінка функції буде такою:\n> \n> -   `mysqlnd`на платформі Linux повертає код помилки 1153. Повідомлення про помилку означає розмір пакета перевищує`max_allowed_packet`байт.\n>     \n> -   `mysqlnd`на платформі Windows повертає код помилки 2006 року. Це повідомлення про помилку означає відмову сервера.\n>     \n> -   `libmysqlclient`на всіх платформах повертає код помилки 2006 року. Це повідомлення про помилку означає відмову сервера.\n>     \n\n### Список параметрів\n\n`mysql`\n\nТільки для процедурного стилю: об'єкт [mysqli](class.mysqli.md), який повернула функція [mysqli\\_connect()](function.mysqli-connect.md)или функция[mysqli\\_init()](mysqli.init.md)\n\n`query`\n\nТекст запиту.\n\n`result_mode`\n\nРежим результату може бути однією з трьох констант, які вказують, як результат буде повернено сервером MySQL.\n\n**`MYSQLI_STORE_RESULT`** (за замовчуванням) – повертає об'єкт [mysqli\\_result](class.mysqli-result.md) із буферизованим набором результатів.\n\n**`MYSQLI_USE_RESULT`** - Повертає об'єкт [mysqli\\_result](class.mysqli-result.md) із небуферизованим набором результатів. Поки є відкладені записи, що очікують вибірки, лінія з'єднання буде зайнята і всі наступні дзвінки повертатимуть помилку `Commands out of sync`. Щоб уникнути помилки, всі записи повинні бути отримані з сервера або набір результатів має бути відкинуто шляхом виклику [mysqli\\_free\\_result()](mysqli-result.free.md)\n\n**`MYSQLI_ASYNC`** (Доступно з mysqlnd) - запит виконується асинхронно, набір результатів відразу не повертається. Потім викликають функцію [mysqli\\_poll()](mysqli.poll.md) для отримання результатів за цими запитами. Можна використовувати у поєднанні з константою **`MYSQLI_STORE_RESULT`** або **`MYSQLI_USE_RESULT`**\n\n### Значення, що повертаються\n\nПовертає **`false`** у разі виникнення помилки. У разі успішного виконання запитів, які створюють набір результатів, таких як `SELECT, SHOW, DESCRIBE`или`EXPLAIN`, функция**mysqli\\_query()** поверне об'єкт [mysqli\\_result](class.mysqli-result.md). Для решти успішних запитів **mysqli\\_query()** поверне **`true`**\n\n### Помилки\n\nЯкщо сповіщення про помилки mysqli включено (**`MYSQLI_REPORT_ERROR`**) та запитана операція не вдалася, видається попередження. Якщо, крім того, встановлено режим **`MYSQLI_REPORT_STRICT`**, натомість буде викинуто виняток [mysqli\\_sql\\_exception](class.mysqli-sql-exception.md)\n\n### Приклади\n\n**Приклад #1 Приклад використання** mysqli::query()\\*\\*\\*\\*\n\nОб'єктно-орієнтований стиль\n\n```php\n<?php\n\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n$mysqli = new mysqli(\"localhost\", \"my_user\", \"my_password\", \"world\");\n\n/* Создание таблицы, не возвращает набор результатов */\n$mysqli->query(\"CREATE TEMPORARY TABLE myCity LIKE City\");\nprintf(\"Таблица myCity создана.\\n\");\n\n/* Запросы SELECT, возвращают набор результатов */\n$result = $mysqli->query(\"SELECT Name FROM City LIMIT 10\");\nprintf(\"Запрос SELECT вернул %d строк.\\n\", $result->num_rows);\n\n/* Если нужно извлечь большой объем данных, используем MYSQLI_USE_RESULT */\n$result = $mysqli->query(\"SELECT * FROM City\", MYSQLI_USE_RESULT);\n\n/* Важно заметить, что мы не можем вызывать функции, которые взаимодействуют\n   с сервером, пока не закроем набор результатов. Все подобные вызовы\n   будут вызывать ошибку 'out of sync' */\n$mysqli->query(\"SET @a:='this will not work'\");\n```\n\nПроцедурний стиль\n\n```php\n<?php\n\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n$link = mysqli_connect(\"localhost\", \"my_user\", \"my_password\", \"world\");\n\n/* Создание таблицы, не возвращает набор результатов */\nmysqli_query($link, \"CREATE TEMPORARY TABLE myCity LIKE City\");\nprintf(\"Таблица myCity создана.\\n\");\n\n/* Запросы SELECT, возвращают набор результатов */\n$result = mysqli_query($link, \"SELECT Name FROM City LIMIT 10\");\nprintf(\"Запрос SELECT вернул %d строк.\\n\", mysqli_num_rows($result));\n\n/* Если нужно извлечь большой объем данных, используем MYSQLI_USE_RESULT */\n$result = mysqli_query($link, \"SELECT * FROM City\", MYSQLI_USE_RESULT);\n\n/* Важно заметить, что мы не можем вызывать функции, которые взаимодействуют\n   с сервером, пока не закроем набор результатов. Все подобные вызовы\n   будут вызывать ошибку 'out of sync' */\nmysqli_query($link, \"SET @a:='this will not work'\");\n```\n\nРезультат виконання наведених прикладів:\n\n```\nТаблица myCity создана.\nЗапрос SELECT вернул 10 строк.\n\nFatal error: Uncaught mysqli_sql_exception: Commands out of sync; you can't run this command now in...\n```\n\n### Дивіться також\n\n-   [mysqli\\_execute\\_query()](mysqli.execute-query.md) \\- готує, зв'язує параметри та виконує SQL-запит\n-   [mysqli\\_real\\_query()](mysqli.real-query.md) \\- Виконання SQL запиту\n-   [mysqli\\_multi\\_query()](mysqli.multi-query.md) \\- Виконує один або кілька запитів до бази даних\n-   [mysqli\\_prepare()](mysqli.prepare.md) \\- готує SQL вираз до виконання\n-   [mysqli\\_free\\_result()](mysqli-result.free.md) \\- звільняє пам'ять, зайняту результатами запиту\n","title":"mysqli::query","contentType":2,"navigation":[{"mysqli.prepare.md":"« mysqli::prepare"},{"mysqli.real-connect.md":"mysqli::real\\_connect »"},{"index.md":"PHP Manual"},{"class.mysqli.md":"mysqli"}]}},"__N_SSG":true}