{"pageProps":{"page":{"slug":"phardata.buildfromiterator.md","content":"# PharData::buildFromIterator\n\n(PHP 5 >= 5.3.0, PHP 7, PHP 8, PECL phar >= 2.0.0)\n\nPharData::buildFromIterator — Створення tar/zip-архіву за допомогою ітератора\n\n### Опис\n\n```methodsynopsis\npublic PharData::buildFromIterator(Traversable $iterator, ?string $baseDirectory = null): array\n```\n\nЗаповнення архів tar або zip за допомогою ітератора. Підтримуються два типи ітераторів: ітератор, який зв'язує файл на диску з файлом усередині архіву та ітератор у стилі DirectoryIterator, який повертає об'єкти SplFileInfo. Для ітераторів, які повертають об'єкти SplFileInfo, другий параметр є обов'язковим.\n\n### Список параметрів\n\n`iterator`\n\nІтератор, що надає зв'язки ключ = значення, або об'єкти SplFileInfo\n\n`baseDirectory`\n\nДля ітераторів, що повертають об'єкти SplFileInfo, частина повного шляху файлів, що додаються, яка буде видалятися з повного шляху всередині архіву.\n\n### Значення, що повертаються\n\n**PharData::buildFromIterator()** повертає асоціативний масив, який пов'язує шлях до файлу всередині архіву з повним шляхом до файлу на диску.\n\n### Помилки\n\nМетод викидає виняток [UnexpectedValueException](class.unexpectedvalueexception.md), якщо ітератор повернув некоректне значення, наприклад, цілий ключ замість рядка. Виняток [BadMethodCallException](class.badmethodcallexception.md) викидається коли заданий ітератор, який повертає об'єкти SplFileInfo без завдання параметра `baseDirectory`. У разі проблем із записом на диск кидається виняток [PharException](class.pharexception.md)\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| 8.1.0 | **PharData::buildFromIterator()** більше не повертає значення **`false`** |\n| 8.0.0 | `baseDirectory` тепер допускає значення null. |\n\n### Приклади\n\n**Приклад #1 Приклад використання** PharData::buildFromIterator()**с SplFileInfo**\n\nДля більшості tar/zip-архівів, структура відображає дерево директорій на файловій системі. Наприклад, для створення tar/zip-архіву, що містить таку структуру директорій та файлів:\n\n/path/to/project/ config/ dist.xml debug.xml lib/ file1.php file2.php src/ processthing.php www/ index.php cli/ index.php\n\nПотрібно використовувати такий код для створення архіву \"project.tar\":\n\n```php\n<?php\n$phar = new PharData('project.tar');\n$phar->buildFromIterator(\n    new RecursiveIteratorIterator(\n     new RecursiveDirectoryIterator('/path/to/project')),\n    '/path/to/project');\n?>\n```\n\nФайл`project.tar` можна використовувати одразу ж після його створення . **PharData::buildFromIterator()** не здійснює налаштування стиснення або додавання метаданих. Ці дії необхідно зробити самостійно після створення архіву.\n\nЦікаве зауваження: **PharData::buildFromIterator()** також можна використовувати для копіювання контенту вже існуючого phar, tar або zip-архіву, так як об'єкт PharData успадковує [DirectoryIterator](class.directoryiterator.md) :\n\n```php\n<?php\n$phar = new PharData('project.tar');\n$phar->buildFromIterator(\n    new RecursiveIteratorIterator(\n     new Phar('/path/to/anotherphar.phar')),\n    'phar:///path/to/anotherphar.phar/path/to/project');\n$phar->setStub($phar->createDefaultStub('cli/index.php', 'www/index.php'));\n?>\n```\n\n**Приклад #2 Приклад використання** PharData::buildFromIterator()\\*\\* з іншим ітератором\\*\\*\n\nМожна використовувати ітератори, що повертають зв'язку \"ключ\" => \"значення\", наприклад [ArrayIterator](class.arrayiterator.md) :\n\n```php\n<?php\n$phar = new PharData('project.tar');\n$phar->buildFromIterator(\n    new ArrayIterator(\n     array(\n        'internal/file.php' => dirname(__FILE__) . '/somefile.php',\n        'another/file.jpg' => fopen('/path/to/bigfile.jpg', 'rb'),\n     )));\n?>\n```\n\n### Дивіться також\n\n-   [Phar::buildFromIterator()](phar.buildfromiterator.md) \\- Створює phar-архів із ітератора\n","title":"PharData::buildFromIterator","contentType":2,"navigation":[{"phardata.buildfromdirectory.md":"« PharData::buildFromDirectory"},{"phardata.compress.md":"PharData::compress »"},{"index.md":"PHP Manual"},{"class.phardata.md":"PharData"}]}},"__N_SSG":true}