{"pageProps":{"page":{"slug":"gearmanclient.dostatus.md","content":"# GearmanClient::doStatus\n\n(PECL gearman >= 0.5.0)\n\nGearmanClient::doStatus — Отримання статусу завдання, що виконується\n\n### Опис\n\n```methodsynopsis\npublic GearmanClient::doStatus(): array\n```\n\nПовертає статус обробки запущеного завдання. Цей метод викликається між викликами, що повторюються. [GearmanClient::doNormal()](gearmanclient.donormal.md)\n\n### Список параметрів\n\nЦя функція не має параметрів.\n\n### Значення, що повертаються\n\nМасив, що становить відсоткове відношення виконаної роботи. Перший елемент відповідає кількості оброблених чанків, другий – загальна кількість даних.\n\n### Приклади\n\n**Приклад #1 Отримання стану виконання довгого завдання**\n\nУ цьому прикладі в обробник, що перевертає рядок, впроваджена затримка, щоб змоделювати завдання, що довго виконується. Після кожної паузи обробник виконує [GearmanJob::status()](gearmanjob.status.md)результат якого підхоплюється клієнтом.\n\n```php\n<?php\n\necho \"Запуск\\n\";\n\n# Создаём объект клиента.\n$gmclient= new GearmanClient();\n\n# Добавляем сервер по умолчанию (localhost).\n$gmclient->addServer();\n\necho \"Отправка задание\\n\";\n\n# Отправляем задание перевернуть строку\ndo\n{\n  $result = $gmclient->doNormal(\"reverse\", \"Hello!\");\n\n  # Проверяем, есть ли ошибки или готовые данные.\n  switch($gmclient->returnCode())\n  {\n    case GEARMAN_WORK_DATA:\n      break;\n    case GEARMAN_WORK_STATUS:\n      # получить статус выполнения задания\n      list($numerator, $denominator)= $gmclient->doStatus();\n      echo \"Статус: $numerator/$denominator завершено\\n\";\n      break;\n    case GEARMAN_WORK_FAIL:\n      echo \"Ошибка\\n\";\n      exit;\n    case GEARMAN_SUCCESS:\n      break;\n    default:\n      echo \"Код возврата: \" . $gmclient->returnCode() . \"\\n\";\n      exit;\n  }\n}\nwhile($gmclient->returnCode() != GEARMAN_SUCCESS);\n\necho \"Успешно: $result\\n\";\n\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\nЗапуск\nОтправка задания\nСостояние: 1/6 завершено\nСостояние: 2/6 завершено\nСостояние: 3/6 завершено\nСостояние: 4/6 завершено\nСостояние: 5/6 завершено\nСостояние: 6/6 завершено\nУспешно: !olleH\n```\n\n### Дивіться також\n\n-   [GearmanClient::doNormal()](gearmanclient.donormal.md) \\- Виконує одиночне завдання та повертає результат\n-   [GearmanJob::status()](gearmanjob.status.md) \\- Надсилання статусу завдання (застарілий метод)\n","title":"GearmanClient::doStatus","contentType":2,"navigation":[{"gearmanclient.donormal.md":"« GearmanClient::doNormal"},{"gearmanclient.echo.md":"GearmanClient::echo »"},{"index.md":"PHP Manual"},{"class.gearmanclient.md":"GearmanClient"}]}},"__N_SSG":true}