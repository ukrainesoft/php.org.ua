<!DOCTYPE html><html lang="uk"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#000000"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-config" content="/favicon/browserconfig.xml"/><meta name="theme-color" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><meta name="description" content="üá∫üá¶ php - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∑ PHP –£–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é."/><title>–ü—Ä–∏–∫–ª–∞–¥–∏</title><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/17c4eaefaaa50284.css" as="style"/><link rel="stylesheet" href="/_next/static/css/17c4eaefaaa50284.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6fcd3741bb78bb72.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6fcd3741bb78bb72.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-df4cf1c8d23aa877.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-8db7d21a15d54ad1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6d8425e70214bf17.js" defer=""></script><script src="/_next/static/chunks/769-27377d6c7f34e30b.js" defer=""></script><script src="/_next/static/chunks/463-aa1f5d5a9828a9d0.js" defer=""></script><script src="/_next/static/chunks/234-d5dc0e6bdf7bcef4.js" defer=""></script><script src="/_next/static/chunks/pages/manual/uk/%5Bslug%5D-fbcc27f948a2079d.js" defer=""></script><script src="/_next/static/aTdXUbop8S7MnPlMxZSRg/_buildManifest.js" defer=""></script><script src="/_next/static/aTdXUbop8S7MnPlMxZSRg/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><style>
      #nprogress {
        pointer-events: none;
      }
      #nprogress .bar {
        background: #0284c7;
        position: fixed;
        z-index: 9999;
        top: 0;
        left: 0;
        width: 100%;
        height: 3px;
      }
      #nprogress .peg {
        display: block;
        position: absolute;
        right: 0px;
        width: 100px;
        height: 100%;
        box-shadow: 0 0 10px #0284c7, 0 0 5px #0284c7;
        opacity: 1;
        -webkit-transform: rotate(3deg) translate(0px, -4px);
        -ms-transform: rotate(3deg) translate(0px, -4px);
        transform: rotate(3deg) translate(0px, -4px);
      }
      #nprogress .spinner {
        display: block;
        position: fixed;
        z-index: 1031;
        top: 15px;
        right: 15px;
      }
      #nprogress .spinner-icon {
        width: 18px;
        height: 18px;
        box-sizing: border-box;
        border: solid 2px transparent;
        border-top-color: #0284c7;
        border-left-color: #0284c7;
        border-radius: 50%;
        -webkit-animation: nprogresss-spinner 400ms linear infinite;
        animation: nprogress-spinner 400ms linear infinite;
      }
      .nprogress-custom-parent {
        overflow: hidden;
        position: relative;
      }
      .nprogress-custom-parent #nprogress .spinner,
      .nprogress-custom-parent #nprogress .bar {
        position: absolute;
      }
      @-webkit-keyframes nprogress-spinner {
        0% {
          -webkit-transform: rotate(0deg);
        }
        100% {
          -webkit-transform: rotate(360deg);
        }
      }
      @keyframes nprogress-spinner {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="flex flex-col mx-auto flex flex-col items-center justify-center mt-14 mx-auto max-w-3xl xl:max-w-5xl "><nav class="py-3 bg-white/80 backdrop-blur-md shadow-md w-full dark:bg-gray-800 fixed top-0 left-0 right-0 z-20"><div class="flex justify-around md:justify-between mx-auto max-w-3xl xl:max-w-5xl"><div class="flex space-x-10 flex-row"><div class="flex items-center"><a class="cursor-pointer" href="/"><h3 class="text-2xl font-bold font-logo italic">üá∫üá¶ php</h3></a></div><ul class="hidden items-center md:space-x-8 md:justify-start md:flex bg-white dark:bg-gray-800 w-full sm:w-auto flex-column fixed sm:relative sm:p-0 z-20 sm:z-auto top-0 sm:top-auto right-0 sm:right-auto sm:bg-inherit text-right"><li class="sm:hidden items-end p-5 sm:p-0"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="CloseIcon"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></li><li class="items-center border-t sm:border-0 justify-center p-5 sm:p-0"><a href="/manual/uk/index.md">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è</a></li><li class="items-center border-t sm:border-0 justify-center p-5 sm:p-0"><a href="/about">–ü—Ä–æ –ø—Ä–æ—î–∫—Ç</a></li><li class="items-center border-t sm:border-0 justify-center p-5 sm:p-0"><a href="/php-the-right-way">PHP: –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —à–ª—è—Ö</a></li><li class="items-center border-t sm:border-0 justify-center p-5 sm:p-0"><div class=" relative inline-block text-right dropdown"><span class="rounded-md shadow-sm"><button class="inline-flex justify-center w-full px-4 py-2 text-sm font-medium leading-5 text-gray-700 transition duration-150 ease-in-out bg-white border border-gray-300 rounded-md hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800" type="button" aria-haspopup="true" aria-expanded="true" aria-controls="headlessui-menu-items-117"><span>PHP 8.3</span><svg class="w-5 h-5 ml-2 -mr-1" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></span><div class="opacity-0 invisible dropdown-menu transition-all duration-300 transform origin-top-right -translate-y-2 scale-95"><div class="absolute right-0 mt-2 origin-top-right bg-white border border-gray-200 divide-y divide-gray-100 rounded-md shadow-lg outline-none" aria-labelledby="headlessui-menu-button-1" id="headlessui-menu-items-117" role="menu"><div class="py-1"><a href="/releases/uk/8.3.md" tabindex="0" class="text-gray-700 w-full flex justify-end px-6 py-2 text-sm leading-5 text-right" role="menuitem">PHP 8.3</a><a href="/releases/uk/8.2.md" tabindex="1" class="text-gray-700 w-full flex justify-end px-6 py-2 text-sm leading-5 text-right" role="menuitem">PHP 8.2</a><a href="/releases/uk/8.1.md" tabindex="2" class="text-gray-700 w-full flex justify-end px-6 py-2 text-sm leading-5 text-right" role="menuitem">PHP 8.1</a></div></div></div></div></li></ul></div><div class="flex justify-end space-x-2 items-center"><div class="pointer-events-auto w-full rounded-lg bg-white dark:bg-gray-600 text-[0.8125rem] leading-5  ring-1 ring-slate-700/10 undefined"><div class="flex items-center py-2.5 px-3.5"><svg class="mr-2 h-5 w-5 stroke-slate-500" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><input type="text" class="outline-none block w-full h-full dark:bg-gray-600" placeholder="–ü–æ—à—É–∫..." value=""/></div></div></div><div class="flex items-center sm:hidden"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></div></div></nav></div><div class="min-h-screen mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><main><div class="container mx-auto p-5 bg-[url(&#x27;/hero-bg.svg&#x27;)]"><div class="text-right"><a href="event.resources.md" class="mx-4">¬´ –¢–∏–ø–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤</a><a href="event.flags.md" class="mx-4">–ü—Ä–∞–ø–æ—Ä–∏ –ø–æ–¥—ñ–π ¬ª</a><a href="index.md" class="mx-4">PHP Manual</a><a href="book.event.md" class="mx-4">Event</a></div><article class="markdown_markdown__yfc8y"><div><h1>–ü—Ä–∏–∫–ª–∞–¥–∏</h1>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #1 –ü—Ä–æ—Å—Ç–∏–π –∫–ª—ñ—î–Ω—Ç HTTP</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:1296px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p>–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:</p>
<pre><code class="hljs language-typescript">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.
<span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">301</span> <span class="hljs-title class_">Moved</span> <span class="hljs-title class_">Permanently</span>
<span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Fri</span>, <span class="hljs-number">01</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">2013</span> <span class="hljs-number">18</span>:<span class="hljs-number">47</span>:<span class="hljs-number">48</span> <span class="hljs-variable constant_">GMT</span>
<span class="hljs-title class_">Location</span>: <span class="hljs-attr">http</span>:<span class="hljs-comment">//www.google.co.uk/</span>
<span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: text/html; charset=<span class="hljs-variable constant_">UTF</span>-<span class="hljs-number">8</span>
<span class="hljs-title class_">Cache</span>-<span class="hljs-title class_">Control</span>: <span class="hljs-keyword">public</span>, max-age=<span class="hljs-number">2592000</span>
<span class="hljs-title class_">Server</span>: gws
<span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Length</span>: <span class="hljs-number">221</span>
X-<span class="hljs-variable constant_">XSS</span>-<span class="hljs-title class_">Protection</span>: <span class="hljs-number">1</span>; mode=block
X-<span class="hljs-title class_">Frame</span>-<span class="hljs-title class_">Options</span>: <span class="hljs-variable constant_">SAMEORIGIN</span>
<span class="hljs-title class_">Age</span>: <span class="hljs-number">133438</span>
<span class="hljs-title class_">Expires</span>: <span class="hljs-title class_">Sat</span>, <span class="hljs-number">30</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">2013</span> <span class="hljs-number">05</span>:<span class="hljs-number">39</span>:<span class="hljs-number">28</span> <span class="hljs-variable constant_">GMT</span>
<span class="hljs-title class_">Connection</span>: close

&lt;<span class="hljs-variable constant_">HTML</span>&gt;<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">HEAD</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;content-type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">TITLE</span>&gt;</span>301 Moved<span class="hljs-tag">&lt;/<span class="hljs-name">TITLE</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">HEAD</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">BODY</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">H1</span>&gt;</span>301 Moved<span class="hljs-tag">&lt;/<span class="hljs-name">H1</span>&gt;</span>
The document has moved
<span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">HREF</span>=<span class="hljs-string">&quot;http://www.google.co.uk/&quot;</span>&gt;</span>here<span class="hljs-tag">&lt;/<span class="hljs-name">A</span>&gt;</span>.
<span class="hljs-tag">&lt;/<span class="hljs-name">BODY</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">HTML</span>&gt;</span></span>
–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
–ì–æ—Ç–æ–≤–æ
</code></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #2 HTTP –∫–ª—ñ—î–Ω—Ç —ñ–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º –¥–æ DNS</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:1224px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #3 –ï—Ö–æ-—Å–µ—Ä–≤–µ—Ä</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:2574px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #4 SSL –ª—É–Ω–∞-—Å–µ—Ä–≤–µ—Ä</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:2610px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #5 –û–±—Ä–æ–±–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª—ñ–≤</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:738px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #6 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ libevent –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–¥—É–ª—è`eio&#x27;</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:774px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #7 –†—ñ–∑–Ω–µ</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:936px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #8 –ü—Ä–æ—Å—Ç–∏–π HTTP-—Å–µ—Ä–≤–µ—Ä</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:2052px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p>–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:</p>
<pre><code class="hljs language-makefile">a=12
HTTP/1.0 200 OK
<span class="hljs-section">Content-Type: text/html; charset=ISO-8859-1</span>
<span class="hljs-section">Connection: close</span>

HTTP/1.0 200 OK
<span class="hljs-section">Content-Type: text/html; charset=ISO-8859-1</span>
<span class="hljs-section">Connection: close</span>
(–∂–º—ë–º Enter)

HTTP/1.0 200 OK
<span class="hljs-section">Content-Type: text/html; charset=ISO-8859-1</span>
<span class="hljs-section">Connection: close</span>
</code></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #9 –ü—Ä–æ—Å—Ç–∏–π —Å–µ—Ä–≤–µ—Ä HTTPS</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:1710px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #10 OpenSSL –∑&#x27;—î–¥–Ω–∞–Ω–Ω—è</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:1422px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #11 –ü—Ä–∏–∫–ª–∞–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è<a href="eventhttpconnection.makerequest.md">EventHttpConnection::makeRequest()</a></strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:738px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p>–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:</p>
<pre><code class="hljs language-yaml"><span class="hljs-string">_request_handler</span>
<span class="hljs-attr">Success:</span> <span class="hljs-number">200</span>
<span class="hljs-attr">Body:</span>
<span class="hljs-string">PHP,</span> <span class="hljs-attr">date:</span>
<span class="hljs-number">2013-03-13T20:27:52+05:00</span>
</code></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #12 –°–ª—É—Ö–∞—á –∑&#x27;—î–¥–Ω–∞–Ω—å –Ω–∞ –±–∞–∑—ñ —Å–æ–∫–µ—Ç—ñ–≤ UNIX</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:2178px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre>
<p><strong>–ü—Ä–∏–∫–ª–∞–¥ #13 –ü—Ä–æ—Å—Ç–∏–π SMTP-—Å–µ—Ä–≤–µ—Ä</strong></p>
<pre><div class="flex flex-col w-full relative"><section style="display:flex;position:relative;text-align:initial;width:100%;height:2574px" class="rounded-lg overflow-hidden"><div style="display:flex;height:100%;width:100%;justify-content:center;align-items:center">Loading...</div><div style="width:100%;display:none" class="rounded-lg"></div></section><div class="self-end z-10 absolute bottom-0 right-0"><button class="mb-6 lg:mb-0 p-2 sm:px-12 lg:px-8 bg-sky-800 hover:bg-sky-900 font-bold border-sky-800 text-white rounded-tl-lg rounded-br-lg">‚ñ∂</button></div></div></pre></div></article><ul class="flex flex-col sm:flex-row justify-center sm:justify-end items-center sm:m-5 sm:text-sm text-gray-500 dark:text-gray-400"><li class="w-max-full space-y-5 m-5"><a href="https://github.com/ukrainesoft/php.org.ua-docs/blob/master/md/uk/event.examples.md" class="sm:mx-3 bg-sky-800 hover:bg-white hover:text-sky-800 border border-sky text-white font-bold p-3 sm:px-12 lg:px-8 mb-6 lg:mb-0" target="_blank">–î–∏–≤–∏—Ç–∏—Å—å —Å—Ç–∞—Ç—Ç—é –Ω–∞ GitHub</a></li><li><a href="https://github.com/ukrainesoft/php.org.ua-docs/edit/master/md/uk/event.examples.md" class="mx-3 font-bold hover:underline" target="_blank">–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub</a></li></ul></div></main><footer class="bg-white rounded-tl-lg rounded-tr-lg shadow flex items-center justify-between p-6 dark:bg-gray-800"><div class="text-sm text-gray-500 sm:text-center dark:text-gray-400"><a href="https://php.org.ua" class="hover:underline font-logo italic">php.org.ua</a> <!-- -->¬© <!-- -->2024<!-- --> by <a href="https://lisdev.com" target="_blank">lisdev</a></div><div class="items-center space-x-4"><ul class="flex flex-wrap items-center mb-6 text-sm text-gray-500 sm:mb-0 dark:text-gray-400"><li><a class="mr-4 hover:underline md:mr-6" href="/terms">–ü—Ä–∞–≤–∏–ª–∞ —Ç–∞ —É–º–æ–≤–∏</a></li><li><a class="mr-4 hover:underline md:mr-6" href="/privacy">–ü–æ–ª—ñ—Ç–∏–∫–∞ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ</a></li></ul></div><div class="items-center space-x-4"><a target="_blank" href="https://github.com/ukrainesoft/php.org.ua-docs"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium text-sky-500 cursor-pointer css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></a><a target="_blank" href="https://t.me/php_org_ua"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium text-sky-500 cursor-pointer css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="TelegramIcon"><path d="M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"></path></svg></a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"slug":"event.examples.md","content":"# –ü—Ä–∏–∫–ª–∞–¥–∏\n\n**–ü—Ä–∏–∫–ª–∞–¥ #1 –ü—Ä–æ—Å—Ç–∏–π –∫–ª—ñ—î–Ω—Ç HTTP**\n\n```php\n\u003c?php\n// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á—Ç–µ–Ω–∏—è\nfunction readcb($bev, $base) {\n    //$input = $bev-\u003einput; //$bev-\u003egetInput();\n\n    //$pos = $input-\u003esearch(\"TTP\");\n    $pos = $bev-\u003einput-\u003esearch(\"TTP\");\n\n    while (($n = $bev-\u003einput-\u003eremove($buf, 1024)) \u003e 0) {\n        echo $buf;\n    }\n}\n\n// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è\nfunction eventcb($bev, $events, $base) {\n    if ($events \u0026 EventBufferEvent::CONNECTED) {\n        echo \"–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.\\n\";\n    } elseif ($events \u0026 (EventBufferEvent::ERROR | EventBufferEvent::EOF)) {\n        if ($events \u0026 EventBufferEvent::ERROR) {\n            echo \"–û—à–∏–±–∫–∞ DNS: \", $bev-\u003egetDnsErrorString(), PHP_EOL;\n        }\n\n        echo \"–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\\n\";\n        $base-\u003eexit();\n        exit(\"–ì–æ—Ç–æ–≤–æ\\n\");\n    }\n}\n\nif ($argc != 3) {\n    echo \u003c\u003c\u003cEOS\nTrivial HTTP 0.x client\nSyntax: php {$argv[0]} [hostname] [resource]\nExample: php {$argv[0]} www.google.com /\n\nEOS;\n    exit();\n}\n\n$base = new EventBase();\n\n$dns_base = new EventDnsBase($base, TRUE); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ DNS\nif (!$dns_base) {\n    exit(\"Failed to init DNS Base\\n\");\n}\n\n$bev = new EventBufferEvent($base, /* –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–æ–∫–µ—Ç */ NULL,\n    EventBufferEvent::OPT_CLOSE_ON_FREE | EventBufferEvent::OPT_DEFER_CALLBACKS,\n    \"readcb\", /* writecb */ NULL, \"eventcb\"\n);\nif (!$bev) {\n    exit(\"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–∫–µ—Ç–∞ bufferevent\\n\");\n}\n\n//$bev-\u003esetCallbacks(\"readcb\", /* writecb */ NULL, \"eventcb\", $base);\n$bev-\u003eenable(Event::READ | Event::WRITE);\n\n$output = $bev-\u003eoutput; //$bev-\u003egetOutput();\nif (!$output-\u003eadd(\n    \"GET {$argv[2]} HTTP/1.0\\r\\n\".\n    \"Host: {$argv[1]}\\r\\n\".\n    \"Connection: Close\\r\\n\\r\\n\"\n)) {\n    exit(\"–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤ –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞\\n\");\n}\n\nif (!$bev-\u003econnectHost($dns_base, $argv[1], 80, EventUtil::AF_UNSPEC)) {\n    exit(\"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å {$argv[1]}\\n\");\n}\n\n$base-\u003edispatch();\n?\u003e\n```\n\n–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:\n\n```\n–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.\nHTTP/1.1 301 Moved Permanently\nDate: Fri, 01 Mar 2013 18:47:48 GMT\nLocation: http://www.google.co.uk/\nContent-Type: text/html; charset=UTF-8\nCache-Control: public, max-age=2592000\nServer: gws\nContent-Length: 221\nX-XSS-Protection: 1; mode=block\nX-Frame-Options: SAMEORIGIN\nAge: 133438\nExpires: Sat, 30 Mar 2013 05:39:28 GMT\nConnection: close\n\n\u003cHTML\u003e\u003cHEAD\u003e\u003cmeta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"\u003e\n\u003cTITLE\u003e301 Moved\u003c/TITLE\u003e\u003c/HEAD\u003e\u003cBODY\u003e\n\u003cH1\u003e301 Moved\u003c/H1\u003e\nThe document has moved\n\u003cA HREF=\"http://www.google.co.uk/\"\u003ehere\u003c/A\u003e.\n\u003c/BODY\u003e\u003c/HTML\u003e\n–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n–ì–æ—Ç–æ–≤–æ\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #2 HTTP –∫–ª—ñ—î–Ω—Ç —ñ–∑ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–º –∑–∞–ø–∏—Ç–æ–º –¥–æ DNS**\n\n```php\n\u003c?php\n/*\n * 1. –°–æ–µ–¥–∏–Ω—è–µ–º—Å—è —Å 127.0.0.1 –Ω–∞ –ø–æ—Ä—Ç—É 80\n * –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º EventBufferEvent::connect().\n *\n * 2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º /index.cphp –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É HTTP/1.0\n * –∏—Å–ø–æ–ª—å–∑—É—è –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞.\n *\n * 3. –ê—Å–∏–Ω—Ö–æ—Ä–Ω–Ω–æ —á–∏—Ç–∞–µ–º –æ—Ç–≤–µ—Ç –∏ –≤—ã–≤–æ–¥–∏–º –µ–≥–æ –≤ stdout.\n */\n\n// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —á—Ç–µ–Ω–∏—è\nfunction readcb($bev, $base) {\n    $input = $bev-\u003egetInput();\n\n    while (($n = $input-\u003eremove($buf, 1024)) \u003e 0) {\n        echo $buf;\n    }\n}\n\n// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è\nfunction eventcb($bev, $events, $base) {\n    if ($events \u0026 EventBufferEvent::CONNECTED) {\n        echo \"–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.\\n\";\n    } elseif ($events \u0026 (EventBufferEvent::ERROR | EventBufferEvent::EOF)) {\n        if ($events \u0026 EventBufferEvent::ERROR) {\n            echo \"–û—à–∏–±–∫–∞ DNS: \", $bev-\u003egetDnsErrorString(), PHP_EOL;\n        }\n\n        echo \"–ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\\n\";\n        $base-\u003eexit();\n        exit(\"–ì–æ—Ç–æ–≤–æ\\n\");\n    }\n}\n\n$base = new EventBase();\n\necho \"step 1\\n\";\n$bev = new EventBufferEvent($base, /* –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–æ–∫–µ—Ç*/ NULL,\n    EventBufferEvent::OPT_CLOSE_ON_FREE | EventBufferEvent::OPT_DEFER_CALLBACKS);\nif (!$bev) {\n    exit(\"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–∫–µ—Ç–∞ bufferevent\\n\");\n}\n\necho \"step 2\\n\";\n$bev-\u003esetCallbacks(\"readcb\", /* writecb */ NULL, \"eventcb\", $base);\n$bev-\u003eenable(Event::READ | Event::WRITE);\n\necho \"step 3\\n\";\n// –ü–æ—Å—ã–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å\n$output = $bev-\u003egetOutput();\nif (!$output-\u003eadd(\n    \"GET /index.cphp HTTP/1.0\\r\\n\".\n    \"Connection: Close\\r\\n\\r\\n\"\n)) {\n    exit(\"–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤ –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞\\n\");\n}\n\n/* –°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–æ–µ–¥–∏–Ω—è–µ–º—Å—è —Å —Ö–æ—Å—Ç–æ–º.\n–ú—ã –∑–Ω–∞–µ–º IP –∏ –Ω–µ –Ω—É–∂–¥–∞–µ–º—Å—è –≤ –∑–∞–ø—Ä–æ—Å–µ –∫ DNS. */\nif (!$bev-\u003econnect(\"127.0.0.1:80\")) {\n    exit(\"–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\\n\");\n}\n\n// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ–∂–∏–¥–∞—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è\n$base-\u003edispatch();\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #3 –ï—Ö–æ-—Å–µ—Ä–≤–µ—Ä**\n\n```php\n\u003c?php\n/*\n * –ü—Ä–æ—Å—Ç–æ–π —ç—Ö–æ-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –±–∞–∑–µ —Å–ª—É—à–∞—Ç–µ–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π libevent\n *\n * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:\n * 1) –í –ø–µ—Ä–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º:\n *\n * $ php listener.php 9881\n *\n * 2) –í–æ –≤—Ç–æ—Ä–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:\n *\n * $ nc 127.0.0.1 9881\n *\n * 3) –ù–∞—á–∏–Ω–∞–µ–º –ø–µ—á–∞—Ç–∞—Ç—å. –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä—è—Ç—å –Ω–∞—à –≤–≤–æ–¥.\n */\n\nclass MyListenerConnection {\n    private $bev, $base;\n\n    public function __destruct() {\n        $this-\u003ebev-\u003efree();\n    }\n\n    public function __construct($base, $fd) {\n        $this-\u003ebase = $base;\n\n        $this-\u003ebev = new EventBufferEvent($base, $fd, EventBufferEvent::OPT_CLOSE_ON_FREE);\n\n        $this-\u003ebev-\u003esetCallbacks(array($this, \"echoReadCallback\"), NULL,\n            array($this, \"echoEventCallback\"), NULL);\n\n        if (!$this-\u003ebev-\u003eenable(Event::READ)) {\n            echo \"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑—Ä–µ—à–∏—Ç—å —á—Ç–µ–Ω–∏–µ (READ)\\n\";\n            return;\n        }\n    }\n\n    public function echoReadCallback($bev, $ctx) {\n        // –ö–æ–ø–∏—Ä—É–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±—É—Ñ–µ—Ä–∞ –≤–≤–æ–¥–∞ –≤ –±—É—Ñ–µ—Ä –≤—ã–≤–æ–¥–∞\n\n        // –í–∞—Ä–∏–∞–Ω—Ç #1\n        $bev-\u003eoutput-\u003eaddBuffer($bev-\u003einput);\n\n        /* –í–∞—Ä–∏–∞–Ω—Ç #2 */\n        /*\n        $input    = $bev-\u003egetInput();\n        $output = $bev-\u003egetOutput();\n        $output-\u003eaddBuffer($input);\n        */\n    }\n\n    public function echoEventCallback($bev, $events, $ctx) {\n        if ($events \u0026 EventBufferEvent::ERROR) {\n            echo \"–û—à–∏–±–∫–∞ bufferevent\\n\";\n        }\n\n        if ($events \u0026 (EventBufferEvent::EOF | EventBufferEvent::ERROR)) {\n            //$bev-\u003efree();\n            $this-\u003e__destruct();\n        }\n    }\n}\n\nclass MyListener {\n    public $base,\n        $listener,\n        $socket;\n    private $conn = array();\n\n    public function __destruct() {\n        foreach ($this-\u003econn as \u0026$c) $c = NULL;\n    }\n\n    public function __construct($port) {\n        $this-\u003ebase = new EventBase();\n        if (!$this-\u003ebase) {\n            echo \"–ù–µ —É–¥–∞—ë—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å EventBase\";\n            exit(1);\n        }\n\n        // –í–∞—Ä–∏–∞–Ω—Ç #1\n        /*\n        $this-\u003esocket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);\n        if (!socket_bind($this-\u003esocket, '0.0.0.0', $port)) {\n            echo \"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å–æ–∫–µ—Ç\\n\";\n            exit(1);\n        }\n        $this-\u003elistener = new EventListener($this-\u003ebase,\n            array($this, \"acceptConnCallback\"), $this-\u003ebase,\n            EventListener::OPT_CLOSE_ON_FREE | EventListener::OPT_REUSEABLE,\n            -1, $this-\u003esocket);\n         */\n\n        // –í–∞—Ä–∏–∞–Ω—Ç #2\n         $this-\u003elistener = new EventListener($this-\u003ebase,\n             array($this, \"acceptConnCallback\"), $this-\u003ebase,\n             EventListener::OPT_CLOSE_ON_FREE | EventListener::OPT_REUSEABLE, -1,\n             \"0.0.0.0:$port\");\n\n        if (!$this-\u003elistener) {\n            echo \"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª—É—à–∞—Ç–µ–ª—è\";\n            exit(1);\n        }\n\n        $this-\u003elistener-\u003esetErrorCallback(array($this, \"accept_error_cb\"));\n    }\n\n    public function dispatch() {\n        $this-\u003ebase-\u003edispatch();\n    }\n\n    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –µ—Å–ª–∏ –≤ $bev –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è\n    public function acceptConnCallback($listener, $fd, $address, $ctx) {\n        // –£ –Ω–∞—Å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ! –ù–∞—Å—Ç—Ä–æ–∏–º bufferevent –¥–ª—è –Ω–µ–≥–æ. */\n        $base = $this-\u003ebase;\n        $this-\u003econn[] = new MyListenerConnection($base, $fd);\n    }\n\n    public function accept_error_cb($listener, $ctx) {\n        $base = $this-\u003ebase;\n\n        fprintf(STDERR, \"–û—à–∏–±–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª—è: %d (%s). \"\n            .\"–ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞.\\n\",\n            EventUtil::getLastSocketErrno(),\n            EventUtil::getLastSocketError());\n\n        $base-\u003eexit(NULL);\n    }\n}\n\n$port = 9808;\n\nif ($argc \u003e 1) {\n    $port = (int) $argv[1];\n}\nif ($port \u003c= 0 || $port \u003e 65535) {\n    exit(\"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—Ç\");\n}\n\n$l = new MyListener($port);\n$l-\u003edispatch();\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #4 SSL –ª—É–Ω–∞-—Å–µ—Ä–≤–µ—Ä**\n\n```php\n\u003c?php\n/*\n * SSL —ç—Ö–æ-—Å–µ—Ä–≤–µ—Ä\n *\n * –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:\n * 1) –ó–∞–ø—É—Å—Ç–∏—Ç–µ:\n * $ php examples/ssl-echo-server/server.php 9998\n *\n * 2) –í –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ:\n * $ socat - SSL:127.0.0.1:9998,verify=1,cafile=examples/ssl-echo-server/cert.pem\n */\n\nclass MySslEchoServer {\n    public $port,\n        $base,\n        $bev,\n        $listener,\n        $ctx;\n\n    function __construct ($port, $host = \"127.0.0.1\") {\n        $this-\u003eport = $port;\n        $this-\u003ectx = $this-\u003einit_ssl();\n        if (!$this-\u003ectx) {\n            exit(\"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç SSL\\n\");\n        }\n\n        $this-\u003ebase = new EventBase();\n        if (!$this-\u003ebase) {\n            exit(\"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å EventBase\\n\");\n        }\n\n        $this-\u003elistener = new EventListener($this-\u003ebase,\n            array($this, \"ssl_accept_cb\"), $this-\u003ectx,\n            EventListener::OPT_CLOSE_ON_FREE | EventListener::OPT_REUSEABLE,\n            -1, \"$host:$port\");\n        if (!$this-\u003elistener) {\n            exit(\"–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª—É—à–∞—Ç–µ–ª—è\\n\");\n        }\n\n        $this-\u003elistener-\u003esetErrorCallback(array($this, \"accept_error_cb\"));\n    }\n    function dispatch() {\n        $this-\u003ebase-\u003edispatch();\n    }\n\n    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –µ—Å–ª–∏ –≤ $bev –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è\n    function ssl_read_cb($bev, $ctx) {\n        $in = $bev-\u003einput; //$bev-\u003egetInput();\n\n        printf(\"Received %zu bytes\\n\", $in-\u003elength);\n        printf(\"----- data ----\\n\");\n        printf(\"%ld:\\t%s\\n\", (int) $in-\u003elength, $in-\u003epullup(-1));\n\n        $bev-\u003ewriteBuffer($in);\n    }\n\n    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –µ—Å–ª–∏ –Ω–∞ —Å–ª—É—à–∞—Ç–µ–ª—è –ø—Ä–∏–¥—ë—Ç —Å–æ–±—ã—Ç–∏–µ,\n    // –Ω–∞–ü—Ä–∏–∫–ª–∞–¥ –µ—Å–ª–∏ –∑–∞–∫—Ä–æ–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–ª–∏ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –æ—à–∏–±–∫–∞\n    function ssl_event_cb($bev, $events, $ctx) {\n        if ($events \u0026 EventBufferEvent::ERROR) {\n            // –ò–∑–≤–ª–µ–∫–∞–µ–º –æ—à–∏–±–∫—É –∏–∑ —Å—Ç–µ–∫–∞ –æ—à–∏–±–æ–∫ SSL\n            while ($err = $bev-\u003esslError()) {\n                fprintf(STDERR, \"–û—à–∏–±–∫–∞ bufferevent: %s.\\n\", $err);\n            }\n        }\n\n        if ($events \u0026 (EventBufferEvent::EOF | EventBufferEvent::ERROR)) {\n            $bev-\u003efree();\n        }\n    }\n\n    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏–º–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n    function ssl_accept_cb($listener, $fd, $address, $ctx) {\n        // –£ –Ω–∞—Å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ! –ù–∞—Å—Ç—Ä–æ–∏–º bufferevent –¥–ª—è –Ω–µ–≥–æ.\n        $this-\u003ebev = EventBufferEvent::sslSocket($this-\u003ebase, $fd, $this-\u003ectx,\n            EventBufferEvent::SSL_ACCEPTING, EventBufferEvent::OPT_CLOSE_ON_FREE);\n\n        if (!$this-\u003ebev) {\n            echo \"Failed creating ssl buffer\\n\";\n            $this-\u003ebase-\u003eexit(NULL);\n            exit(1);\n        }\n\n        $this-\u003ebev-\u003eenable(Event::READ);\n        $this-\u003ebev-\u003esetCallbacks(array($this, \"ssl_read_cb\"), NULL,\n            array($this, \"ssl_event_cb\"), NULL);\n    }\n\n    // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞, –µ—Å–ª–∏ –Ω–µ —É–¥–∞—Å—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n    function accept_error_cb($listener, $ctx) {\n        fprintf(STDERR, \"–û—à–∏–±–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª—è: %d (%s). \"\n            .\"Shutting down.\\n\",\n            EventUtil::getLastSocketErrno(),\n            EventUtil::getLastSocketError());\n\n        $this-\u003ebase-\u003eexit(NULL);\n    }\n\n    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã SSL, —Å–æ–∑–¥–∞—ë–º EventSslContext\n    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞—ë–º —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç\n    function init_ssl() {\n        // –ù–∞–º *–Ω–µ–æ–±—Ö–æ–¥–∏–º–∞* —ç–Ω—Ç—Ä–æ–ø–∏—è. –ò–Ω–∞—á–µ –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –Ω–µ—Ç —Å–º—ã—Å–ª–∞.\n        if (!EventUtil::sslRandPoll()) {\n            exit(\"EventUtil::sslRandPoll failed\\n\");\n        }\n\n        $local_cert = __DIR__.\"/cert.pem\";\n        $local_pk   = __DIR__.\"/privkey.pem\";\n\n        if (!file_exists($local_cert) || !file_exists($local_pk)) {\n            echo \"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å $local_cert –∏–ª–∏ $local_pk file.  –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞\\n\",\n                \"–∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ:\\n\",\n                \"  openssl genrsa -out $local_pk 2048\\n\",\n                \"  openssl req -new -key $local_pk -out cert.req\\n\",\n                \"  openssl x509 -req -days 365 -in cert.req -signkey $local_pk -out $local_cert\\n\";\n\n            return FALSE;\n        }\n\n        $ctx = new EventSslContext(EventSslContext::SSLv3_SERVER_METHOD, array (\n             EventSslContext::OPT_LOCAL_CERT  =\u003e $local_cert,\n             EventSslContext::OPT_LOCAL_PK    =\u003e $local_pk,\n             //EventSslContext::OPT_PASSPHRASE  =\u003e \"echo server\",\n             EventSslContext::OPT_VERIFY_PEER =\u003e true,\n             EventSslContext::OPT_ALLOW_SELF_SIGNED =\u003e false,\n        ));\n\n        return $ctx;\n    }\n}\n\n// –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞\n$port = 9999;\nif ($argc \u003e 1) {\n    $port = (int) $argv[1];\n}\nif ($port \u003c= 0 || $port \u003e 65535) {\n    exit(\"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—Ç\\n\");\n}\n\n\n$l = new MySslEchoServer($port);\n$l-\u003edispatch();\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #5 –û–±—Ä–æ–±–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª—ñ–≤**\n\n```php\n\u003c?php\n/*\n–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ:\n\n$ php examples/signal.php\n\n–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –Ω–∞–π–¥–∏—Ç–µ pid —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –ø–æ—à–ª–∏—Ç–µ –µ–º—É —Å–∏–≥–Ω–∞–ª SIGTERM:\n\n$ ps aux | grep examp\nruslan    3976  0.2  0.0 139896 11256 pts/1    S+   10:25   0:00 php examples/signal.php\nruslan    3978  0.0  0.0   9572   864 pts/2    S+   10:26   0:00 grep --color=auto examp\n$ kill -TERM 3976\n\n–í –ø–µ—Ä–≤–æ–º –æ–∫–Ω–µ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ::\n\n–ü–æ–π–º–∞–Ω —Å–∏–≥–Ω–∞–ª 15\n*/\n\nclass MyEventSignal {\n    private $base;\n\n    function __construct($base) {\n        $this-\u003ebase = $base;\n    }\n\n    function eventSighandler($no, $c) {\n        echo \"–ü–æ–π–º–∞–Ω —Å–∏–≥–Ω–∞–ª $no\\n\";\n        event_base_loopexit($c-\u003ebase);\n    }\n}\n\n$base = event_base_new();\n$c    = new MyEventSignal($base);\n$no   = SIGTERM;\n$ev   = evsignal_new($base, $no, array($c,'eventSighandler'), $c);\n\nevsignal_add($ev);\n\nevent_base_loop($base);\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #6 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–∞ libevent –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–¥—É–ª—è\\`eio'**\n\n```php\n\u003c?php\n// –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –¥–ª—è eio_nop()\nfunction my_nop_cb($d, $r) {\n    echo \"step 6\\n\";\n}\n\n$dir = \"/tmp/abc-eio-temp\";\nif (file_exists($dir)) {\n    rmdir($dir);\n}\n\necho \"step 1\\n\";\n\n$base = new EventBase();\n\necho \"step 2\\n\";\n\neio_init();\n\neio_mkdir($dir, 0750, EIO_PRI_DEFAULT, \"my_nop_cb\");\n\n$event = new Event($base, eio_get_event_stream(),\n    Event::READ | Event::PERSIST, function ($fd, $events, $base) {\n    echo \"step 5\\n\";\n\n    while (eio_nreqs()) {\n        eio_poll();\n    }\n\n    $base-\u003estop();\n}, $base);\n\necho \"step 3\\n\";\n\n$event-\u003eadd();\n\necho \"step 4\\n\";\n\n$base-\u003edispatch();\n\necho \"–ì–æ—Ç–æ–≤–æ\\n\";\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #7 –†—ñ–∑–Ω–µ**\n\n```php\n\u003c?php\n/* {{{ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã */\necho \"–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç–æ–¥—ã:\\n\";\nforeach (Event::getSupportedMethods() as $m) {\n    echo $m, PHP_EOL;\n}\n\n// –ò–∑–±–µ–≥–∞–µ–º –º–µ—Ç–æ–¥–∞ \"select\"\n$cfg = new EventConfig();\nif ($cfg-\u003eavoidMethod(\"select\")) {\n    echo \"–ú–µ—Ç–æ–¥ 'select' –±—É–¥–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è\\n\";\n}\n\n// –°–æ–∑–¥–∞—ë–º event_base —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π\n$base = new EventBase($cfg);\necho \"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–π–Ω—ã–π –º–µ—Ç–æ–¥: \", $base-\u003egetMethod(), PHP_EOL;\n\necho \"–°–ø–æ—Å–æ–±—ã:\\n\";\n$features = $base-\u003egetFeatures();\n($features \u0026 EventConfig::FEATURE_ET) and print \"ET ‚Äî¬†–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ (edge-triggered IO)\\n\";\n($features \u0026 EventConfig::FEATURE_O1) and print \"O1 ‚Äî¬†–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π —Å–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é O(1)\\n\";\n($features \u0026 EventConfig::FEATURE_FDS) and print \"FDS ‚Äî¬†–æ–±—ã—á–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —Ñ–∞–π–ª–æ–≤, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ–∫–µ—Ç—ã\\n\";\n\n// –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–ø–æ—Å–æ–± FDS\nif ($cfg-\u003erequireFeatures(EventConfig::FEATURE_FDS)) {\n    echo \"–ó–∞–ø—Ä–æ—à–µ–Ω —Å–ø–æ—Å–æ–± FDS\\n\";\n\n    $base = new EventBase($cfg);\n    ($base-\u003egetFeatures() \u0026 EventConfig::FEATURE_FDS)\n        and print \"FDS ‚Äî¬†–æ–±—ã—á–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —Ñ–∞–π–ª–æ–≤, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ–∫–µ—Ç—ã\\n\";\n}\n/* }}} */\n\n/* {{{ Base */\n$base = new EventBase();\n$event = new Event($base, STDIN, Event::READ | Event::PERSIST, function ($fd, $events, $arg) {\n    static $max_iterations = 0;\n\n    if (++$max_iterations \u003e= 5) {\n        /* –≤—ã—Ö–æ–¥ –ø–æ—Å–ª–µ 5 –∏—Ç–µ—Ä–∞—Ü–∏–π —Å –ø–∞—É–∑–∞–º–∏ –≤ 2.33 —Å–µ–∫—É–Ω–¥—ã */\n        echo \"–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è...\\n\";\n        $arg[0]-\u003eexit(2.33);\n    }\n\n    echo fgets($fd);\n}, array (\u0026$base));\n\n$event-\u003eadd();\n$base-\u003eloop();\n/* Base }}} */\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #8 –ü—Ä–æ—Å—Ç–∏–π HTTP-—Å–µ—Ä–≤–µ—Ä**\n\n```php\n\u003c?php\n/*\n * –ü—Ä–æ—Å—Ç–æ–π HTTP-—Å–µ—Ä–≤–µ—Ä.\n *\n * –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:\n * 1) –ó–∞–ø—É—Å–∫–∞–µ—Ç–µ –Ω–∞ –ª—é–±–æ–º –ø–æ—Ä—Ç—É, –Ω–∞–ü—Ä–∏–∫–ª–∞–¥:\n * $ php examples/http.php 8010\n * 2) –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç–µ –∫ –Ω–µ–º—É —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ\n * –∏ –¥–µ–ª–∞–µ—Ç–µ GET –∏–ª–∏ POST –∑–∞–ø—Ä–æ—Å(–¥—Ä—É–≥–∏–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã):\n * $ nc -t 127.0.0.1 8010\n * POST /about HTTP/1.0\n * Content-Type: text/plain\n * Content-Length: 4\n * Connection: close\n * (–Ω–∞–∂–∏–º–∞–µ—Ç–µ Enter)\n *\n * –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:\n * a=12\n * HTTP/1.0 200 OK\n * Content-Type: text/html; charset=ISO-8859-1\n * Connection: close\n *\n * $ nc -t 127.0.0.1 8010\n * GET /dump HTTP/1.0\n * Content-Type: text/plain\n * Content-Encoding: UTF-8\n * Connection: close\n * (–Ω–∞–∂–∏–º–∞–µ—Ç–µ Enter)\n *\n * I–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:\n * HTTP/1.0 200 OK\n * Content-Type: text/html; charset=ISO-8859-1\n * Connection: close\n * (–Ω–∞–∂–∏–º–∞–µ—Ç–µ Enter)\n *\n * $ nc -t 127.0.0.1 8010\n * GET /unknown HTTP/1.0\n * Connection: close\n *\n * –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:\n * HTTP/1.0 200 OK\n * Content-Type: text/html; charset=ISO-8859-1\n * Connection: close\n *\n * 3) –°–º–æ—Ç—Ä–∏—Ç–µ, —á—Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –æ–∫–Ω–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –≤—ã –∑–∞–ø—É—Å—Ç–∏–ª–∏ —Å–µ—Ä–≤–µ—Ä.\n */\n\nfunction _http_dump($req, $data) {\n    static $counter      = 0;\n    static $max_requests = 2;\n\n    if (++$counter \u003e= $max_requests)  {\n        echo \"–°—á—ë—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ—Å—Ç–∏–≥ –º–∞–∫—Å–∏–º—É–º–∞ $max_requests. –í—ã—Ö–æ–¥–∏–º\\n\";\n        exit();\n    }\n\n    echo __METHOD__, \" –º–µ—Ç–æ–¥\\n\";\n    echo \"–∑–∞–ø—Ä–æ—Å:\"; var_dump($req);\n    echo \"–¥–∞–Ω–Ω—ã–µ:\"; var_dump($data);\n\n    echo \"\\n===== DUMP =====\\n\";\n    echo \"–ö–æ–º–∞–Ω–¥–∞:\", $req-\u003egetCommand(), PHP_EOL;\n    echo \"URI:\", $req-\u003egetUri(), PHP_EOL;\n    echo \"–í—Ö–æ–¥—è—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:\"; var_dump($req-\u003egetInputHeaders());\n    echo \"–ò—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:\"; var_dump($req-\u003egetOutputHeaders());\n\n    echo \"\\n \u003e\u003e –ü–æ—Å—ã–ª–∞–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n\n    echo \"\\n \u003e\u003e –ß–∏—Ç–∞–µ–º –≤—Ö–æ–¥–Ω–æ–π –±—É—Ñ–µ—Ä ...\\n\";\n    $buf = $req-\u003egetInputBuffer();\n    while ($s = $buf-\u003ereadLine(EventBuffer::EOL_ANY)) {\n        echo $s, PHP_EOL;\n    }\n    echo \"–í –±—É—Ñ–µ—Ä–µ –±–æ–ª—å—à–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö\\n\";\n}\n\nfunction _http_about($req) {\n    echo __METHOD__, PHP_EOL;\n    echo \"URI: \", $req-\u003egetUri(), PHP_EOL;\n    echo \"\\n \u003e\u003e –ü–æ—Å—ã–ª–∞–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n}\n\nfunction _http_default($req, $data) {\n    echo __METHOD__, PHP_EOL;\n    echo \"URI: \", $req-\u003egetUri(), PHP_EOL;\n    echo \"\\n \u003e\u003e –ü–æ—Å—ã–ª–∞–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n}\n\n$port = 8010;\nif ($argc \u003e 1) {\n    $port = (int) $argv[1];\n}\nif ($port \u003c= 0 || $port \u003e 65535) {\n    exit(\"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—Ç\");\n}\n\n$base = new EventBase();\n$http = new EventHttp($base);\n$http-\u003esetAllowedMethods(EventHttpRequest::CMD_GET | EventHttpRequest::CMD_POST);\n\n$http-\u003esetCallback(\"/dump\", \"_http_dump\", array(4, 8));\n$http-\u003esetCallback(\"/about\", \"_http_about\");\n$http-\u003esetDefaultCallback(\"_http_default\", \"custom data value\");\n\n$http-\u003ebind(\"0.0.0.0\", 8010);\n$base-\u003eloop();\n?\u003e\n```\n\n–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:\n\n```\na=12\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=ISO-8859-1\nConnection: close\n\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=ISO-8859-1\nConnection: close\n(–∂–º—ë–º Enter)\n\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=ISO-8859-1\nConnection: close\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #9 –ü—Ä–æ—Å—Ç–∏–π —Å–µ—Ä–≤–µ—Ä HTTPS**\n\n```php\n\u003c?php\n/*\n * –ü—Ä–æ—Å—Ç–æ–π HTTPS-—Å–µ—Ä–≤–µ—Ä.\n *\n * 1) –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `php examples/https.php 9999`\n * 2) –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –µ–≥–æ: `php examples/ssl-connection.php 9999`\n */\n\nfunction _http_dump($req, $data) {\n    static $counter      = 0;\n    static $max_requests = 200;\n\n    if (++$counter \u003e= $max_requests)  {\n        echo \"–°—á—ë—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–æ—Å—Ç–∏–≥ –º–∞–∫—Å–∏–º—É–º–∞ $max_requests. –í—ã—Ö–æ–¥–∏–º\\n\";\n        exit();\n    }\n\n    echo __METHOD__, \" called\\n\";\n    echo \"–∑–∞–ø—Ä–æ—Å:\"; var_dump($req);\n    echo \"–¥–∞–Ω–Ω—ã–µ:\"; var_dump($data);\n\n    echo \"\\n===== DUMP =====\\n\";\n    echo \"–ö–æ–º–∞–Ω–¥–∞:\", $req-\u003egetCommand(), PHP_EOL;\n    echo \"URI:\", $req-\u003egetUri(), PHP_EOL;\n    echo \"–í—Ö–æ–¥—è—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:\"; var_dump($req-\u003egetInputHeaders());\n    echo \"–ò—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:\"; var_dump($req-\u003egetOutputHeaders());\n\n    echo \"\\n \u003e\u003e –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n\n    $buf = $req-\u003egetInputBuffer();\n    echo \"\\n \u003e\u003e –ß–∏—Ç–∞–µ–º –≤—Ö–æ–¥—è—â–∏–π –±—É—Ñ–µ—Ä (\", $buf-\u003elength, \") ...\\n\";\n    while ($s = $buf-\u003eread(1024)) {\n        echo $s;\n    }\n    echo \"\\n–í –±—É—Ñ–µ—Ä–µ –±–æ–ª—å—à–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö\\n\";\n}\n\nfunction _http_about($req) {\n    echo __METHOD__, PHP_EOL;\n    echo \"URI: \", $req-\u003egetUri(), PHP_EOL;\n    echo \"\\n \u003e\u003e –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n}\n\nfunction _http_default($req, $data) {\n    echo __METHOD__, PHP_EOL;\n    echo \"URI: \", $req-\u003egetUri(), PHP_EOL;\n    echo \"\\n \u003e\u003e –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç ...\";\n    $req-\u003esendReply(200, \"OK\");\n    echo \"OK\\n\";\n}\n\nfunction _http_400($req) {\n    $req-\u003esendError(400);\n}\n\nfunction _init_ssl() {\n    $local_cert = __DIR__.\"/ssl-echo-server/cert.pem\";\n    $local_pk   = __DIR__.\"/ssl-echo-server/privkey.pem\";\n\n    $ctx = new EventSslContext(EventSslContext::SSLv3_SERVER_METHOD, array (\n        EventSslContext::OPT_LOCAL_CERT  =\u003e $local_cert,\n        EventSslContext::OPT_LOCAL_PK    =\u003e $local_pk,\n        //EventSslContext::OPT_PASSPHRASE  =\u003e \"test\",\n        EventSslContext::OPT_ALLOW_SELF_SIGNED =\u003e true,\n    ));\n\n    return $ctx;\n}\n\n$port = 9999;\nif ($argc \u003e 1) {\n    $port = (int) $argv[1];\n}\nif ($port \u003c= 0 || $port \u003e 65535) {\n    exit(\"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—Ç\");\n}\n$ip = '0.0.0.0';\n\n$base = new EventBase();\n$ctx  = _init_ssl();\n$http = new EventHttp($base, $ctx);\n$http-\u003esetAllowedMethods(EventHttpRequest::CMD_GET | EventHttpRequest::CMD_POST);\n\n$http-\u003esetCallback(\"/dump\", \"_http_dump\", array(4, 8));\n$http-\u003esetCallback(\"/about\", \"_http_about\");\n$http-\u003esetCallback(\"/err400\", \"_http_400\");\n$http-\u003esetDefaultCallback(\"_http_default\", \"custom data value\");\n\n$http-\u003ebind($ip, $port);\n$base-\u003edispatch();\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #10 OpenSSL –∑'—î–¥–Ω–∞–Ω–Ω—è**\n\n```php\n\u003c?php\n/*\n * –ü—Ä–æ—Å—Ç–æ–π OpenSSL –∫–ª–∏–µ–Ω—Ç.\n *\n * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:\n * 1) –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä, –Ω–∞–ü—Ä–∏–∫–ª–∞–¥ —Ç–∞–∫:\n * $ php examples/https.php 9999\n *\n * 2) –ó–∞–ø—É—Å–∫–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ:\n * $ php examples/ssl-connection.php 9999\n */\n\nfunction _request_handler($req, $base) {\n    echo __FUNCTION__, PHP_EOL;\n\n    if (is_null($req)) {\n        echo \"–ü—Ä–µ–≤—ã—à–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–∂–∏–¥–∞–Ω–∏—è\\n\";\n    } else {\n        $response_code = $req-\u003egetResponseCode();\n\n        if ($response_code == 0) {\n            echo \"–í —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –æ—Ç–∫–∞–∑–∞–Ω–æ\\n\";\n        } elseif ($response_code != 200) {\n            echo \"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: $response_code\\n\";\n        } else {\n            echo \"–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ: $response_code\\n\";\n            $buf = $req-\u003egetInputBuffer();\n            echo \"Body:\\n\";\n            while ($s = $buf-\u003ereadLine(EventBuffer::EOL_ANY)) {\n                echo $s, PHP_EOL;\n            }\n        }\n    }\n\n    $base-\u003eexit(NULL);\n}\n\nfunction _init_ssl() {\n    $ctx = new EventSslContext(EventSslContext::SSLv3_CLIENT_METHOD, array ());\n\n    return $ctx;\n}\n\n\n// –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ—Ä—Ç\n$port = 9999;\nif ($argc \u003e 1) {\n    $port = (int) $argv[1];\n}\nif ($port \u003c= 0 || $port \u003e 65535) {\n    exit(\"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—Ç\\n\");\n}\n$host = '127.0.0.1';\n\n$ctx = _init_ssl();\nif (!$ctx) {\n    trigger_error(\"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç SSL\", E_USER_ERROR);\n}\n\n$base = new EventBase();\nif (!$base) {\n    trigger_error(\"–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π\", E_USER_ERROR);\n}\n\n$conn = new EventHttpConnection($base, NULL, $host, $port, $ctx);\n$conn-\u003esetTimeout(50);\n\n$req = new EventHttpRequest(\"_request_handler\", $base);\n$req-\u003eaddHeader(\"Host\", $host, EventHttpRequest::OUTPUT_HEADER);\n$buf = $req-\u003egetOutputBuffer();\n$buf-\u003eadd(\"\u003chtml\u003eHTML TEST\u003c/html\u003e\");\n//$req-\u003eaddHeader(\"Content-Length\", $buf-\u003elength, EventHttpRequest::OUTPUT_HEADER);\n//$req-\u003eaddHeader(\"Connection\", \"close\", EventHttpRequest::OUTPUT_HEADER);\n$conn-\u003emakeRequest($req, EventHttpRequest::CMD_POST, \"/dump\");\n\n$base-\u003edispatch();\necho \"END\\n\";\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #11 –ü—Ä–∏–∫–ª–∞–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è[EventHttpConnection::makeRequest()](eventhttpconnection.makerequest.md)**\n\n```php\n\u003c?php\nfunction _request_handler($req, $base) {\n    echo __FUNCTION__, PHP_EOL;\n\n    if (is_null($req)) {\n        echo \"Timed out\\n\";\n    } else {\n        $response_code = $req-\u003egetResponseCode();\n\n        if ($response_code == 0) {\n            echo \"–í —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –æ—Ç–∫–∞–∑–∞–Ω–æ\\n\";\n        } elseif ($response_code != 200) {\n            echo \"–ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: $response_code\\n\";\n        } else {\n            echo \"–£—Å–ø–µ—à–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: $response_code\\n\";\n            $buf = $req-\u003egetInputBuffer();\n            echo \"–î–∞–Ω–Ω—ã–µ:\\n\";\n            while ($s = $buf-\u003ereadLine(EventBuffer::EOL_ANY)) {\n                echo $s, PHP_EOL;\n            }\n        }\n    }\n\n    $base-\u003eexit(NULL);\n}\n\n$address = \"127.0.0.1\";\n$port = 80;\n\n$base = new EventBase();\n$conn = new EventHttpConnection($base, NULL, $address, $port);\n$conn-\u003esetTimeout(5);\n$req = new EventHttpRequest(\"_request_handler\", $base);\n\n$req-\u003eaddHeader(\"Host\", $address, EventHttpRequest::OUTPUT_HEADER);\n$req-\u003eaddHeader(\"Content-Length\", \"0\", EventHttpRequest::OUTPUT_HEADER);\n$conn-\u003emakeRequest($req, EventHttpRequest::CMD_GET, \"/index.cphp\");\n\n$base-\u003eloop();\n?\u003e\n```\n\n–í–∏—Å–Ω–æ–≤–æ–∫ –Ω–∞–≤–µ–¥–µ–Ω–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É –±—É–¥–µ —Å—Ö–æ–∂–∏–º –Ω–∞:\n\n```\n_request_handler\nSuccess: 200\nBody:\nPHP, date:\n2013-03-13T20:27:52+05:00\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #12 –°–ª—É—Ö–∞—á –∑'—î–¥–Ω–∞–Ω—å –Ω–∞ –±–∞–∑—ñ —Å–æ–∫–µ—Ç—ñ–≤ UNIX**\n\n```php\n\u003c?php\n/*\n * –ü—Ä–æ—Å—Ç–æ–π echo-—Å–µ—Ä–≤–µ—Ä –Ω–∞ –±–∞–∑–µ —Å–ª—É—à–∞—Ç–µ–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π libevent.\n *\n * –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:\n * 1) –í –ø–µ—Ä–≤–æ–º –æ–∫–Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É—à–∞—Ç–µ–ª—å:\n *\n * $ php unix-domain-listener.php [–ø—É—Ç—å –∫ —Å–æ–∫–µ—Ç—É]\n *\n * 2) –í–æ –≤—Ç–æ—Ä–æ–º –æ–∫–Ω–µ –æ—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Å–æ–∫–µ—Ç—É:\n *\n * $ socat - GOPEN:/tmp/1.sock\n *\n * 3) –ù–∞—á–Ω–∏—Ç–µ –ø–µ—á–∞—Ç–∞—Ç—å—é –°–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–µ–Ω –ø–æ–≤—Ç–æ—Ä—è—Ç—å –≤–≤–æ–¥.\n */\n\nclass MyListenerConnection {\n    private $bev, $base;\n\n    public function __destruct() {\n        if ($this-\u003ebev) {\n            $this-\u003ebev-\u003efree();\n        }\n    }\n\n    public function __construct($base, $fd) {\n        $this-\u003ebase = $base;\n\n        $this-\u003ebev = new EventBufferEvent($base, $fd, EventBufferEvent::OPT_CLOSE_ON_FREE);\n\n        $this-\u003ebev-\u003esetCallbacks(array($this, \"echoReadCallback\"), NULL,\n            array($this, \"echoEventCallback\"), NULL);\n\n        if (!$this-\u003ebev-\u003eenable(Event::READ)) {\n            echo \"–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑—Ä–µ—à–∏—Ç—å —á—Ç–µ–Ω–∏–µ (READ)\\n\";\n            return;\n        }\n    }\n\n    public function echoReadCallback($bev, $ctx) {\n        // –ö–æ–ø–∏—Ä—É–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Ö–æ–¥—è—â–µ–≥–æ –±—É—Ñ–µ—Ä–∞ –≤ –∏—Å—Ö–æ–¥—è—â–∏–π –±—É—Ñ–µ—Ä\n        $bev-\u003eoutput-\u003eaddBuffer($bev-\u003einput);\n    }\n\n    public function echoEventCallback($bev, $events, $ctx) {\n        if ($events \u0026 EventBufferEvent::ERROR) {\n            echo \"–û—à–∏–±–∫–∞ –≤ bufferevent\\n\";\n        }\n\n        if ($events \u0026 (EventBufferEvent::EOF | EventBufferEvent::ERROR)) {\n            $bev-\u003efree();\n            $bev = NULL;\n        }\n    }\n}\n\nclass MyListener {\n    public $base,\n        $listener,\n        $socket;\n    private $conn = array();\n\n    public function __destruct() {\n        foreach ($this-\u003econn as \u0026$c) $c = NULL;\n    }\n\n    public function __construct($sock_path) {\n        $this-\u003ebase = new EventBase();\n        if (!$this-\u003ebase) {\n            echo \"–ù–µ —É–¥–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫\";\n            exit(1);\n        }\n\n        if (file_exists($sock_path)) {\n            unlink($sock_path);\n        }\n\n         $this-\u003elistener = new EventListener($this-\u003ebase,\n             array($this, \"acceptConnCallback\"), $this-\u003ebase,\n             EventListener::OPT_CLOSE_ON_FREE | EventListener::OPT_REUSEABLE, -1,\n             \"unix:$sock_path\");\n\n        if (!$this-\u003elistener) {\n            trigger_error(\"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª—É—à–∞—Ç–µ–ª—å\", E_USER_ERROR);\n        }\n\n        $this-\u003elistener-\u003esetErrorCallback(array($this, \"accept_error_cb\"));\n    }\n\n    public function dispatch() {\n        $this-\u003ebase-\u003edispatch();\n    }\n\n    // –≠—Ç–∞ callback-—Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω–∞, –∫–æ–≥–¥–∞ –≤ $bev –ø–æ—è–≤—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è\n    public function acceptConnCallback($listener, $fd, $address, $ctx) {\n        // –ü–æ—è–≤–∏–ª–æ—Å—å –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ! –ù–∞—Å—Ç—Ä–æ–µ–º –¥–ª—è –Ω–µ–≥–æ bufferevent. */\n        $base = $this-\u003ebase;\n        $this-\u003econn[] = new MyListenerConnection($base, $fd);\n    }\n\n    public function accept_error_cb($listener, $ctx) {\n        $base = $this-\u003ebase;\n\n        fprintf(STDERR, \"–û—à–∏–±–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª—è: %d (%s). \"\n            .\"Shutting down.\\n\",\n            EventUtil::getLastSocketErrno(),\n            EventUtil::getLastSocketError());\n\n        $base-\u003eexit(NULL);\n    }\n}\n\nif ($argc \u003c= 1) {\n    exit(\"–ù–µ —É–∫–∞–∑–∞–Ω —Å–æ–∫–µ—Ç\\n\");\n}\n$sock_path = $argv[1];\n\n$l = new MyListener($sock_path);\n$l-\u003edispatch();\n?\u003e\n```\n\n**–ü—Ä–∏–∫–ª–∞–¥ #13 –ü—Ä–æ—Å—Ç–∏–π SMTP-—Å–µ—Ä–≤–µ—Ä**\n\n```php\n\u003c?php\n /*\n * –ê–≤—Ç–æ—Ä: Andrew Rose \u003chello at andrewrose dot co dot uk\u003e\n *\n * Usage:\n * 1) –ü–æ–¥–≥–æ—Ç–æ–≤–∏–º —Ñ–∞–π–ª—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ cert.pem –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ privkey.pem.\n * 2) –ó–∞–ø—É—Å—Ç–∏–º —Å–∫—Ä–∏–ø—Ç —Å–µ—Ä–≤–µ—Ä–∞\n * 3) –û—Ç–∫—Ä–æ–µ–º TLS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –Ω–∞–ü—Ä–∏–∫–ª–∞–¥:\n *      $ openssl s_client -connect localhost:25 -starttls smtp -crlf\n * 4) –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—ã, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –º–µ—Ç–æ–¥–∞ `cmd`.\n */\n\nclass Handler {\n    public $domainName = FALSE;\n    public $connections = [];\n    public $buffers = [];\n    public $maxRead = 256000;\n\n    public function __construct() {\n        $this-\u003ectx = new EventSslContext(EventSslContext::SSLv3_SERVER_METHOD, [\n            EventSslContext::OPT_LOCAL_CERT  =\u003e 'cert.pem',\n            EventSslContext::OPT_LOCAL_PK    =\u003e 'privkey.pem',\n            //EventSslContext::OPT_PASSPHRASE  =\u003e '',\n            EventSslContext::OPT_VERIFY_PEER =\u003e false, // –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —É–∫–∞–∂–∏—Ç–µ true\n            EventSslContext::OPT_ALLOW_SELF_SIGNED =\u003e true // –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —É–∫–∞–∂–∏—Ç–µ false\n        ]);\n\n        $this-\u003ebase = new EventBase();\n        if (!$this-\u003ebase) {\n            exit(\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π\\n\");\n        }\n\n        if (!$this-\u003elistener = new EventListener($this-\u003ebase,\n            [$this, 'ev_accept'],\n            $this-\u003ectx,\n            EventListener::OPT_CLOSE_ON_FREE | EventListener::OPT_REUSEABLE,\n            -1,\n            '0.0.0.0:25'))\n        {\n            exit(\"–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–ª—É—à–∞—Ç–µ–ª—è\\n\");\n        }\n\n        $this-\u003elistener-\u003esetErrorCallback([$this, 'ev_error']);\n        $this-\u003ebase-\u003edispatch();\n    }\n\n    public function ev_accept($listener, $fd, $address, $ctx) {\n        static $id = 0;\n        $id += 1;\n\n        $this-\u003econnections[$id]['clientData'] = '';\n        $this-\u003econnections[$id]['cnx'] = new EventBufferEvent($this-\u003ebase, $fd,\n            EventBufferEvent::OPT_CLOSE_ON_FREE);\n\n        if (!$this-\u003econnections[$id]['cnx']) {\n            echo \"Failed creating buffer\\n\";\n            $this-\u003ebase-\u003eexit(NULL);\n            exit(1);\n        }\n\n        $this-\u003econnections[$id]['cnx']-\u003esetCallbacks([$this, \"ev_read\"], NULL,\n            [$this, 'ev_error'], $id);\n        $this-\u003econnections[$id]['cnx']-\u003eenable(Event::READ | Event::WRITE);\n\n        $this-\u003eev_write($id, '220 '.$this-\u003edomainName.\" wazzzap?\\r\\n\");\n    }\n\n    function ev_error($listener, $ctx) {\n        $errno = EventUtil::getLastSocketErrno();\n\n        fprintf(STDERR, \"–û—à–∏–±–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª—è: %d (%s). –ê–≤–∞—Ä–∏–π–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã.\\n\",\n            $errno, EventUtil::getLastSocketError());\n\n        if ($errno != 0) {\n            $this-\u003ebase-\u003eexit(NULL);\n            exit();\n        }\n    }\n\n    public function ev_close($id) {\n        $this-\u003econnections[$id]['cnx']-\u003edisable(Event::READ | Event::WRITE);\n        unset($this-\u003econnections[$id]);\n    }\n\n    protected function ev_write($id, $string) {\n        echo 'S('.$id.'): '.$string;\n        $this-\u003econnections[$id]['cnx']-\u003ewrite($string);\n    }\n\n    public function ev_read($buffer, $id) {\n        while($buffer-\u003einput-\u003elength \u003e 0) {\n            $this-\u003econnections[$id]['clientData'] .= $buffer-\u003einput-\u003eread($this-\u003emaxRead);\n            $clientDataLen = strlen($this-\u003econnections[$id]['clientData']);\n\n            if($this-\u003econnections[$id]['clientData'][$clientDataLen-1] == \"\\n\"\n                \u0026\u0026 $this-\u003econnections[$id]['clientData'][$clientDataLen-2] == \"\\r\")\n            {\n                // —É–¥–∞–ª—è–µ–º –≤—Å–µ –∑–∞–≤–µ—Ä—à–∞—é—â–∏–µ \\r\\n\n                $line = substr($this-\u003econnections[$id]['clientData'], 0,\n                    strlen($this-\u003econnections[$id]['clientData']) - 2);\n\n                $this-\u003econnections[$id]['clientData'] = '';\n                $this-\u003ecmd($buffer, $id, $line);\n            }\n        }\n    }\n\n    protected function cmd($buffer, $id, $line) {\n        switch ($line) {\n            case strncmp('EHLO ', $line, 4):\n                $this-\u003eev_write($id, \"250-STARTTLS\\r\\n\");\n                $this-\u003eev_write($id, \"250 OK ehlo\\r\\n\");\n                break;\n\n            case strncmp('HELO ', $line, 4):\n                $this-\u003eev_write($id, \"250-STARTTLS\\r\\n\");\n                $this-\u003eev_write($id, \"250 OK helo\\r\\n\");\n                break;\n\n            case strncmp('QUIT', $line, 3):\n                $this-\u003eev_write($id, \"250 OK quit\\r\\n\");\n                $this-\u003eev_close($id);\n                break;\n\n            case strncmp('STARTTLS', $line, 3):\n                $this-\u003eev_write($id, \"220 Ready to start TLS\\r\\n\");\n                $this-\u003econnections[$id]['cnx'] = EventBufferEvent::sslFilter($this-\u003ebase,\n                    $this-\u003econnections[$id]['cnx'], $this-\u003ectx,\n                    EventBufferEvent::SSL_ACCEPTING,\n                    EventBufferEvent::OPT_CLOSE_ON_FREE);\n                $this-\u003econnections[$id]['cnx']-\u003esetCallbacks([$this, \"ev_read\"], NULL, [$this, 'ev_error'], $id);\n                $this-\u003econnections[$id]['cnx']-\u003eenable(Event::READ | Event::WRITE);\n                break;\n\n            default:\n                echo '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: '.$line.\"\\n\";\n                break;\n        }\n    }\n}\n\nnew Handler();\n```\n","title":"–ü—Ä–∏–∫–ª–∞–¥–∏","contentType":2,"navigation":[{"event.resources.md":"¬´ –¢–∏–ø–∏ —Ä–µ—Å—É—Ä—Å—ñ–≤"},{"event.flags.md":"–ü—Ä–∞–ø–æ—Ä–∏ –ø–æ–¥—ñ–π ¬ª"},{"index.md":"PHP Manual"},{"book.event.md":"Event"}]}},"__N_SSG":true},"page":"/manual/uk/[slug]","query":{"slug":"event.examples.md"},"buildId":"aTdXUbop8S7MnPlMxZSRg","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>