- [« Використання PHP](faq.using.md)
- [PHP та HTML »](faq.md.md)

- [PHP Manual](index.md)
- [FAQ.md)
- Безпечне хешування паролів

# Безпечне хешування паролів

У цьому розділі пояснюються причини, що стоять за хешування паролів
цілях безпеки, а також ефективні методи хешування.

1. [Чому я повинен хешувати паролі користувачів у моєму
додатку?](#faq.passwords.hashing)
2. [Чому популярні хешуючі функції, такі як md5 та sha1 не
підходять для паролів?](#faq.passwords.fasthash)
3. [Якщо популярні хешуючі функції не підходять, як я тоді
повинен хешувати свої паролі?](#faq.passwords.bestpractice)
4. [Що таке сіль?](#faq.passwords.salt)
5. [Як я маю зберігати свою сіль?](#faq.password.storing-salts)

**Чому я повинен хешувати паролі користувачів у моїй програмі?**
Хешування паролів є однією з основних міркувань
безпеки, які необхідно зробити, при розробці програми,
приймає паролі від користувачів. Без хешування, паролі,
які зберігаються в базі вашої програми, можуть бути вкрадені, наприклад, якщо
ваша база даних була скомпрометована, а потім негайно може бути
застосовані для компрометації не тільки вашої програми, але й облікових записів
користувачів на інших сервісах, якщо вони не використовують
унікальні паролі.

Застосовуючи хешируючий алгоритм до паролів користувача перед
збереженням їх у своїй базі даних, ви унеможливлюєте розгадування
оригінального пароля для атакуючого вашу базу даних, в той же час
зберігаючи можливість порівняння отриманого хешу з оригінальним паролем.

Важливо помітити, однак, що хешування паролів захищає їх тільки від
компрометування у вашому сховищі, але не обов'язково від втручання
шкідливого коду у вашому додатку.



**Чому популярні функції, що хешують, такі як [md5()](function.md5.md) і [sha1()](function.sha1.md) не підходять для паролів?**
Такі хешуючі алгоритми як MD5, SHA1 та SHA256 були спроектовані
дуже швидкими та ефективними. За наявності сучасних технологій та
обладнання, стало досить просто з'ясувати результат цих алгоритмів
методом "грубою сили" для визначення оригінальних даних, що вводяться.

Через ту швидкість, з якою сучасні комп'ютери можуть "звернути"
ці хешуючі алгоритми, багато професіоналів комп'ютерної безпеки
суворо не рекомендують використовувати їх для хешування паролів.



**Якщо популярні функції, що хешують, не підходять, як же я тоді повинен хешувати свої паролі?**
При хешуванні паролів існує два важливі міркування: це вартість
обчислення та сіль. Чим вище вартість обчислення хешуючого алгоритму,
тим більше часу потрібно для зламування його виведення методом "грубой
сили".

PHP надає [вбудоване API хешування
паролів] (book.password.md), яке безпечно працює і з
[хешуванням](function.password-hash.md) та з [перевіркою
паролів](function.password-verify.md).

Іншою можливістю є функція [crypt()](function.crypt.md),
яка підтримує кілька алгоритмів хешування. При використанні
цієї функції ви можете бути впевненим, що вибраний алгоритм
доступний, тому що PHP містить власну реалізацію кожного
алгоритму, що підтримується, навіть у випадку, якщо якісь з них не
підтримуються системою.

При хешуванні паролів рекомендується застосовувати алгоритм Blowfish,
який також використовується за замовчуванням в API хешування паролів, так
як він значно більшої обчислювальної складності, ніж MD5 або SHA1,
при цьому, як і раніше, гнучкий.

Врахуйте, що якщо ви використовуєте функцію [crypt()](function.crypt.md)
для перевірки пароля, то вам потрібно застерегти себе від атак за часом,
застосовуючи порівняння рядків, що займає постійний час. Ні
оператори PHP [u003du003d і u003du003du003d](language.operators.comparison.md), ні функція
[strcmp()](function.strcmp.md) не є такими. Функція ж
[password_verify()](function.password-verify.md) робить те,
що потрібно. Рекомендовано використовувати [вбудований API
хешування паролів](book.password.md), якщо є така можливість.



**Що таке сіль?**
Криптографічна сіль являє собою дані, які застосовуються в
процесі хешування для запобігання можливості розгадати
оригінальне введення за допомогою пошуку результату хешування у списку
заздалегідь обчислених пар ввод-хеш, відомому також як "райдужна"
таблиці.

Простішими словами, сіль - це шматочок додаткових даних,
які роблять ваші хеші набагато стійкішими до злому. Існує
багато онлайн-сервісів, що надають великі списки заздалегідь
обчислених хешей разом із їх оригінальним введенням. Використання солі
робить пошук результуючого хешу в такому списку малоймовірним чи навіть
неможливим.

[password_hash()](function.password-hash.md) створює випадкову сіль у
у випадку, якщо вона не була передана, і найчастіше це найкращий і
безпечний вибір.



**Як я повинен зберігати свою сіль?**
При використанні функції [password_hash()](function.password-hash.md)
або [crypt()](function.crypt.md), що повертається вже містить
сіль як частина створеного хешу. Це значення потрібно зберігати як є в
вашій базі даних, так як воно містить також інформацію про хешируючу
функції, яка використовувалася, і може бути безпосередньо передана в
функції [password_verify()](function.password-verify.md) або
[crypt()](function.crypt.md) під час перевірки пароля.

Наступна діаграма показує формат значення, що повертається функціями
[crypt()](function.crypt.md) або
[password_hash()](function.password-hash.md). Як можна бачити, вони
містять повну інформацію про алгоритм і солі, необхідні для майбутньої
перевірки пароля.

![ Компоненти значення, що повертаються функціями password_hash та crypt,
йдуть у наступному порядку: обраний алгоритм, опції алгоритму, сіль та
хеш пароля.
](images/2a34c7f2e658f6ae74f3869f2aa5886f-crypt-text-rendered.svg)
