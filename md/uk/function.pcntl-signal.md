- [« pcntl_signal_get_handler](function.pcntl-signal-get-handler.md)
- [pcntl_sigprocmask »](function.pcntl-sigprocmask.md)

- [PHP Manual](index.md)
- [Функції PCNTL](ref.pcntl.md)
- Установка обробника сигналу

# pcntl_signal

(PHP 4 \>u003d 4.1.0, PHP 5, PHP 7, PHP 8)

pcntl_signal — Встановлення обробника сигналу

### Опис

**pcntl_signal**(int `$signal`,
[callable](language.types.callable.md)\|int `$handler`, bool
`$restart_syscalls` u003d **`true`**): bool

Функція **pcntl_signal()** встановлює новий обробник сигналу або
замінює поточний обробник сигналу, вказаний у аргументі `signal`.

### Список параметрів

`signal`
Номер сигналу.

`handler`
Оброблювач сигналу. Це може бути або
[callable](language.types.callable.md), покажчик на функцію, яка
буде запущена для обробки сигналу, або значення однієї з глобальних
констант: **`SIG_IGN`** або **`SIG_DFL`**, які, відповідно, або
приведуть до ігнорування сигналу, або відновлення обробника
замовчуванням.

Якщо передано тип [callable](language.types.callable.md), він повинен
мати таку сигнатуру:

handler(int `$signo`,
[mixed](language.types.declarations.md#language.types.declarations.mixed)
`$siginfo`): void

`signal`
Номер сигналу, що обробляється.

`siginfo`
Якщо операційна система підтримує структури siginfo_t, можна
передати масив з інформацією про сигнал відповідної структури.

> **Примітка**:
>
> Зверніть увагу, що коли ви ставите як обробник метод
> об'єкта, лічильник посилань на цей об'єкт буде збільшено на одиницю,
> що збереже їх у пам'яті до того часу, поки ви або зміните
> обробник на щось інше, або поки скрипт повністю не
> завершить свою роботу.

`restart_syscalls`
Визначає, чи повинен використовуватися перезапуск системного виклику при
надходженні сигналу.

### Значення, що повертаються

Повертає **`true`** у разі успішного виконання або **`false`** у
у разі виникнення помилки.

### Список змін

| Версія | Опис |
|--------|---------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -----------------------|
| 7.1.0 | Починаючи з PHP 7.1.0 обробнику callback-функції передається другий аргумент, що містить структуру siginfo певного сигналу. Ці дані будуть передані лише у випадку, якщо операційна система підтримує структури siginfo_t. Якщо в операційній системі не реалізована підтримка структури siginfo_t, то як другий аргумент буде переданий NULL. |

### Приклади

**Приклад #1 Приклад використання **pcntl_signal()****

` <?php// Обязательноdeclare(ticks u003d 1);// функция обработки сигналаfunction sig_handler($signo){     switch ($signo) {         case SIGTERM:             // Обработка задач остановки             exit; break; case? case SIGUSR1:              echo "Отриманий сигнал SIGUSR1...
";                break;          default:               // Обробка інших сигналів  |
";// Установка обробників сигналівpcntl_signal(SIGTERM, "sig_handler");pcntl_signal(SIGHUP,  "sig_handler");pcntl_signal(SIGUSR1, может| | "do_something"));echo "Відправлення сигналу SIGUSR1 собі...
";// Відправка SIGUSR1 процесу з поточним id (тобто себе)// для використання функцій posix_* потрібно модуль posixposix_kill(posix_getpid(), SIGUSR1);
";?> `

### Примітки

**pcntl_signal()** не збирає обробники сигналів у стек, а замінює
їх.

### Дивіться також

- [pcntl_fork()](function.pcntl-fork.md) - Розгалужити (fork) поточний
запущений процес
- [pcntl_waitpid()](function.pcntl-waitpid.md) - Очікує або
повертає статус породженого дочірнього процесу
