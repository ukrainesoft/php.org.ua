- [«shmop_delete](function.shmop-delete.md)
- [shmop_read »](function.shmop-read.md)

- [PHP Manual](index.md)
- [Поділ, що розділяється (shared) пам'ять](ref.shmop.md)
- Резервування або використання блоку пам'яті, що розділяється

#shmop_open

(PHP 4 \>u003d 4.0.4, PHP 5, PHP 7, PHP 8)

shmop_open — Резервування або використання блоку пам'яті, що розділяється

### Опис

**shmop_open**(
int `$key`,
string `$mode`,
int `$permissions`,
int `$size`
): [Shmop](class.shmop.md)\|false

**shmop_open()** резервує або використовує існуючий блок
пам'яті, що розділяється.

### Список параметрів

`key`
Системний ідентифікатор блоку пам'яті, що розділяється. Може бути заданий у
десяткового або шістнадцяткового кодування.

`mode`
Доступні для використання прапори:

- "a" для доступу (встановлює прапорець SHM_RDONLY) Слід застосовувати
цей прапор, коли потрібно використовувати раніше зарезервований
ділянку пам'яті, що розділяється, вже містить будь-які дані. В цьому
у разі доступ можливий лише для операцій читання.
- "c" для резервування (встановлює прапорець IPC_CREATE) Слід
застосовувати цей прапор для створення нової зарезервованої ділянки
пам'яті, що розділяється. Якщо ділянка пам'яті з таким ідентифікатором
існує, виконується спроба доступу до нього для наступних
операцій читання та запису.
- "w" для виконання операцій читання та запису Слід застосовувати цей
прапор для читання та запису даних, що зберігаються в пам'яті, що розділяється.
Цей прапор використовується в більшості випадків.
- "n" для створення в пам'яті нового сегмента (встановлює прапорець
IPC_CREATE\|IPC_EXCL) Слід використовувати цей прапорець для створення
нового сегмента в пам'яті, що розділяється, але якщо сегмент вже існує
з тим же прапором відбувається відмова. Це корисно з метою безпеки,
т.к. дозволяє уникнути помилок синхронізації (Race condition
exploits).

`permissions`
Права доступу до ділянки пам'яті такі ж, як і до звичайного файлу. Їх можна
вказувати у вісімковому вигляді, наприклад `0644`.

`size`
Розмір резервованого блоку в пам'яті, що розділяється, в байтах

> **Примітка**:
>
> Зверніть увагу: треті та четверті параметри повинні бути вказані
> як 0, якщо потрібно отримати доступ до наявної ділянки пам'яті.

### Значення, що повертаються

У разі успішного виконання **shmop_open()** повертає екземпляр
[Shmop](class.shmop.md), який може бути надалі використаний
доступ до зарезервованої ділянки пам'яті. У разі виникнення
помилки повертає **`false`**.

### Список змін

| Версія | Опис |
|--------|---------------------------------------- -------------------------------------------------- ----------------------------|
| 8.0.0 | У разі успішного виконання повертається екземпляр [Shmop](class.shmop.md); раніше повертався ресурс (resource). |

### Приклади

**Приклад #1 Резервування ділянки пам'яті, що розділяється**

` <?php$shm_key u003d ftok(__FILE__, 't');$shm_id u003d shmop_open($shm_key, "c", 0644, 100);?> `

У наведеному прикладі виконується доступ до блоку з ідентифікатором
повертається функцією [ftok()](function.ftok.md).

### Дивіться також

- [shmop_close()](function.shmop-close.md) - Закриття блоку
пам'яті
- [shmop_delete()](function.shmop-delete.md) - Видалення блоку
пам'яті
