- [« yaz_schema](function.yaz-schema.md)
- [yaz_set_option »](function.yaz-set-option.md)

- [PHP Manual](index.md)
- [Функції YAZ](ref.yaz.md)
- Підготовка пошуку

# yaz_search

(PHP 4 u003d 4.0.1, PECL yaz u003d 0.9.0)

yaz_search — Підготовка пошуку

### Опис

**yaz_search**(resource `$id`, string `$type`, string `$query`): bool

**yaz_search()** готує пошук на заданому з'єднанні.

Так само як і [yaz_connect()](function.yaz-connect.md) ця функція
неблокуюча і лише готує умови пошуку, який буде
виконаний функцією [yaz_wait()](function.yaz-wait.md).

### Список параметрів

`id`
Дескриптор з'єднання, що повертається функцією
[yaz_connect()](function.yaz-connect.md).

`type`
Цей параметр є типом запиту. Підтримується лише
тип ``rpn'`. У цьому випадку третій аргумент визначає запит Type-1
префіксної нотації запитів

`query`
Запит RPN є текстовим поданням запиту Type-1, як зазначено
у стандарті Z39.50. Тим не менш у текстовому поданні, що використовується
YAZ, застосовується префиксная нотація, тобто. оператор передує
операнду. Рядок запиту є послідовністю
лексем(токенів), в якій ігноруються пробільні символи, крім тих,
що знаходяться між подвійними лапками. Лексеми, які починаються з
символу `@` є операторами, інакше вони сприймаються як пошуковий
термін.

| Конструкція Опис |
|-------------------------|----------------------- -------------------------|
| `@and` query1 query2 | перетин query1 та query2 |
| `@or` query1 query2 | об'єднання query1 та query2 |
| `not` query1 query2 | query1 та не query2 |
| `@set` name | посилання на набір значень, що повертаються |
| `@attrset` set query | визначає набір атрибутів `set` для запиту `query`. Ця конструкція доступна лише один раз – на самому початку запиту. |
| `@attr` \[set\] typeu003dvalue query | встановлює атрибути запиту. Значення `type` та `value` - цілочислові та визначають тип атрибуту та тип значення відповідно. Значення `set`, якщо воно встановлено, визначає налаштування атрибутів. |

**Оператори RPN**

Всю інформацію про доступні атрибути ви можете знайти на сайті [»Z39.50
Maintenance Agency](http://www.loc.gov/z3950/agency/defns/bib1.md)

> **Примітка**:
>
> Якщо ви хочете використовувати більш дружню нотацію, використовуйте
> CCL парсер - функції [yaz_ccl_conf()](function.yaz-ccl-conf.md) та
> [yaz_ccl_parse()](function.yaz-ccl-parse.md).

### Значення, що повертаються

Повертає **`true`** у разі успішного виконання або **`false`** у
у разі виникнення помилки.

### Приклади

**Приклад #1 Приклади запитів**

Ви можете використовувати прості терми, наприклад:

``` examplescode
computer
````

які знаходять збіги слова "computer" у документах. Атрибути не
визначено.

запит

``` examplescode
"knuth donald"
````

знаходить документи, де зустрічається фраза "knuth donald" (передбачається,
що сервер підтримує пошук за фразами).

Запит містить два атрибути однієї фрази.

@attr 1u003d1003 @attr 4u003d1 "knuth donald"

Перший атрибут має тип 1 (використовується Bib-1), значення якого дорівнює
1003(Автор). Другий атрибут має тип 4 (структура) зі значенням 1
(Фраза). Таким чином, цей запит буде шукати документи автор
яких Donald Knuth.

запит

``` examplescode
@and @or a b @not @or c d e
````

в інфіксній нотації представляється як
`(a або b) та ((c або d) і не e)`.

ще один складніший запит:

@attrset gils @and @attr 1u003d4 art @attr 1u003d2000 company

Весь запит використовуватиме набір атрибутів GILS. Запит шукає
документи, де `art` зустрічається в назві (GILS, BIB-1) та `company` в
постачальників.
