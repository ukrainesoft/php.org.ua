{"pageProps":{"page":{"slug":"function.cubrid-rollback.md","content":"# cubrid\\_rollback\n\n(PECL CUBRID >= 8.3.0)\n\ncubrid\\_rollback - Відкат транзакції\n\n### Опис\n\n```methodsynopsis\ncubrid_rollback(resource $conn_identifier): bool\n```\n\nФункция**cubrid\\_rollback()** виконує відкат транзакції, яку вказує `conn_identifier`, яка в даний момент виконується.\n\nЗ'єднання з сервером закривається після дзвінка **cubrid\\_rollback()**. Однак дескриптор з'єднання все ще дійсний.\n\n### Список параметрів\n\n`conn_identifier`\n\nConnection identifier.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад використання** cubrid\\_rollback()\\*\\*\\*\\*\n\n```php\n<?php\n$conn = cubrid_connect(\"127.0.0.1\", 33000, \"demodb\", \"dba\");\ncubrid_set_autocommit($conn,false);\n\n@cubrid_execute($conn, \"DROP TABLE publishers\");\n\n$sql = <<<EOD\nCREATE TABLE publishers(\npub_id CHAR(3),\npub_name VARCHAR(20),\ncity VARCHAR(15),\nstate CHAR(2),\ncountry VARCHAR(15)\n)\nEOD;\n\nif (!cubrid_execute($conn, $sql)) {\n    printf(\"Ошибка объекта: %d\\nКод ошибки: %d\\nСообщение об ошибке: %s\\n\", cubrid_error_code_facility(), cubrid_error_code(), cubrid_error_msg());\n\n    cubrid_disconnect($conn);\n    exit;\n}\n\n$req = cubrid_prepare($conn, \"INSERT INTO publishers VALUES(?, ?, ?, ?, ?)\");\n\n$id_list = array(\"P01\", \"P02\", \"P03\", \"P04\");\n$name_list = array(\"Abatis Publishers\", \"Core Dump Books\", \"Schadenfreude Press\", \"Tenterhooks Press\");\n$city_list = array(\"New York\", \"San Francisco\", \"Hamburg\", \"Berkeley\");\n$state_list = array(\"NY\", \"CA\", NULL, \"CA\");\n$country_list = array(\"USA\", \"USA\", \"Germany\", \"USA\");\n\nfor ($i = 0, $size = count($id_list); $i < $size; $i++) {\n    cubrid_bind($req, 1, $id_list[$i]);\n    cubrid_bind($req, 2, $name_list[$i]);\n    cubrid_bind($req, 3, $city_list[$i]);\n    cubrid_bind($req, 4, $state_list[$i]);\n    cubrid_bind($req, 5, $country_list[$i]);\n\n    if (!($ret = cubrid_execute($req))) {\n        break;\n    }\n}\n\nif (!$ret) {\n    cubrid_rollback($conn);\n} else {\n    cubrid_commit($conn);\n\n    $req = cubrid_execute($conn, \"SELECT * FROM publishers\");\n    while ($result = cubrid_fetch_assoc($req)) {\n        printf(\"%-3s %-20s %-15s %-3s %-15s\\n\",\n            $result[\"pub_id\"], $result[\"pub_name\"], $result[\"city\"], $result[\"state\"], $result[\"country\"]);\n    }\n}\n\ncubrid_disconnect($conn);\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nP01 Abatis Publishers    New York        NY  USA\nP02 Core Dump Books      San Francisco   CA  USA\nP03 Schadenfreude Press  Hamburg             Germany\nP04 Tenterhooks Press    Berkeley        CA  USA\n```\n\n### Дивіться також\n\n-   [cubrid\\_commit()](function.cubrid-commit.md) \\- підтвердження транзакції\n-   [cubrid\\_disconnect()](function.cubrid-disconnect.md) \\- Закриває з'єднання з базою даних\n","title":"cubrid\\_rollback","contentType":2,"navigation":[{"function.cubrid-put.md":"« cubrid\\_put"},{"function.cubrid-schema.md":"cubrid\\_schema »"},{"index.md":"PHP Manual"},{"ref.cubrid.md":"Функції CUBRID"}]}},"__N_SSG":true}