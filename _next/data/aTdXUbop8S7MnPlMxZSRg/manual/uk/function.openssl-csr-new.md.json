{"pageProps":{"page":{"slug":"function.openssl-csr-new.md","content":"# openssl\\_csr\\_new\n\n(PHP 4 >= 4.2.0, PHP 5, PHP 7, PHP 8)\n\nopenssl\\_csr\\_new — Генерує CSR\n\n### Опис\n\n```methodsynopsis\nopenssl_csr_new(    array $distinguished_names,    OpenSSLAsymmetricKey &$private_key,    ?array $options = null,    ?array $extra_attributes = null): OpenSSLCertificateSigningRequest|false\n```\n\n**openssl\\_csr\\_new()** створює новий CSR ґрунтуючись на інформації, зазначеній у параметрі `distinguished_names`\n\n> **Зауваження**: Для коректної роботи цієї функції має бути правильний openssl.cnf. Для більш детальної інформації дивіться зауваження під [розділом установки](openssl.installation.md)\n\n### Список параметрів\n\n`distinguished_names`\n\nУнікальне ім'я (Distinguished Name) або поля суб'єкта для використання у сертифікаті.\n\n`private_key`\n\nПараметр`private_key` має бути заданий закритим ключем раніше згенерованим функцією [openssl\\_pkey\\_new()](function.openssl-pkey-new.md) (або отриманий за допомогою будь-якої іншої функції сімейства openssl\\_pkey). Відповідна відкрита частина ключа буде використана для підписання CSR.\n\n`options`\n\nЗа замовчуванням для ініціалізації запиту використовується інформація з системного `openssl.conf`. Ви можете вказати розділ конфігураційного файлу шляхом завдання ключа `config_section_section`в`options`. Також ви можете задати альтернативний конфігураційний файл openssl шляхом завдання ключа `config` значенням шляху до нього. Відповідність ключів, зазначених у `options`ключам из`openssl.conf`представлено ниже.\n\n**Перевизначення конфігурації**\n\n| Ключ `options` | Тип | Соответствие в `openssl.conf` | Опис |\n| --- | --- | --- | --- |\n| digest\\_alg | string | default\\_md | Один из методов[openssl\\_get\\_md\\_methods()](function.openssl-get-md-methods.md) |\n| x509\\_extensions | string | x509\\_extensions | Визначає, яке розширення має використовуватись для створення сертифіката x509 |\n| req\\_extensions | string | req\\_extensions | Визначає, яке розширення має використовуватись для створення CSR |\n| private\\_key\\_bits | int | default\\_bits | Задає, скільки біт має використовуватись для генерації закритого ключа |\n| private\\_key\\_type | int | none | Задає тип закритого ключа, що створюється. Одна з констант: **`OPENSSL_KEYTYPE_DSA`** **`OPENSSL_KEYTYPE_DH`** **`OPENSSL_KEYTYPE_RSA`** або **`OPENSSL_KEYTYPE_EC`**По умолчанию**`OPENSSL_KEYTYPE_RSA`** |\n| encrypt\\_key | bool | encrypt\\_key | Чи повинен шифруватися (паролем) ключ, що експортується? |\n| encrypt\\_key\\_cipher | int | none | Одна из[констант шифрів](openssl.ciphers.md) |\n| curve\\_name | string | none | Одне з [openssl\\_get\\_curve\\_names()](function.openssl-get-curve-names.md) |\n| config | string | N/A | Шлях до альтернативного конфігураційного файлу openssl.conf. |\n\n`extra_attributes`\n\n`extra_attributes` використовується для визначення додаткових опцій для CSR. І `distinguished_names`, и`extra_attributes` є асоціативними масивами, ключі яких перетворюються на OI-и і застосовуються до відповідних частин запиту.\n\n### Значення, що повертаються\n\nПовертає CSR або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| 8.0.0 | `csr` тепер приймає екземпляр [OpenSSLCertificateSigningRequest](class.opensslcertificatesigningrequest.md); раніше приймався ресурс ([resource](language.types.resource.md)) типу`OpenSSL X.509 CSR` |\n| 8.0.0 | `private_key` тепер приймає екземпляр [OpenSSLAsymmetricKey](class.opensslasymmetrickey.md); раніше приймався ресурс ([resource](language.types.resource.md)) типу`OpenSSL key` |\n| 7.1.0 | Параметр`options` тепер підтримує `curve_name` |\n\n### Приклади\n\n**Приклад #1 Створення самопідписаного сертифіката**\n\n```php\n<?php\n// для сервера сертификации SSL, commonName является доменным именем\n// для сертификатов S/MIME, commonName является владельцем расположения адреса email\n// и поля идентификации относятся к владельцу домена или электронной почты,\n// подлежащим защите\n$dn = array(\n    \"countryName\" => \"GB\",\n    \"stateOrProvinceName\" => \"Somerset\",\n    \"localityName\" => \"Glastonbury\",\n    \"organizationName\" => \"The Brain Room Limited\",\n    \"organizationalUnitName\" => \"PHP Documentation Team\",\n    \"commonName\" => \"Wez Furlong\",\n    \"emailAddress\" => \"wez@example.com\"\n);\n\n// Создание пары закрытый/открытый ключ\n$privkey = openssl_pkey_new(array(\n    \"private_key_bits\" => 2048,\n    \"private_key_type\" => OPENSSL_KEYTYPE_RSA,\n));\n\n// Создание CSR\n$csr = openssl_csr_new($dn, $privkey, array('digest_alg' => 'sha256'));\n\n// Создание самоподписанного сертификата со сроком жизни 365 дней\n$x509 = openssl_csr_sign($csr, null, $privkey, $days=365, array('digest_alg' => 'sha256'));\n\n// Сохранение закрытого ключа, CSR и самоподписанного сертификата\nopenssl_csr_export($csr, $csrout) and var_dump($csrout);\nopenssl_x509_export($x509, $certout) and var_dump($certout);\nopenssl_pkey_export($privkey, $pkeyout, \"mypassword\") and var_dump($pkeyout);\n\n// Покажем возникшие ошибки, если они были\nwhile (($e = openssl_error_string()) !== false) {\n    echo $e . \"\\n\";\n}\n?>\n```\n\n**Приклад #2 Створення самопідписаного сертифіката ECC (починаючи з PHP 7.1.0)**\n\n```php\n<?php\n$subject = array(\n    \"commonName\" => \"docs.php.net\",\n);\n\n// Создание пары закрытый/открытый ключ\n$private_key = openssl_pkey_new(array(\n    \"private_key_type\" => OPENSSL_KEYTYPE_EC,\n    \"curve_name\" => 'prime256v1',\n));\n\n// Создание CSR\n$csr = openssl_csr_new($subject, $private_key, array('digest_alg' => 'sha384'));\n\n// Создание самоподписанного EC сертификата\n$x509 = openssl_csr_sign($csr, null, $private_key, $days=365, array('digest_alg' => 'sha384'));\nopenssl_x509_export_to_file($x509, 'ecc-cert.pem');\nopenssl_pkey_export_to_file($private_key, 'ecc-private.key');\n?>\n```\n\n### Дивіться також\n\n-   [openssl\\_csr\\_sign()](function.openssl-csr-sign.md) \\- Підписати CSR за допомогою іншого сертифіката (або ним же) та створити сертифікат\n","title":"openssl\\_csr\\_new","contentType":2,"navigation":[{"function.openssl-csr-get-subject.md":"« openssl\\_csr\\_get\\_subject"},{"function.openssl-csr-sign.md":"openssl\\_csr\\_sign »"},{"index.md":"PHP Manual"},{"ref.openssl.md":"Функції OpenSSL"}]}},"__N_SSG":true}