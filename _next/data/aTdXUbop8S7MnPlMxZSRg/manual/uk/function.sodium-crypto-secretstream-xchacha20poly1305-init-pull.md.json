{"pageProps":{"page":{"slug":"function.sodium-crypto-secretstream-xchacha20poly1305-init-pull.md","content":"# sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_pull\n\n(PHP 7 >= 7.2.0, PHP 8)\n\nsodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_pull - Ініціалізує контекст secretstream для дешифрування\n\n### Опис\n\n```methodsynopsis\nsodium_crypto_secretstream_xchacha20poly1305_init_pull(string $header, string $key): string\n```\n\nІніціалізує контекст secretstream для дешифрування\n\n### Список параметрів\n\n`header`\n\nЗаголовок secretstream. Має бути одне із значень, створених [sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push()](function.sodium-crypto-secretstream-xchacha20poly1305-init-push.md)\n\n`key`\n\nКлюч шифрування (256 біт).\n\n### Значення, що повертаються\n\nСтан secretstream.\n\n### Приклади\n\n**Приклад #1 Приклад використання** sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_pull()\\*\\*\\*\\*\n\n```php\n<?php\nfunction decrypt_file(string $inputFilePath, string $outputFilePath, string $key): void\n{\n    $inputFile = fopen($inputFilePath, 'rb');\n    $outputFile = fopen($outputFilePath, 'wb');\n    $header = fread($inputFile, 24);\n\n    $state = sodium_crypto_secretstream_xchacha20poly1305_init_pull($header, $key);\n    $inputFileSize = fstat($inputFile)['size'];\n\n    // Расшифровка файла и запись содержимого в выходной файл:\n    for ($i = 24; $i < $inputFileSize; $i += 8192) {\n        $ctxt_chunk = fread($inputFile, 8192);\n\n        // Мы не используем $tag, но в реальных протоколах вы можете использовать его для шифрования, наПриклад,\n        // инициировать смену ключа или указать конец файла. Затем при расшифровке\n        // вы можете подтвердить это поведение.\n        [$ptxt_chunk, $tag] = sodium_crypto_secretstream_xchacha20poly1305_pull($state, $ctxt_chunk);\n        fwrite($outputFile, $ptxt_chunk);\n    }\n\n    sodium_memzero($state);\n    fclose($inputFile);\n    fclose($outputFile);\n}\n\n// sodium_crypto_secretstream_xchacha20poly1305_keygen()\n$key = sodium_base642bin('MS0lzb7HC+thY6jY01pkTE/cwsQxnRq0/2L1eL4Hxn8=', SODIUM_BASE64_VARIANT_ORIGINAL);\n\n$example = sodium_hex2bin('971e33b255f0990ef3931caf761c59136efa77b434832f28ec719e3ff73f5aec38b3bba1574ab5b70a8844d8da36a668e802cfea2c');\nfile_put_contents('hello.enc', $example);\ndecrypt_file('hello.enc', 'hello.txt.decrypted', $key);\nvar_dump(file_get_contents('hello.txt.decrypted'));\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\nstring(12) \"Hello world!\"\n```\n","title":"sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_pull","contentType":2,"navigation":[{"function.sodium-crypto-secretbox.md":"« sodium\\_crypto\\_secretbox"},{"function.sodium-crypto-secretstream-xchacha20poly1305-init-push.md":"sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push »"},{"index.md":"PHP Manual"},{"ref.sodium.md":"Опції Sodium"}]}},"__N_SSG":true}