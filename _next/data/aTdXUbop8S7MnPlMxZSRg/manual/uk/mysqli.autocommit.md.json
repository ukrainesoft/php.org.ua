{"pageProps":{"page":{"slug":"mysqli.autocommit.md","content":"# mysqli::autocommit\n\n# mysqli\\_autocommit\n\n(PHP 5, PHP 7, PHP 8)\n\nmysqli::autocommit -- mysqli\\_autocommit — Вмикає або вимикає автоматичну фіксацію змін бази даних\n\n### Опис\n\nОб'єктно-орієнтований стиль\n\n```methodsynopsis\npublic mysqli::autocommit(bool $enable): bool\n```\n\nПроцедурний стиль\n\n```methodsynopsis\nmysqli_autocommit(mysqli $mysql, bool $enable): bool\n```\n\nВмикає або вимикає режим автоматичної фіксації змін для з'єднання з базою даних.\n\nЩоб визначити поточний стан режиму, використовуйте SQL `SELECT @@autocommit`\n\n### Список параметрів\n\n`mysql`\n\nТільки для процедурного стилю: об'єкт [mysqli](class.mysqli.md), який повернула функція [mysqli\\_connect()](function.mysqli-connect.md)или функция[mysqli\\_init()](mysqli.init.md)\n\n`enable`\n\nВмикає або вимикає режим автоматичної фіксації змін.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Помилки\n\nЯкщо сповіщення про помилки mysqli включено (**`MYSQLI_REPORT_ERROR`**) та запитана операція не вдалася, видається попередження. Якщо, крім того, встановлено режим **`MYSQLI_REPORT_STRICT`**, натомість буде викинуто виняток [mysqli\\_sql\\_exception](class.mysqli-sql-exception.md)\n\n### Приклади\n\n**Приклад #1 Приклад використання** mysqli::autocommit()\\*\\*\\*\\*\n\nОб'єктно-орієнтований стиль\n\n```php\n<?php\n\n/* Указать mysqli выбрасывать исключение в случае возникновения ошибки */\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n\n$mysqli = new mysqli(\"localhost\", \"my_user\", \"my_password\", \"world\");\n\n/* Движок таблиц должен поддерживать транзакции */\n$mysqli->query(\"CREATE TABLE IF NOT EXISTS language (\n    Code text NOT NULL,\n    Speakers int(11) NOT NULL\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\");\n\n/* Отключить автоматическую фиксацию */\n$mysqli->autocommit(false);\n\n$result = $mysqli->query(\"SELECT @@autocommit\");\n$row = $result->fetch_row();\nprintf(\"Автоматическая фиксация: %s\\n\", $row[0]);\n\ntry {\n    /* Подготовить выражение для добавления */\n    $stmt = $mysqli->prepare('INSERT INTO language(Code, Speakers) VALUES (?,?)');\n    $stmt->bind_param('ss', $language_code, $native_speakers);\n\n    /* Добавление каких-то значений */\n    $language_code = 'DE';\n    $native_speakers = 50_123_456;\n    $stmt->execute();\n    $language_code = 'FR';\n    $native_speakers = 40_546_321;\n    $stmt->execute();\n\n    /* Зафиксируйте данные в базе данных. Это не устанавливает autocommit=true */\n    $mysqli->commit();\n    print \"Зафиксировано 2 строки в базе данных\\n\";\n\n    $result = $mysqli->query(\"SELECT @@autocommit\");\n    $row = $result->fetch_row();\n    printf(\"Автоматическая фиксация: %s\\n\", $row[0]);\n\n    /* Попробуйте вставить больше значений */\n    $language_code = 'PL';\n    $native_speakers = 30_555_444;\n    $stmt->execute();\n    $language_code = 'DK';\n    $native_speakers = 5_222_444;\n    $stmt->execute();\n\n    /* Установка autocommit=true вызовет фиксацию */\n    $mysqli->autocommit(true);\n\n    print \"Зафиксировано 2 строки в базе данных\\n\";\n} catch (mysqli_sql_exception $exception) {\n    $mysqli->rollback();\n\n    throw $exception;\n}\n```\n\nПроцедурний стиль\n\n```php\n<?php\n\n/* Указать mysqli выбрасывать исключение в случае возникновения ошибки */\nmysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);\n\n$mysqli = mysqli_connect(\"localhost\", \"my_user\", \"my_password\", \"world\");\n\n/* Движок таблиц должен поддерживать транзакции */\nmysqli_query($mysqli, \"CREATE TABLE IF NOT EXISTS language (\n    Code text NOT NULL,\n    Speakers int(11) NOT NULL\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\");\n\n/* Отключить автоматическую фиксацию */\nmysqli_autocommit($mysqli, false);\n\n$result = mysqli_query($mysqli, \"SELECT @@autocommit\");\n$row = mysqli_fetch_row($result);\nprintf(\"Автоматическая фиксация: %s\\n\", $row[0]);\n\ntry {\n    /* Подготовить выражение для добавления */\n    $stmt = mysqli_prepare($mysqli, 'INSERT INTO language(Code, Speakers) VALUES (?,?)');\n    mysqli_stmt_bind_param($stmt, 'ss', $language_code, $native_speakers);\n\n    /* Добавление каких-то значений */\n    $language_code = 'DE';\n    $native_speakers = 50_123_456;\n    mysqli_stmt_execute($stmt);\n    $language_code = 'FR';\n    $native_speakers = 40_546_321;\n    mysqli_stmt_execute($stmt);\n\n    /* Зафиксируйте данные в базе данных. Это не устанавливает autocommit=true */\n    mysqli_commit($mysqli);\n    print \"Зафиксировано 2 строки в базе данных\\n\";\n\n    $result = mysqli_query($mysqli, \"SELECT @@autocommit\");\n    $row = mysqli_fetch_row($result);\n    printf(\"Автоматическая фиксация: %s\\n\", $row[0]);\n\n    /* Попробуйте вставить больше значений */\n    $language_code = 'PL';\n    $native_speakers = 30_555_444;\n    mysqli_stmt_execute($stmt);\n    $language_code = 'DK';\n    $native_speakers = 5_222_444;\n    mysqli_stmt_execute($stmt);\n\n    /* Установка autocommit=true вызовет фиксацию */\n    mysqli_autocommit($mysqli, true);\n\n    print \"Зафиксировано 2 строки в базе данных\\n\";\n} catch (mysqli_sql_exception $exception) {\n    mysqli_rollback($mysqli);\n\n    throw $exception;\n}\n```\n\nРезультат виконання наведених прикладів:\n\n```\nАвтоматическая фиксация: 0\nЗафиксировано 2 строки в базе данных\nАвтоматическая фиксация: 0\nЗафиксировано 2 строки в базе данных\nАвтоматическая фиксация: 0\nЗафиксировано 2 строки в базе данных\nАвтоматическая фиксация: 0\nЗафиксировано 2 строки в базе данных\n```\n\n### Примітки\n\n> **Зауваження** :\n> \n> Функція не працює з нетранзакційними типами таблиць (наприклад, MyISAM або ISAM).\n\n### Дивіться також\n\n-   [mysqli\\_begin\\_transaction()](mysqli.begin-transaction.md) \\- Стартує транзакцію\n-   [mysqli\\_commit()](mysqli.commit.md) \\- Фіксує поточну транзакцію\n-   [mysqli\\_rollback()](mysqli.rollback.md) \\- Відкат поточної транзакції\n","title":"mysqli::autocommit","contentType":2,"navigation":[{"mysqli.affected-rows.md":"« mysqli::$affected\\_rows"},{"mysqli.begin-transaction.md":"mysqli::begin\\_transaction »"},{"index.md":"PHP Manual"},{"class.mysqli.md":"mysqli"}]}},"__N_SSG":true}