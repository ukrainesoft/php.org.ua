{"pageProps":{"page":{"slug":"ffi.examples-callback.md","content":"## Callback-функції PHP\n\nМожна привласнити замикання PHP змінної типу \"покажчик\" (pointer) або передати його як аргумент функції:\n\n```php\n<?php\n$zend = FFI::cdef(\"\n    typedef int (*zend_write_func_t)(const char *str, size_t str_length);\n    extern zend_write_func_t zend_write;\n\");\n\necho \"Привет, мир 1!\\n\";\n\n$orig_zend_write = clone $zend->zend_write;\n$zend->zend_write = function($str, $len) {\n    global $orig_zend_write;\n    $orig_zend_write(\"{\\n\\t\", 3);\n    $ret = $orig_zend_write($str, $len);\n    $orig_zend_write(\"}\\n\", 2);\n    return $ret;\n};\necho \"Привет, мир 2!\\n\";\n$zend->zend_write = $orig_zend_write;\necho \"Привет, мир 3!\\n\";\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nПривет, мир 1!\n{\n        Привет, мир 2!\n}\nПривет, мир 3!\n```\n\nХоча це і працює, але ця функціональність підтримується не на всіх платформах libffi, не є ефективною і викликає витік ресурсів при завершенні запитів.\n\n**Підказка**\n\nТому рекомендується мінімізувати використання callback-функцій PHP.\n","title":"Callback-функції PHP","contentType":2,"navigation":[{"ffi.examples-basic.md":"« Прості приклади використання FFI"},{"ffi.examples-complete.md":"Комплексний приклад PHP/FFI/preloading »"},{"index.md":"PHP Manual"},{"ffi.examples.md":"Приклади"}]}},"__N_SSG":true}