- [«com_load_typelib](function.com-load-typelib.md)
- [com_print_typeinfo »](function.com-print-typeinfo.md)

- [PHP Manual](index.md)
- [Функції COM](ref.com.md)
- Обробка повідомлень COM, що прийшли не пізніше timeoutms мілісекунд
після її запуску

# com_message_pump

(PHP 4 \>u003d 4.2.0, PHP 5, PHP 7, PHP 8)

com_message_pump — Обробка повідомлень COM, які прийшли пізніше
timeoutms мілісекунд після її запуску

### Опис

**com_message_pump**(int `$timeout_milliseconds` u003d 0): bool

Функція "засинає" на `timeout_milliseconds` мілісекунд, або поки що
черга не прийде на нове повідомлення.

Призначення функції полягає в маршрутизації викликів COM між
підрозділами та обробкою різних асинхронних завдань. Вона дозволить
вашому скрипту чекати виникнення події, одночасно з цим
перехоплюючи інші події або виконуючи інший код на тлі. Ви повинні
використовувати її в циклі, як показано на прикладі функції
[com_event_sink()](function.com-event-sink.md) до припинення
використання прив'язки подій об'єкта COM.

### Список параметрів

`timeout_milliseconds`
Затримка у мілісекундах.

Якщо значення `timeout_milliseconds` не задано, воно буде вважатися
рівним нулю. Це означає, що не буде затримки. Якщо при цьому
є очікуване подія, воно буде оброблено як завжди. Якщо
події немає, то функція відразу поверне **`false`**.

### Значення, що повертаються

Якщо повідомлення надійшло до вичерпання затримки, то вони будуть оброблені та
функція поверне **`true`**. Якщо час затримки вийшов і жодного
повідомлення не надійшло, то функція поверне **`false`**.
