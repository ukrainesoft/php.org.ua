{"pageProps":{"page":{"slug":"function.sqlsrv-query.md","content":"# sqlsrv\\_query\n\n(No version information available, might only be in Git)\n\nsqlsrv\\_query — Підготовка та виконання запиту\n\n### Опис\n\n```methodsynopsis\nsqlsrv_query(    resource $conn,    string $sql,    array $params = ?,    array $options = ?): mixed\n```\n\nПідготовляє та виконує запит.\n\n### Список параметрів\n\n`conn`\n\nРесурс підключення, що повертається [sqlsrv\\_connect()](function.sqlsrv-connect.md)\n\n`sql`\n\nРядок, що визначає запит, який потрібно підготувати та виконати.\n\n`params`\n\nМасив, що визначає інформацію про параметри під час параметризованого запиту. Елементи масиву можуть бути будь-якими з наступних:\n\n-   Строкового значення\n-   Змінної PHP\n-   Масиву з наступною структурою: array($value\\[, $direction\\[, $phpType\\[, $sqlType\\]\\]\\]) .\n\nУ наступній таблиці описані елементи у структурі масиву вище:\n\n**Структура масиву**\n\n| Элемент | Опис |\n| --- | --- |\n| $value | Рядкове значення, змінна PHP або змінна PHP, передана за посиланням. |\n| $direction (optional) | Одна з наступних констант SQLSRV, що використовуються для вказівки напряму параметра: SQLSRV\\_PARAM\\_IN, SQLSRV\\_PARAM\\_OUT, SQLSRV\\_PARAM\\_INOUT. Значення за промовчанням - SQLSRV\\_PARAM\\_IN. |\n| $phpType (optional) | Константа SQLSRV\\_PHPTYPE\\_\\*, що вказує тип даних PHP значення, що повертається. |\n| $sqlType (optional) | Константа SQLSRV\\_SQLTYPE\\_\\*вказує тип даних SQL Server вхідного значення. |\n\n`options`\n\nМасив, визначальний параметри властивостей запиту. Ключі, що підтримуються, описані в наступній таблиці:\n\n**Властивості запиту**\n\n| Ключ | Значения | Опис |\n| --- | --- | --- |\n| QueryTimeout | Позитивне ціле значення. | Встановлює час очікування в секундах. За замовчуванням драйвер чекатиме на результати нескінченно. |\n| SendStreamParamsAtExec | **`true`** або **`false`** (за замовчуванням **`true`**) . | Налаштовує драйвер для надсилання всіх даних потоку під час виконання (**`true`**) або для надсилання даних потоку частинами (**`false`**). За замовчуванням встановлено значення **`true`**. . Для отримання додаткової інформації дивіться [sqlsrv\\_send\\_stream\\_data()](function.sqlsrv-send-stream-data.md) |\n| Scrollable | SQLSRV\\_CURSOR\\_FORWARD, SQLSRV\\_CURSOR\\_STATIC, SQLSRV\\_CURSOR\\_DYNAMIC, або SQLSRV\\_CURSOR\\_KEYSET | Смотрите[» Вказівка ​​типу курсору та вибір рядків](http://msdn.microsoft.com/en-us/library/ee376927.aspx)в документации Microsoft SQLSRV. |\n\n### Значення, що повертаються\n\nПовертає ресурс виразу у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад використання** sqlsrv\\_query()\\*\\*\\*\\*\n\n```php\n<?php\n$serverName = \"serverName\\sqlexpress\";\n$connectionInfo = array( \"Database\"=>\"dbName\", \"UID\"=>\"username\", \"PWD\"=>\"password\" );\n$conn = sqlsrv_connect( $serverName, $connectionInfo);\nif( $conn === false ) {\n     die( print_r( sqlsrv_errors(), true));\n}\n\n$sql = \"INSERT INTO Table_1 (id, data) VALUES (?, ?)\";\n$params = array(1, \"some data\");\n\n$stmt = sqlsrv_query( $conn, $sql, $params);\nif( $stmt === false ) {\n     die( print_r( sqlsrv_errors(), true));\n}\n?>\n```\n\n### Примітки\n\nДля операторів, які ви плануєте виконати лише один раз, використовуйте **sqlsrv\\_query()**. Якщо ви маєте намір повторно виконати вираз з іншими параметрами, використовуйте комбінацію [sqlsrv\\_prepare()](function.sqlsrv-prepare.md) і [sqlsrv\\_execute()](function.sqlsrv-execute.md)\n\n### Дивіться також\n\n-   [sqlsrv\\_prepare()](function.sqlsrv-prepare.md) \\- готує запит до виконання\n-   [sqlsrv\\_execute()](function.sqlsrv-execute.md) \\- Виконує запит підготовлений за допомогою sqlsrv\\_prepare\n","title":"sqlsrv\\_query","contentType":2,"navigation":[{"function.sqlsrv-prepare.md":"« sqlsrv\\_prepare"},{"function.sqlsrv-rollback.md":"sqlsrv\\_rollback »"},{"index.md":"PHP Manual"},{"ref.sqlsrv.md":"Функції SQLSRV"}]}},"__N_SSG":true}