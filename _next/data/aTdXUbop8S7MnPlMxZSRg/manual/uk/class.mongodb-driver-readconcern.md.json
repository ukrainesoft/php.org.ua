{"pageProps":{"page":{"slug":"class.mongodb-driver-readconcern.md","content":"# Клас MongoDB\\\\Driver\\\\ReadConcern\n\n(mongodb >=1.1.0)\n\n## Вступ\n\n**MongoDB\\\\Driver\\\\ReadConcern** контролює рівень ізоляції для операцій читання для наборів реплік та сегментів наборів реплік. Ця опція потребує MongoDB 3.2 або новіше.\n\n## Огляд класів\n\n```classsynopsis\n\n\n    \n    \n     final\n     \n      class MongoDB\\Driver\\ReadConcern\n     \n\n     implements \n       MongoDB\\BSON\\Serializable,  Serializable {\n    \n    /* Константы */\n    \n     const\n     string\n      AVAILABLE = \"available\";\n\n    const\n     string\n      LINEARIZABLE = \"linearizable\";\n\n    const\n     string\n      LOCAL = \"local\";\n\n    const\n     string\n      MAJORITY = \"majority\";\n\n    const\n     string\n      SNAPSHOT = \"snapshot\";\n\n\n    /* Методы */\n    \n   final public bsonSerialize(): stdClass\nfinal public __construct(?string $level = null)\nfinal public getLevel(): ?string\nfinal public isDefault(): bool\nfinal public serialize(): string\nfinal public unserialize(string $data): void\n\n   }\n```\n\n## Обумовлені константи\n\n**`MongoDB\\Driver\\ReadConcern::AVAILABLE`**\n\nЗа замовчуванням для читання проти вторинних, коли `afterClusterTime`и`level` не вказані.\n\nЗапит повертає останні дані екземпляра. Не гарантує, що дані були записані більшості членів набору реплік (тобто можуть бути відкочені).\n\nДля колекцій, що не охороняються (включаючи колекції в автономному розгортанні або розгортанні набору реплік), `\"local\"`и`\"available\"` гарантії читання поводяться однаково.\n\nДля сегментированного кластера`\"available\"` гарантії читання забезпечує більшу толерантність для розділів, оскільки вона не очікує гарантій узгодженості. Однак запит з `\"available\"` гарантіями читання може повернути втрачені документи, якщо у сегменті виконується міграція фрагментів, оскільки `\"available\"`гарантий чтения, в отличие от`\"local\"` гарантій читання, що не пов'язується з первинним сервером сегмента або серверами конфігурації для отримання оновлених метаданих.\n\n**`MongoDB\\Driver\\ReadConcern::LINEARIZABLE`**\n\nЗапит повертає дані, які відображають усі успішні записи, випущені з гарантіями запису `\"majority\"` *і* підтверджені на початок операції читання. Для наборів реплік, які виконуються з параметром `writeConcernMajorityJournalDefault`, встановленим у значення \\*\\*`true`\\*\\*лінеаризовані гарантії читання повертають дані, які ніколи не будуть відкочуватися.\n\nЯкщо для `writeConcernMajorityJournalDefault`задано значение\\*\\*`false`\\*\\*, MongoDB не буде очікувати `w: \"majority\"` записів буде стійким, перш ніж підтвердити запис. Таким чином, операції запису `\"majority\"` можуть відкочуватися у разі втрати члена набору реплік.\n\nВи можете вказати лінеаризовані гарантії читання для операцій читання лише на основному сервері.\n\nЛінеаризовані гарантії читання застосовуються лише в тому випадку, якщо в операціях читання вказано фільтр запиту, який однозначно ідентифікує один документ.\n\n**Підказка**\n\nВсегда используйте`maxTimeMS` з лінеаризованими гарантіями читання, якщо більшість елементів, що несуть дані, недоступні . `maxTimeMS` гарантує, що операція не блокується нескінченно, і натомість гарантує, що операція повертає помилку, якщо проблема читання може бути виконана.\n\nДля лінеаризованих гарантій читання потрібен MongoDB 3.4.\n\n**`MongoDB\\Driver\\ReadConcern::LOCAL`**\n\nЗа промовчанням для читання по первинному, якщо `level` не вказано, і для читання з вторинного, якщо `level` не вказано, але встановлено `afterClusterTime`\n\nЗапит повертає останні дані екземпляра. Не гарантує, що дані були записані більшості членів набору реплік (тобто можуть бути відкочені).\n\n**`MongoDB\\Driver\\ReadConcern::MAJORITY`**\n\nЗапит повертає останні дані екземпляра, які були визнані записаними більшості членів у наборі реплік.\n\nЩоб використати рівень гарантій читання `\"majority\"`, набори реплік повинні використовувати механізм зберігання WiredTiger та протокол вибору версії 1.\n\n**`MongoDB\\Driver\\ReadConcern::SNAPSHOT`**\n\nГарантія читання `\"snapshot\"` доступна для транзакцій з кількома документами, а починаючи з MongoDB 5.0, також доступна для деяких операцій читання не тільки для транзакцій з кількома документами.\n\nЯкщо транзакція не є частиною причинно-узгодженої сесії, після фіксації транзакції з проблемою запису `\"majority\"`, операції транзакції гарантовано прочитають з моментального знімку зафіксованих більшістю даних.\n\nЯкщо транзакція є частиною причинно-узгодженої сесії, при фіксації транзакції із проблемою запису `\"majority\"`, операції транзакції гарантовано зчитують з моментального знімку дані, підтверджені більшістю, що забезпечує причинну узгодженість операцій, безпосередньо попередньої початку транзакції.\n\nПоза транзакціями з кількома документами, проблема читання `\"snapshot\"` доступна на первинних та вторинних серверах для наступних операцій читання: `find` `aggregate`и`distinct` (Для необроблених колекцій). Усі інші команди читання забороняють `\"snapshot\"`\n\n## список змін\n\n| Версия | Опис |\n| --- | --- |\n| PECL mongodb 1.11.0 |  |\n| Добавлена константа\\*\\*`MongoDB\\Driver\\ReadConcern::SNAPSHOT`\\*\\* |  |\n\n| | PECL mongodb 1.7.0 | Реализует[Serializable](class.serializable.md)| | PECL mongodb 1.4.0 |\n\nДобавлена константа\\*\\*`MongoDB\\Driver\\ReadConcern::AVAILABLE`\\*\\*\n\n| | PECL mongodb 1.2.0 |\n\nДобавлена константа\\*\\*`MongoDB\\Driver\\ReadConcern::LINEARIZABLE`\\*\\*\n\nРеалізує [MongoDB\\\\BSON\\\\Serializable](class.mongodb-bson-serializable.md)\n\n## Дивіться також\n\n-   [» Довідка за гарантіями читання](https://www.mongodb.com/docs/manual/reference/read-concern/)\n\n## Зміст\n\n-   [MongoDB\\\\Driver\\\\ReadConcern::bsonSerialize](mongodb-driver-readconcern.bsonserialize.md)— Повертає об'єкт для серіалізації BSON\n-   [MongoDB\\\\Driver\\\\ReadConcern::\\_\\_construct](mongodb-driver-readconcern.construct.md) \\- Створює новий ReadConcern\n-   [MongoDB\\\\Driver\\\\ReadConcern::getLevel](mongodb-driver-readconcern.getlevel.md) - Повертає опцію \"level\" ReadConcern\n-   [MongoDB\\\\Driver\\\\ReadConcern::isDefault](mongodb-driver-readconcern.isdefault.md)— Перевіряє, чи є гарантією прочитання за умовчанням\n-   [MongoDB\\\\Driver\\\\ReadConcern::serialize](mongodb-driver-readconcern.serialize.md) \\- Серіалізація ReadConcern\n-   [MongoDB\\\\Driver\\\\ReadConcern::unserialize](mongodb-driver-readconcern.unserialize.md) \\- Десеріалізація ReadConcern\n","title":"Клас MongoDB\\\\Driver\\\\ReadConcern","contentType":2,"navigation":[{"mongodb-driver-readpreference.unserialize.md":"« MongoDB\\\\Driver\\\\ReadPreference::unserialize"},{"mongodb-driver-readconcern.bsonserialize.md":"MongoDB\\\\Driver\\\\ReadConcern::bsonSerialize »"},{"index.md":"PHP Manual"},{"book.mongodb.md":"MongoDB\\\\Driver"}]}},"__N_SSG":true}