{"pageProps":{"page":{"slug":"function.sodium-crypto-secretstream-xchacha20poly1305-init-push.md","content":"# sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push\n\n(PHP 7 >= 7.2.0, PHP 8)\n\nsodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push - Ініціалізує контекст secretstream для шифрування\n\n### Опис\n\n```methodsynopsis\nsodium_crypto_secretstream_xchacha20poly1305_init_push(string $key): array\n```\n\nІніціалізує контекст secretstream для шифрування\n\n### Список параметрів\n\n`key`\n\nКлюч криптографии. Смотрите[sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_keygen()](function.sodium-crypto-secretstream-xchacha20poly1305-keygen.md)\n\n### Значення, що повертаються\n\nМасив із двома рядковими значеннями:\n\n-   Стан secretstream, необхідний подальших дій\n-   Заголовок secretstream, який необхідно надати одержувачу, щоб він міг витягувати дані.\n\n### Приклади\n\n**Приклад #1 Приклад використання** sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push()\\*\\*\\*\\*\n\n```php\n<?php\nfunction encrypt_file(string $inputFilePath, string $outputFilePath, string $key): void\n{\n    [$state, $header] = sodium_crypto_secretstream_xchacha20poly1305_init_push($key);\n\n    $inputFile = fopen($inputFilePath, 'rb');\n    $outputFile = fopen($outputFilePath, 'wb');\n    // Запись заголовка:\n    fwrite($outputFile, $header);\n    $inputFileSize = fstat($inputFile)['size'];\n\n    // Зашифровка файла и запись его содержимого в выходной файл:\n    for ($i = 0; $i < $inputFileSize; $i += 8175) {\n        $ptxt_chunk = fread($inputFile, 8175);\n        $ctxt_chunk = sodium_crypto_secretstream_xchacha20poly1305_push($state, $ptxt_chunk);\n        fwrite($outputFile, $ctxt_chunk);\n    }\n\n    sodium_memzero($state);\n    fclose($inputFile);\n    fclose($outputFile);\n}\n\n// sodium_crypto_secretstream_xchacha20poly1305_keygen()\n$key = sodium_base642bin('MS0lzb7HC+thY6jY01pkTE/cwsQxnRq0/2L1eL4Hxn8=', SODIUM_BASE64_VARIANT_ORIGINAL);\n\nfile_put_contents('hello.txt', 'Hello world!');\nencrypt_file('hello.txt', 'hello.txt.encrypted', $key);\nvar_dump(sodium_bin2hex(file_get_contents('hello.txt.encrypted')));\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\nstring(106) \"971e33b255f0990ef3931caf761c59136efa77b434832f28ec719e3ff73f5aec38b3bba1574ab5b70a8844d8da36a668e802cfea2c\"\n```\n","title":"sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_push","contentType":2,"navigation":[{"function.sodium-crypto-secretstream-xchacha20poly1305-init-pull.md":"« sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_init\\_pull"},{"function.sodium-crypto-secretstream-xchacha20poly1305-keygen.md":"sodium\\_crypto\\_secretstream\\_xchacha20poly1305\\_keygen »"},{"index.md":"PHP Manual"},{"ref.sodium.md":"Опції Sodium"}]}},"__N_SSG":true}