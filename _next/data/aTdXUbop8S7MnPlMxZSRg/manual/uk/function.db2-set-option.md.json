{"pageProps":{"page":{"slug":"function.db2-set-option.md","content":"# db2\\_set\\_option\n\n(PECL ibm\\_db2 >= 1.0.0)\n\ndb2\\_set\\_option — Встановіть опцію для з'єднання або ресурсу оператора.\n\n### Опис\n\n```methodsynopsis\ndb2_set_option(resource $resource, array $options, int $type): bool\n```\n\nВстановіть опцію для з'єднання або ресурсу оператора. Для ресурсу результуючого набору опції не можна задавати.\n\n### Список параметрів\n\n`resource`\n\nКоректний ресурс оператора, отриманий з [db2\\_prepare()](function.db2-prepare.md) або ж ресурс з'єднання, отриманий з [db2\\_connect()](function.db2-connect.md) або [db2\\_pconnect()](function.db2-pconnect.md)\n\n`options`\n\nАсоціативний масив, що містить опції, що відповідають ресурсу. Цей параметр можна використовувати для зміни режиму автопідтвердження транзакцій, типу курсору та завдання регістра імен стовпців (нижній, верхній, як є) у результуючому наборі.\n\n`autocommit`\n\n`DB2_AUTOCOMMIT_ON`\\- включить режим автоподтверждения транзакций для заданного соединения.\n\n`DB2_AUTOCOMMIT_OFF`\\- отключить режим автоподтверждения транзакций для заданного соединения.\n\n`cursor`\n\n`DB2_FORWARD_ONLY` - Задати тип курсору \"тільки вперед\". Це тип за промовчанням і він підтримується всіма базами даних.\n\n`DB2_SCROLLABLE` - задати тип курсору як \"перемотується\". Даний тип курсору дозволяє отримувати доступ до довільних рядків результуючого набору та доступний лише для IBM DB2 Universal Database.\n\n`binmode`\n\n`DB2_BINARY` - Визначає, що бінарні дані будуть повернуті як є. Це режим за промовчанням, він рівносильний завданню `ibm_db2.binmode=1`в php.ini.\n\n`DB2_CONVERT` - Визначає, що бінарні дані будуть сконвертовані в шістнадцяткове подання. Рівносильно завдання `ibm_db2.binmode=2`в php.ini.\n\n`DB2_CONVERT` - визначає, що бінарні дані будуть сконвертовані в **`null`**. Рівносильно завдання `ibm_db2.binmode=3`в php.ini.\n\n`db2_attr_case`\n\n`DB2_CASE_LOWER` - Визначає, що імена стовпців будуть повернуті в нижньому регістрі.\n\n`DB2_CASE_UPPER` - Визначає, що імена стовпців будуть повернуті у верхньому регістрі.\n\n`DB2_CASE_NATURAL` - Визначає, що імена стовпців будуть повернуті як є.\n\n`deferred_prepare`\n\n`DB2_DEFERRED_PREPARE_ON` - Включає відкладену підготовку ресурсу оператора.\n\n`DB2_DEFERRED_PREPARE_OFF` - Вимикає відстрочену підготовку ресурсу оператора.\n\nНаступні нові опції i5/OS доступні в ibm\\_db2 версії 1.5.1 та вище. Ці опції доступні лише якщо PHP та ibm\\_db2 запущено на системі i5.\n\n`i5_fetch_only`\n\n`DB2_I5_FETCH_ON` - курсори можуть бути тільки для читання і не можуть використовуватися для позиціонування DELETE або UPDATE. Є поведінкою за умовчанням, тільки якщо змінна оточення `SQL_ATTR_FOR_FETCH_ONLY`не установлена в`SQL_FALSE`\n\n`DB2_I5_FETCH_OFF` - курсори можна використовувати для позиціонування DELETE або UPDATE.\n\nНаступні нові опції доступні в ibm\\_db2 версії 1.8.0 та вище.\n\n`rowcount`\n\n`DB2_ROWCOUNT_PREFETCH_ON` - клієнт може запитати кількість рядків перед вилученням, що означає, що функція [db2\\_num\\_rows()](function.db2-num-rows.md) поверне кількість вибраних рядків, навіть якщо використовується курсор `ROLLFORWARD_ONLY`\n\n`DB2_ROWCOUNT_PREFETCH_OFF` - клієнт не може запитати кількість рядків перед вилученням\n\nНаступні нові опції доступні в ibm\\_db2 версії 1.7.0 та вище.\n\n`trusted_user`\n\nЩоб перевести користувача до статусу довіреного користувача, вкажіть ідентифікатор (рядок) довіреного користувача як значення цього параметра. Ця опція може бути задана лише ресурсу з'єднання. Для використання цієї опції необхідно, щоб з'єднання було дозволено довірений контекст.\n\n`trusted_password`\n\nПароль (рядок), що відповідає ідентифікатору користувача, заданому в trusted\\_user.\n\nНаступні нові опції доступні в ibm\\_db2 версії 1.6.0 та вище. Ці опції надають корисну інформацію, яку можна отримати через [db2\\_get\\_option()](function.db2-get-option.md)\n\n> **Зауваження** :\n> \n> Якщо значення кожної опції встановлено, деякі сервери можуть не зуміти обробити всі значення та обріжуть його.\n> \n> Для впевненості в тому, що всі опції конвертовані коректно під час передачі на хост, використовуйте лише символи A-Z, 0-9, підкреслення(\\_) та точку (.).\n\n`userid`\n\n`SQL_ATTR_INFO_USERID` - покажчик на символьний рядок, що закінчується null-байтом і містить ідентифікатор користувача, переданий базі при з'єднанні.\n\n> **Зауваження** :\n> \n> DB2 для серверів z/OS та OS/390 підтримує довжину до 16 символів. Ідентифікатор користувача не скомпрометує ідентифікатор авторизації – це різні сутності.\n\n`acctstr`\n\n`SQL_ATTR_INFO_ACCTSTR` - покажчик на символьний рядок, що закінчується null-байтом і використовується для ідентифікації облікового рядка клієнта, відповідного надісланого сервера при з'єднанні.\n\n> **Зауваження** :\n> \n> DB2 для серверів z/OS та OS/390 підтримує довжину до 200 символів.\n\n`applname`\n\n`SQL_ATTR_INFO_APPLNAME` - вказівник на символьний рядок, що закінчується null-байтом і використовується для ідентифікації імені клієнтської програми, відповідної надісланої на сервер під час з'єднання.\n\n> **Зауваження** :\n> \n> DB2 для серверів z/OS та OS/390 підтримує довжину до 32 символів.\n\n`wrkstnname`\n\n`SQL_ATTR_INFO_WRKSTNNAME` - вказівник на символьний рядок, що закінчується null-байтом і використовується для ідентифікації імені робочої станції, відповідної надісланої на сервер при з'єднанні.\n\n> **Зауваження** :\n> \n> DB2 для серверів z/OS та OS/390 підтримує довжину до 18 символів.\n\n`type`\n\nЦілочисленне значення, що визначає тип ресурсу, який було передано у функцію.\n\n\\- передан ресурс соединения.\n\nЛюбое другое значение, отличное от означає ресурс оператора.\n\nНаступна таблиця показує, які параметри сумісні з ресурсами:\n\n**Матриця ресурс/параметр**\n\n| Ключ | Значение | Тип ресурса |\n| --- | --- | --- |\n|  |  | З'єднання |\n| autocommit | `DB2_AUTOCOMMIT_ON` | X |\n| autocommit | `DB2_AUTOCOMMIT_OFF` | X |\n| cursor | `DB2_SCROLLABLE` | \\- |\n| cursor | `DB2_FORWARD_ONLY` | \\- |\n| binmode | `DB2_BINARY` | X |\n| binmode | `DB2_CONVERT` | X |\n| binmode | `DB2_PASSTHRU` | X |\n| db2\\_attr\\_case | `DB2_CASE_LOWER` | X |\n| db2\\_attr\\_case | `DB2_CASE_UPPER` | X |\n| db2\\_attr\\_case | `DB2_CASE_NATURAL` | X |\n| deferred\\_prepare | `DB2_DEFERRED_PREPARE_ON` | \\- |\n| deferred\\_prepare | `DB2_DEFERRED_PREPARE_OFF` | \\- |\n| i5\\_fetch\\_only | `DB2_I5_FETCH_ON` | \\- |\n| i5\\_fetch\\_only | `DB2_I5_FETCH_OFF` | \\- |\n| rowcount | `DB2_ROWCOUNT_PREFETCH_ON` | \\- |\n| rowcount | `DB2_ROWCOUNT_PREFETCH_OFF` | \\- |\n| trusted\\_user | `<USER NAME> (String)` | X |\n| trusted\\_password | `<PASSWORD> (String)` | X |\n| userid | `SQL_ATTR_INFO_USERID` | X |\n| acctstr | `SQL_ATTR_INFO_ACCTSTR` | X |\n| applname | `SQL_ATTR_INFO_APPLNAME` | X |\n| wrkstnname | `SQL_ATTR_INFO_WRKSTNNAME` | X |\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Встановлення одного параметра для ресурсу з'єднання**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_ON);\n\n/* Вызываем функцию */\n$result = db2_set_option($conn, $options, 1);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nOptions Set Successfully\n```\n\n**Приклад #2 Встановлення кількох параметрів для ресурсу з'єднання**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_OFF,\n                    'binmode' => DB2_PASSTHRU,\n              'db2_attr_case' => DB2_CASE_UPPER,\n                     'cursor' => DB2_SCROLLABLE);\n\n/* Вызываем функцию */\n$result = db2_set_option($conn, $options, 1);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nOptions Set Successfully\n```\n\n**Приклад #3 Встановлення кількох параметрів з одним неправильним ключем**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_OFF,\n             'MY_INVALID_KEY' => DB2_PASSTHRU,\n              'db2_attr_case' => DB2_CASE_UPPER,\n                     'cursor' => DB2_SCROLLABLE);\n\n/* Вызываем функцию */\n$result = db2_set_option($conn, $options, 1);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nCould Not Set Options\n```\n\n**Приклад #4 Встановлення кількох параметрів з одним неправильним значенням**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_OFF,\n                    'binmode' => 'INVALID_VALUE',\n              'db2_attr_case' => DB2_CASE_UPPER,\n                     'cursor' => DB2_SCROLLABLE);\n\n/* Вызываем функцию */\n$result = db2_set_option($conn, $options, 1);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nCould Not Set Options\n```\n\n**Приклад #5 Setting multiple parameters with connection resource and the wrong type**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_OFF,\n                    'binmode' => DB2_PASSTHRU,\n              'db2_attr_case' => DB2_CASE_UPPER,\n                     'cursor' => DB2_SCROLLABLE);\n\n/* Вызываем функцию */\n$result = db2_set_option($conn, $options, 2);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nCould Not Set Options\n```\n\n**Приклад #6 Setting multiple parameters with the wrong resource**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('autocommit' => DB2_AUTOCOMMIT_OFF,\n                    'binmode' => DB2_PASSTHRU,\n              'db2_attr_case' => DB2_CASE_UPPER,\n                     'cursor' => DB2_SCROLLABLE);\n\n$stmt = db2_prepare($conn, 'SELECT * FROM EMPLOYEE');\n\n/* Вызываем функцию */\n$result = db2_set_option($stmt, $options, 1);\n\n/* Проверяем, все ли опции установились */\nif($result)\n{\n  echo 'Options Set Successfully';\n}\nelse\n{\n  echo 'Could Not Set Options';\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nCould Not Set Options\n```\n\n**Приклад #7 Putting it all together**\n\n```php\n<?php\n/* Параметры соединения с базой данных */\n$database = 'SAMPLE';\n$hostname = 'localhost';\n$port = 50000;\n$protocol = 'TCPIP';\n$username = 'db2inst1';\n$password = 'ibmdb2';\n\n/* Строка соединения */\n$conn_string = \"DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;\";\n$conn_string .= \"HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;\";\n$conn_string .= \"UID=$username;PWD=$password;\";\n\n/* Получаем ресурс соединения */\n$conn = db2_connect($conn_string, '', '');\n\n/* Создаём ассоциативный массив опций */\n$options = array('db2_attr_case' => DB2_CASE_LOWER,\n                        'cursor' => DB2_SCROLLABLE);\n\n$stmt = db2_prepare($conn, 'SELECT * FROM EMPLOYEE WHERE EMPNO = ? OR EMPNO = ?');\n\n/* Вызываем функцию */\n$option_result = db2_set_option($stmt, $options, 2);\n$result = db2_execute($stmt, array('000130', '000140'));\n\n/* Получаем строку 2 перед строкой 1. Перематываемый курсор! */\nprint_r(db2_fetch_assoc($stmt, 2));\nprint '<br /><br />';\nprint_r(db2_fetch_assoc($stmt, 1));\n\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nArray\n(\n    [empno] => 000140\n    [firstnme] => HEATHER\n    [midinit] => A\n    [lastname] => NICHOLLS\n    [workdept] => C01\n    [phoneno] => 1793\n    [hiredate] => 1976-12-15\n    [job] => ANALYST\n    [edlevel] => 18\n    [sex] => F\n    [birthdate] => 1946-01-19\n    [salary] => 28420.00\n    [bonus] => 600.00\n    [comm] => 2274.00\n)\n\nArray\n(\n    [empno] => 000130\n    [firstnme] => DELORES\n    [midinit] => M\n    [lastname] => QUINTANA\n    [workdept] => C01\n    [phoneno] => 4578\n    [hiredate] => 1971-07-28\n    [job] => ANALYST\n    [edlevel] => 16\n    [sex] => F\n    [birthdate] => 1925-09-15\n    [salary] => 23800.00\n    [bonus] => 500.00\n    [comm] => 1904.00\n)\n```\n\n**Приклад #8 Курсор i5/OS тільки для читання**\n\n```php\n<?php\n  $conn = db2_connect(\"\", \"\", \"\", array(\"i5_lib\"=>\"nobody\"));\n  $stmt = db2_prepare($conn, 'select * from names where first = ?');\n  $name = \"first2\";\n  db2_bind_param($stmt, 1, \"name\", DB2_PARAM_IN);\n  $options = array(\"i5_fetch_only\"=>DB2_I5_FETCH_ON);\n  db2_set_option($stmt,$options,0);\n  if (db2_execute($stmt)) {\n    while ($row = db2_fetch_array($stmt)) {\n      echo \"{$row[0]} {$row[1]}\";\n    }\n  }\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nfirst2 last2\n```\n\n### Дивіться також\n\n-   [db2\\_connect()](function.db2-connect.md) \\- Повертає з'єднання з базою даних\n-   [db2\\_pconnect()](function.db2-pconnect.md) \\- Повертає постійне з'єднання з базою даних\n-   [db2\\_exec()](function.db2-exec.md) \\- Виконує SQL-запит безпосередньо\n-   [db2\\_prepare()](function.db2-prepare.md) \\- готує SQL-запит до виконання\n-   [db2\\_cursor\\_type()](function.db2-cursor-type.md) \\- Повертає тип курсору, який використовується у ресурсі оператора\n","title":"db2\\_set\\_option","contentType":2,"navigation":[{"function.db2-server-info.md":"« db2\\_server\\_info"},{"function.db2-special-columns.md":"db2\\_special\\_columns »"},{"index.md":"PHP Manual"},{"ref.ibm-db2.md":"Функції IBM DB2"}]}},"__N_SSG":true}