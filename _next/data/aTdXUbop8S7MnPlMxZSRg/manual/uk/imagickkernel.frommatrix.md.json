{"pageProps":{"page":{"slug":"imagickkernel.frommatrix.md","content":"# ImagickKernel::fromMatrix\n\n(PECL imagick >= 3.3.0)\n\nImagickKernel::fromMatrix — Створює ядро ​​з двовимірної матриці значень\n\n### Опис\n\n```methodsynopsis\npublic static ImagickKernel::fromMatrix(array $matrix, array $origin = ?): ImagickKernel\n```\n\nСтворює ядро ​​двомерної матриці значень. Кожне значення має бути або числом з плаваючою комою (якщо елемент повинен використовуватися), або з false, якщо елемент слід пропустити. Для матриць непарних розмірів в обох вимірах вихідним пікселем за промовчанням буде центр ядра. Для інших розмірів ядра необхідно вказати вихідний піксель.\n\n### Список параметрів\n\n`array`\n\nМатриця (тобто двовимірний масив) значень, що визначають ядро. Кожен елемент повинен бути або числом з плаваючою комою або значенням FALSE, якщо цей елемент не повинен використовуватися ядром.\n\n`array`\n\nЯкий елемент ядра слід використовувати як вихідний піксель. Наприклад, для матриці 3x3, що визначає початок координат як \\[2, 2\\], буде вказано, що нижній правий елемент має бути вихідним пікселем.\n\n### Значення, що повертаються\n\nСтворений ImagickKernel.\n\n### Приклади\n\n**Приклад #1 Приклад використання** ImagickKernel::fromMatrix()\\*\\*\\*\\*\n\n```php\n<?php\n\nfunction renderKernel(ImagickKernel $imagickKernel) {\n    $matrix = $imagickKernel->getMatrix();\n\n    $imageMargin = 20;\n\n    $tileSize = 20;\n    $tileSpace = 4;\n    $shadowSigma = 4;\n    $shadowDropX = 20;\n    $shadowDropY = 0;\n\n    $radius = ($tileSize / 2) * 0.9;\n\n    $rows = count($matrix);\n    $columns = count($matrix[0]);\n\n    $imagickDraw = new \\ImagickDraw();\n\n    $imagickDraw->setFillColor('#afafaf');\n    $imagickDraw->setStrokeColor('none');\n\n    $imagickDraw->translate($imageMargin, $imageMargin);\n    $imagickDraw->push();\n\n    ksort($matrix);\n\n    foreach ($matrix as $row) {\n        ksort($row);\n        $imagickDraw->push();\n        foreach ($row as $cell) {\n            if ($cell !== false) {\n                $color = intval(255 * $cell);\n                $colorString = sprintf(\"rgb(%f, %f, %f)\", $color, $color, $color);\n                $imagickDraw->setFillColor($colorString);\n                $imagickDraw->rectangle(0, 0, $tileSize, $tileSize);\n            }\n            $imagickDraw->translate(($tileSize + $tileSpace), 0);\n        }\n        $imagickDraw->pop();\n        $imagickDraw->translate(0, ($tileSize + $tileSpace));\n    }\n\n    $imagickDraw->pop();\n\n    $width = ($columns * $tileSize) + (($columns - 1) * $tileSpace);\n    $height = ($rows * $tileSize) + (($rows - 1) * $tileSpace);\n\n    $imagickDraw->push();\n    $imagickDraw->translate($width/2 , $height/2);\n    $imagickDraw->setFillColor('rgba(0, 0, 0, 0)');\n    $imagickDraw->setStrokeColor('white');\n    $imagickDraw->circle(0, 0, $radius - 1, 0);\n    $imagickDraw->setStrokeColor('black');\n    $imagickDraw->circle(0, 0, $radius, 0);\n    $imagickDraw->pop();\n\n    $canvasWidth = $width + (2 * $imageMargin);\n    $canvasHeight = $height + (2 * $imageMargin);\n\n    $kernel = new \\Imagick();\n    $kernel->newPseudoImage(\n        $canvasWidth,\n        $canvasHeight,\n        'canvas:none'\n    );\n\n    $kernel->setImageFormat('png');\n    $kernel->drawImage($imagickDraw);\n\n    /* создание тени на собственном слое */\n    $canvas = $kernel->clone();\n    $canvas->setImageBackgroundColor(new \\ImagickPixel('rgb(0, 0, 0)'));\n    $canvas->shadowImage(100, $shadowSigma, $shadowDropX, $shadowDropY);\n\n    $canvas->setImagePage($canvasWidth, $canvasHeight, -5, -5);\n    $canvas->cropImage($canvasWidth, $canvasHeight, 0, 0);\n\n    /* накладывает исходный text_layer на shadow_layer */\n    $canvas->compositeImage($kernel, \\Imagick::COMPOSITE_OVER, 0, 0);\n    $canvas->setImageFormat('png');\n\n    return $canvas;\n}\n\nfunction createFromMatrix() {\n    $matrix = [\n        [0.5, 0, 0.2],\n        [0, 1, 0],\n        [0.9, 0, false],\n    ];\n\n    $kernel = \\ImagickKernel::fromMatrix($matrix);\n\n    return $kernel;\n}\n\nfunction fromMatrix() {\n    $kernel = createFromMatrix();\n    $imagick = renderKernel($kernel);\n\n    header(\"Content-Type: image/png\");\n    echo $imagick->getImageBlob();\n}\n\n?>\n```\n","title":"ImagickKernel::fromMatrix","contentType":2,"navigation":[{"imagickkernel.frombuiltin.md":"« ImagickKernel::fromBuiltIn"},{"imagickkernel.getmatrix.md":"ImagickKernel::getMatrix »"},{"index.md":"PHP Manual"},{"class.imagickkernel.md":"ImagickKernel"}]}},"__N_SSG":true}