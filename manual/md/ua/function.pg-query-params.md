- [« pg_put_line](function.pg-put-line.md)
- [pg_query »](function.pg-query.md)

- [PHP Manual](index.md)
- [Функції PostgreSQL](ref.pgsql.md)
- Надсилає параметризований запит на сервер, параметри передаються
окремо від тексту SQL запиту

#pg_query_params

(PHP 5 \>u003d 5.1.0, PHP 7, PHP 8)

pg_query_params — Надсилає параметризований запит на сервер, параметри
передаються окремо від тексту SQL запиту

### Опис

**pg_query_params**([PgSql\Connection](class.pgsql-connection.md)
`$connection` u003d ?, string `$query`, array `$params`):
[PgSql\Result](class.pgsql-result.md)\|false

Посилає параметризований запит на сервер і чекає на результат. Параметри
передаються окремо від рядка запиту.

**pg_query_params()** подібна до функції
[pg_query()](function.pg-query.md), але надає додатковий
функціонал: параметри запиту можна передавати окремо від рядка
запиту. **pg_query_params()** підтримується на з'єднаннях із серверами
PostgreSQL версій 7.4 та вище. Функція не працюватиме з серверами
ранніх версій.

Якщо використовуються параметри `params`, вони замінюють псевдозмінні $1,
$2 і т.д. у рядку запиту `query`. Один і той самий параметр може бути
вказано більше одного разу в `query`; у цьому випадку будуть використані
однакові значення. `params` визначають поточні значення параметрів.
Значення **`null`** у масиві параметрів означатиме SQL `NULL` в
запит.

Головна перевага **pg_query_params()** перед
[pg_query()](function.pg-query.md) полягає в тому, що значення
параметри можуть передаватися окремо від рядка запиту `query`. Це
дає можливість уникнути стомлюючу і схильну до помилок процедуру
екранування спецсимволів та укладання значень у лапки. Однак, у
на відміну від [pg_query()](function.pg-query.md), ця функція
підтримує тільки один SQL запит у рядку, що передається. (Він може
містити крапку з комою, але не більше однієї непустої SQL-команди.)

### Список параметрів

`connection`
Примірник [PgSql\Connection](class.pgsql-connection.md). Якщо
`connection` не вказано, використовується стандартне з'єднання.
З'єднання за замовчуванням - це останнє з'єднання, виконане з
за допомогою функцій [pg_connect()](function.pg-connect.md) або
[pg_pconnect()](function.pg-pconnect.md).

**Увага**
Починаючи з версії PHP 8.1.0, використання стандартного з'єднання
застаріло.

`query`
Параметризований запит SQL. Повинен містити лише один вираз
(кілька виразів розділених крапкою з комою не підтримуються).
Якщо на запит будуть передаватися параметри, вони замінять
псевдозмінні $1, $2 і т.д.

Ці дані завжди повинні передаватися як параметри, і не
передаватися в рядок запиту безпосередньо, де вони можуть призвести до
можливим атакам через
[SQL-ін'єкції](security.database.sql-injection.md) і призводить до
помилок, якщо дані містять лапки. Якщо з якихось причин ви не
можете використовувати параметр, переконайтеся, що дані користувача
[правильно екрановані](function.pg-escape-string.md).

`params`
Масив значень параметрів запиту для заміни псевдозмінних $1, $2 та
і т.д. у вихідному рядку запиту. Кількість елементів масиву має
точно співпадати з кількістю псевдозмінних.

Значення призначені для `bytea` полів не можна передавати в
параметри. Використовуйте функцію
[pg_escape_bytea()](function.pg-escape-bytea.md) або функції для
великих об'єктів.

### Значення, що повертаються

Примірник [PgSql\Result](class.pgsql-result.md) у разі успішного
виконання або **`false`** у разі виникнення помилки.

### Список змін

| Версія | Опис |
|--------|---------------------------------------- -------------------------------------------------- -------------------------------------------------- -----------------------|
| 8.1.0 | Повертає екземпляр [PgSql\Result](class.pgsql-result.md); раніше повертався ресурс ([resource](language.types.resource.md)). |
| 8.1.0 | Параметр `connection` тепер чекає на екземпляр [PgSql\Connection](class.pgsql-connection.md); раніше очікувався ресурс ([resource](language.types.resource.md)). |

### Приклади

**Приклад #1 Приклад використання **pg_query_params()****

`<?php// Підключення до базі даних "mary"$dbconn u003d pg_connect("dbnameu003dmary");// Знайдемо все магазини з назвою "Joe's Widgets". Стоит отметить, что нет необходимости экранировать// спецсимволы в строке "Joe's Widgets"$result u003d pg_query_params($dbconn, 'SELECT * FROM shops WHERE name u003d $1', array("Joe's Widgets"));// Для сравнения то же саме, використовуючи функцію pg_query$str u003d pg_escape_string("Joe's Widgets");$result u003d pg_query($dbconn, "SELECT * FROM shops WHERE name > 

### Дивіться також

- [pg_query()](function.pg-query.md) - Виконує запит
