{"pageProps":{"page":{"slug":"function.openssl-pkcs7-sign.md","content":"# openssl\\_pkcs7\\_sign\n\n(PHP 4 >= 4.0.6, PHP 5, PHP 7, PHP 8)\n\nopenssl\\_pkcs7\\_sign — Підписати повідомлення S/MIME\n\n### Опис\n\n```methodsynopsis\nopenssl_pkcs7_sign(    string $input_filename,    string $output_filename,    OpenSSLCertificate|string $certificate,    OpenSSLAsymmetricKey|OpenSSLCertificate|array|string $private_key,    ?array $headers,    int $flags = PKCS7_DETACHED,    ?string $untrusted_certificates_filename = null): bool\n```\n\n**openssl\\_pkcs7\\_sign()** бере вміст файлу `input_filename` та підписує його з використанням сертифіката `certificate` та закритого ключа `private_key`\n\n### Список параметрів\n\n`input_filename`\n\nФайл, який слід підписати.\n\n`output_filename`\n\nФайл, до якого буде записано цифровий підпис.\n\n`certificate`\n\nСертифікат X.509, який буде використаний для підпису `input_filename`Смотрите[параметри ключа/сертифіката](openssl.certparams.md)\n\n`private_key`\n\n`private_key` задається секретним ключем, що відповідає сертифікату (`certificate`). Смотрите[параметри відкритого/секретного ключа](openssl.certparams.md)\n\n`headers`\n\n`headers` задається масивом заголовків, які будуть додані на початок даних після підписання. (дивіться [openssl\\_pkcs7\\_encrypt()](function.openssl-pkcs7-encrypt.md) для отримання додаткової інформації про формат цього параметра).\n\n`flags`\n\n`flags` використовується для налаштування виводу. Дивіться [константи PKCS7](openssl.pkcs7.flags.md)\n\n`untrusted_certificates_filename`\n\n`untrusted_certificates_filename` може містити ім'я файлу, де зберігаються додаткові сертифікати для додавання їх до підпису, наприклад, для полегшення верифікації підпису різними користувачами.\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### список змін\n\n| Версия | Опис |\n| --- | --- |\n| 8.0.0 | `certificate` тепер приймає екземпляр [OpenSSLCertificate](class.opensslcertificate.md); раніше приймався ресурс ([resource](language.types.resource.md)) типу`OpenSSL X.509 CSR` |\n| 8.0.0 | `private_key` тепер приймає екземпляр [OpenSSLAsymmetricKey](class.opensslasymmetrickey.md) або [OpenSSLCertificate](class.opensslcertificate.md); раніше приймався ресурс ([resource](language.types.resource.md)) типу`OpenSSL key`or`OpenSSL X.509 CSR` |\n\n### Приклади\n\n**Приклад #1 Приклад використання** openssl\\_pkcs7\\_sign()\\*\\*\\*\\*\n\n```php\n<?php\n// сообщение, которое вы хотите подписать для того, чтобы получатели могли\n// проверить, что его послали именно вы\n$data = <<<EOD\n\nРазрешаю потратить на обед с контрагентом не более 100,000 рублей.\n\nВаш директор.\nEOD;\n// сохраняем сообщение в фалй\n$fp = fopen(\"msg.txt\", \"w\");\nfwrite($fp, $data);\nfclose($fp);\n// шифруем\nif (openssl_pkcs7_sign(\"msg.txt\", \"signed.txt\", \"file://mycert.pem\",\n    array(\"file://mycert.pem\", \"mypassphrase\"),\n    array(\"To\" => \"joes@example.com\", // ассоциативный синтаксис\n          \"From: HQ <ceo@example.com>\", // индексированный синтаксис\n          \"Subject\" => \"Представительские расходы\")\n    )) {\n    // сообщение подписано - отправляем!\n    exec(ini_get(\"sendmail_path\") . \" < signed.txt\");\n}\n?>\n```\n","title":"openssl\\_pkcs7\\_sign","contentType":2,"navigation":[{"function.openssl-pkcs7-read.md":"« openssl\\_pkcs7\\_read"},{"function.openssl-pkcs7-verify.md":"openssl\\_pkcs7\\_verify »"},{"index.md":"PHP Manual"},{"ref.openssl.md":"Функції OpenSSL"}]}},"__N_SSG":true}