{"pageProps":{"page":{"slug":"function.sqlsrv-rows-affected.md","content":"# sqlsrv\\_rows\\_affected\n\n(No version information available, might only be in Git)\n\nsqlsrv\\_rows\\_affected — Повертає кількість рядків, змінених останнім запитом INSERT, UPDATE або DELETE\n\n### Опис\n\n```methodsynopsis\nsqlsrv_rows_affected(resource $stmt): int|false\n```\n\nПовертає кількість рядків, змінених останнім запитом INSERT, UPDATE або DELETE. Для отримання інформації про кількість рядків, які повертаються запитом SELECT, дивіться [sqlsrv\\_num\\_rows()](function.sqlsrv-num-rows.md)\n\n### Список параметрів\n\n`stmt`\n\nРесурс виконаного виразу, для якого повертається кількість порушених рядків.\n\n### Значення, що повертаються\n\nПовертає кількість рядків, які торкнулися останнім запитом INSERT, UPDATE або DELETE. Якщо жодних рядків не було порушено, повертається 0. Якщо кількість порушених рядків не може бути визначена, повертається -1. У разі виникнення помилки повертається **`false`**\n\n### Приклади\n\n**Приклад #1 Приклад використання** sqlsrv\\_rows\\_affected()\\*\\*\\*\\*\n\n```php\n<?php\n$serverName = \"serverName\\sqlexpress\";\n$connectionInfo = array( \"Database\"=>\"dbName\", \"UID\"=>\"username\", \"PWD\"=>\"password\" );\n$conn = sqlsrv_connect( $serverName, $connectionInfo);\nif( $conn === false ) {\n     die( print_r( sqlsrv_errors(), true));\n}\n\n$sql = \"UPDATE Table_1 SET data = ? WHERE id = ?\";\n\n$params = array(\"updated data\", 1);\n\n$stmt = sqlsrv_query( $conn, $sql, $params);\n\n$rows_affected = sqlsrv_rows_affected( $stmt);\nif( $rows_affected === false) {\n     die( print_r( sqlsrv_errors(), true));\n} elseif( $rows_affected == -1) {\n      echo \"Нет доступной информации.<br />\";\n} else {\n      echo $rows_affected.\" строк было обновлено.<br />\";\n}\n?>\n```\n\n### Дивіться також\n\n-   [sqlsrv\\_num\\_rows()](function.sqlsrv-num-rows.md) \\- Отримує кількість рядків у наборі результатів\n","title":"sqlsrv\\_rows\\_affected","contentType":2,"navigation":[{"function.sqlsrv-rollback.md":"« sqlsrv\\_rollback"},{"function.sqlsrv-send-stream-data.md":"sqlsrv\\_send\\_stream\\_data »"},{"index.md":"PHP Manual"},{"ref.sqlsrv.md":"Функції SQLSRV"}]}},"__N_SSG":true}