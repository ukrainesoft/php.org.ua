{"pageProps":{"page":{"slug":"function.mcrypt-encrypt.md","content":"# mcrypt\\_encrypt\n\n(PHP 4 >= 4.0.2, PHP 5, PHP 7 < 7.2.0, PECL mcrypt >= 1.0.0)\n\nmcrypt\\_encrypt — Шифрує текст із заданими параметрами\n\n**Увага**\n\nЦя функція оголошена *застарілої* починаючи з PHP 7.1.0 і була *ВИДАЛЕНО* у версії PHP 7.2.0. Використовувати цю функцію не рекомендується.\n\n### Опис\n\n```methodsynopsis\nmcrypt_encrypt(    string $cipher,    string $key,    string $data,    string $mode,    string $iv = ?): string|false\n```\n\nШифрує дані.\n\n### Список параметрів\n\n`cipher`\n\nОдна из констант\\*\\*`MCRYPT_ciphername`\\*\\*или название алгоритма в виде строки.\n\n`key`\n\nКлюч, з яким шифруватимуться дані. Якщо довжина ключа не відповідає вимогам шифру, то буде повернуто **`false`** та видано попередження.\n\n`data`\n\nДані, які будуть зашифровані за допомогою шифру `cipher`и режима`mode`. . Якщо розмір даних не кратний розміру блоку, вони будуть доповнені символами '`\\0`'.\n\nРозмір тексту, що повертається, може бути більше розміру вихідних даних `data`\n\n`mode`\n\nОдна из констант\\*\\*`MCRYPT_MODE_modename`\\*\\*, або один з наступних рядків: \"ecb\", \"cbc\", \"cfb\", \"ofb\", \"nofb\" та \"stream\".\n\n`iv`\n\nВказують для ініціалізації в режимах CBC, CFB, OFB, а також деяких алгоритмах в режимі STREAM. Якщо переданий IV розмір не підтримується режимом зчеплення або IV не був переданий, а режим зчеплення його вимагає, функція згенерує попередження про помилку та поверне **`false`**\n\n### Значення, що повертаються\n\nПовертає рядок із зашифрованими даними або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад використання** mcrypt\\_encrypt()\\*\\*\\*\\*\n\n```php\n<?php\n    # --- ШИФРОВАНИЕ ---\n\n    # ключ должен представлять собой случайную бинарную строку.\n    # Для преобразовангия строки в ключ используйте scrypt, bcrypt или PBKDF2\n    # Ключ задаётся в виде строки шестнадцатеричных чисел\n    $key = pack('H*', \"bcb04b7e103a0cd8b54763051cef08bc55abe029fdebae5e1d417e2ffb2a00a3\");\n\n    # Показываем длину ключа.\n    # Длина ключа должна быть 16, 24 или 32 байт для AES-128, 192 и 256 соответственно\n    $key_size =  strlen($key);\n    echo \"Длина ключа: \" . $key_size . \"\\n\";\n\n    $plaintext = \"This string was AES-256 / CBC / ZeroBytePadding encrypted.\";\n\n    # Создаём случайный инициализирующий вектор используя режим CBC\n    $iv_size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC);\n    $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND);\n\n    # Создаём шифрованный текст совместимыс с AES (размер блока = 128)\n    # Подходит только для строк не заканчивающихся на 00h\n    # (потому как это символ дополнения по умолчанию)\n    $ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key,\n                                 $plaintext, MCRYPT_MODE_CBC, $iv);\n\n    # Добавляем инициализирующий вектор в начало, чтобы он был доступен для расшифровки\n    $ciphertext = $iv . $ciphertext;\n\n    # перекодируем зашифрованный текст в base64\n    $ciphertext_base64 = base64_encode($ciphertext);\n\n    echo  $ciphertext_base64 . \"\\n\";\n\n    # === ВНИМАНИЕ ===\n\n    # Результирующий шифрованный текст не имеет целостности или аутентичности и не\n    # защищён от атак padding oracle.\n\n    # --- ДЕШИФРОВКА ---\n\n    $ciphertext_dec = base64_decode($ciphertext_base64);\n\n    # Извлекаем инициализирующий вектор. Длина вектора ($iv_size) должна совпадать\n    # с тем, что возвращает функция mcrypt_get_iv_size()\n    $iv_dec = substr($ciphertext_dec, 0, $iv_size);\n\n    # Извлекаем зашифрованный текст\n    $ciphertext_dec = substr($ciphertext_dec, $iv_size);\n\n    # Отбрасываем завершающие символы 00h\n    $plaintext_dec = mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $key,\n                                    $ciphertext_dec, MCRYPT_MODE_CBC, $iv_dec);\n\n    echo  $plaintext_dec . \"\\n\";\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\nДлина ключа: 32\nENJW8mS2KaJoNB5E5CoSAAu0xARgsR1bdzFWpEn+poYw45q+73az5kYi4j+0haevext1dGrcW8Qi59txfCBV8BBj3bzRP3dFCp3CPQSJ8eU=\nThis string was AES-256 / CBC / ZeroBytePadding encrypted.\n```\n\n### Дивіться також\n\n-   [mcrypt\\_decrypt()](function.mcrypt-decrypt.md) \\- Розшифровує дані із заданими параметрами\n-   [mcrypt\\_module\\_open()](function.mcrypt-module-open.md) \\- Відкриває модуль шифрування з використанням вказаних алгоритму та режиму\n","title":"mcrypt\\_encrypt","contentType":2,"navigation":[{"function.mcrypt-enc-self-test.md":"« mcrypt\\_enc\\_self\\_test"},{"function.mcrypt-generic-deinit.md":"mcrypt\\_generic\\_deinit »"},{"index.md":"PHP Manual"},{"ref.mcrypt.md":"Mcrypt"}]}},"__N_SSG":true}