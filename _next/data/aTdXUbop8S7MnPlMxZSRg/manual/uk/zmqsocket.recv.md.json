{"pageProps":{"page":{"slug":"zmqsocket.recv.md","content":"# ZMQSocket::recv\n\n(PECL zmq >= 0.5.0)\n\nZMQSocket::recv — Отримати повідомлення\n\n### Опис\n\n```methodsynopsis\npublic ZMQSocket::recv(int $mode = 0): string\n```\n\nОтримує повідомлення із сокету. За промовчанням отримання буде блокуватися доти, доки повідомлення не буде доступне, тільки якщо не встановлено прапорець **`ZMQ::MODE_DONTWAIT`**. Можна використовувати опцію сокету **`ZMQ::SOCKOPT_RCVMORE`** для отримання повідомлень, що складаються з декількох частин. Детальніше дивіться [ZMQSocket::setSockOpt()](zmqsocket.setsockopt.md)\n\n### Список параметрів\n\n`mode`\n\nПрапори для налаштування режиму, що не блокує отримання та роботи з повідомленнями, що складаються з декількох частин. Дивіться константи **`ZMQ::MODE_*`**\n\n### Значення, що повертаються\n\nПовертає повідомлення. Якщо використовується режим **`ZMQ::MODE_DONTWAIT`** і операцію заблоковано, то буде повернуто **`false`**\n\n### Помилки\n\nВикидає **ZMQSocketException**в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Приклад надсилання/отримання**\n\nЧи не блокує відправка/отримання\n\n```php\n<?php\n\n/* Создаём новый объект очереди. Необходим сервер на другой стороне. */\n$queue = new ZMQSocket(new ZMQContext(), ZMQ::SOCKET_REQ);\n$queue->connect(\"tcp://127.0.0.1:5555\");\n\n/* Привязываем сокет 1 к очереди, отправляем и получаем */\n$retries = 5;\n$sending = true;\n\n/* Запускаем цикл */\ndo {\n    try {\n        /* Пытаемся отправить/получить */\n        if ($sending) {\n            echo \"Отправляем сообщение\\n\";\n            $queue->send(\"Я сообщение!\", ZMQ::MODE_DONTWAIT);\n            $sending = false;\n        } else {\n            echo \"Получен ответ: \" . $queue->recv(ZMQ::MODE_DONTWAIT) . \"\\n\";\n            break;\n        }\n    } catch (ZMQSocketException $e) {\n        /* EAGAIN означает, что операция заблокирована, повторяем */\n        if ($e->getCode() === ZMQ::ERR_EAGAIN) {\n            echo \" - Получили EAGAIN, повторяем ($retries)\\n\";\n        } else {\n            die(\" - Ошибка: \" . $e->getMessage());\n        }\n    }\n    /* Немножко ждём */\n    usleep(5);\n} while (--$retries);\n?>\n```\n\nВисновок наведеного прикладу буде схожим на:\n\n```\nОтправляем сообщение\n - Получили EAGAIN, повторяем (4)\nПолучен ответ: Я сообщение!\n```\n","title":"ZMQSocket::recv","contentType":2,"navigation":[{"zmqsocket.ispersistent.md":"« ZMQSocket::isPersistent"},{"zmqsocket.recvmulti.md":"ZMQSocket::recvMulti »"},{"index.md":"PHP Manual"},{"class.zmqsocket.md":"ZMQSocket"}]}},"__N_SSG":true}