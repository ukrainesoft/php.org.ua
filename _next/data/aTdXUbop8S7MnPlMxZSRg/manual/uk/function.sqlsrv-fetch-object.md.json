{"pageProps":{"page":{"slug":"function.sqlsrv-fetch-object.md","content":"# sqlsrv\\_fetch\\_object\n\n(No version information available, might only be in Git)\n\nsqlsrv\\_fetch\\_object — Отримує наступний рядок даних у наборі результатів як об'єкт\n\n### Опис\n\n```methodsynopsis\nsqlsrv_fetch_object(    resource $stmt,    string $className = ?,    array $ctorParams = ?,    int $row = ?,    int $offset = ?): mixed\n```\n\nВитягує наступний рядок даних у наборі результатів як екземпляр зазначеного класу з властивостями, що відповідають іменам полів рядка та значенням, що відповідають значенням полів рядка.\n\n### Список параметрів\n\n`stmt`\n\nРесурс оператора, що повертається [sqlsrv\\_query()](function.sqlsrv-query.md) або [sqlsrv\\_execute()](function.sqlsrv-execute.md)\n\n`className`\n\nНазва класу для створення екземпляра. Якщо ім'я класу не вказано, створюється екземпляр stdClass.\n\n`ctorParams`\n\nЗначення, що передаються конструктору зазначеного класу. Якщо конструктор зазначеного класу приймає параметри, необхідно надати масив ctorParams.\n\n`row`\n\nРядок, до якого потрібно отримати доступ. Параметр можна використовувати лише в тому випадку, якщо вказаний оператор був підготовлений за допомогою курсору з можливістю прокручування. У цьому випадку цей параметр може приймати одне з таких значень:\n\n-   SQLSRV\\_SCROLL\\_NEXT\n-   SQLSRV\\_SCROLL\\_PRIOR\n-   SQLSRV\\_SCROLL\\_FIRST\n-   SQLSRV\\_SCROLL\\_LAST\n-   SQLSRV\\_SCROLL\\_ABSOLUTE\n-   SQLSRV\\_SCROLL\\_RELATIVE\n\n`offset`\n\nВказує рядок, до якого буде доступ, якщо для параметра рядка встановлено значення \\*\\*`SQLSRV_SCROLL_ABSOLUTE`** або **`SQLSRV_SCROLL_RELATIVE`\\*\\*Обратите внимание, что первая строка в наборе результатов имеет индекс 0.\n\n### Значення, що повертаються\n\nУ разі успішного виконання повертає об'єкт, \\*\\*`null`\\*\\*якщо в наборі результатів більше немає рядків і **`false`** у разі виникнення помилки або якщо зазначений клас не існує.\n\n### Приклади\n\n**Приклад #1 Приклад використання** sqlsrv\\_fetch\\_object()\\*\\*\\*\\*\n\nУ цьому прикладі показано, як отримати рядок як об'єкт stdClass.\n\n```php\n<?php\n$serverName = \"serverName\\sqlexpress\";\n$connectionInfo = array( \"Database\"=>\"dbName\", \"UID\"=>\"username\", \"PWD\"=>\"password\");\n$conn = sqlsrv_connect( $serverName, $connectionInfo);\nif( $conn === false ) {\n     die( print_r( sqlsrv_errors(), true));\n}\n\n$sql = \"SELECT fName, lName FROM Table_1\";\n$stmt = sqlsrv_query( $conn, $sql);\nif( $stmt === false ) {\n     die( print_r( sqlsrv_errors(), true));\n}\n\n// Получение каждой строки как объект.\n// Поскольку класс не указан, каждая строка будет получена как объект stdClass.\n// Имена свойств соответствуют именам полей.\nwhile( $obj = sqlsrv_fetch_object( $stmt)) {\n      echo $obj->fName.\", \".$obj->lName.\"<br />\";\n}\n?>\n```\n\n### Примітки\n\nЯкщо ім'я класу вказано з необов'язковим параметром $className і клас має властивості, імена яких збігаються з іменами полів набору результатів, до властивостей застосовуються відповідні значення набору результатів. Якщо ім'я поля набору результатів не відповідає властивості класу, властивість з ім'ям поля набору результатів додається до об'єкта, а значення набору результатів застосовується до властивості. При використанні параметра $className застосовуються такі правила:\n\n-   При зіставленні імен властивостей поля враховується регістр.\n-   Порівняння властивостей поля відбувається незалежно від модифікаторів доступу.\n-   Типи даних властивостей класу ігноруються при застосуванні значення поля властивості.\n-   Якщо клас немає, функція повертає\\*\\*`false`\\*\\*та додає помилку до колекції помилок.\n\nНезалежно від того, чи вказано параметр $className, якщо поле повертається без імені, значення поля буде проігноровано, а до колекції помилок буде додано попередження.\n\nПри використанні набору результатів, що містить кілька стовпців з однаковим ім'ям, можливо краще використовувати [sqlsrv\\_fetch\\_array()](function.sqlsrv-fetch-array.md) або комбінацію [sqlsrv\\_fetch()](function.sqlsrv-fetch.md) і [sqlsrv\\_get\\_field()](function.sqlsrv-get-field.md)\n\n### Дивіться також\n\n-   [sqlsrv\\_fetch()](function.sqlsrv-fetch.md) \\- Робить наступний рядок у наборі результатів доступного для читання\n-   [sqlsrv\\_fetch\\_array()](function.sqlsrv-fetch-array.md) \\- Повертає рядок як масив\n","title":"sqlsrv\\_fetch\\_object","contentType":2,"navigation":[{"function.sqlsrv-fetch-array.md":"« sqlsrv\\_fetch\\_array"},{"function.sqlsrv-fetch.md":"sqlsrv\\_fetch »"},{"index.md":"PHP Manual"},{"ref.sqlsrv.md":"Функції SQLSRV"}]}},"__N_SSG":true}