- [« Якщо PHP встановлено як CGI](security.cgi-bin.md)
- [Варіант 1: обслуговуються лише загальнодоступні файли
»](security.cgi-bin.default.md)

- [PHP Manual](index.md)
- [Якщо PHP встановлено як CGI](security.cgi-bin.md)
- Можливі атаки

## Можливі атаки

Використання PHP як бінарного CGI-програми є одним з
варіантів, коли з яких-небудь причин небажано інтегрувати PHP у
веб-сервер (наприклад, Apache) як модуль, або передбачається
використання різних CGI-оберток і таких утиліт, як chroot та setuid
для організації безпечного оточення роботи скриптів Така установка
зазвичай супроводжується копіюванням виконуваного файлу PHP в директорію
cgi-bin веб-сервер. CERT (організація, яка стежить за загрозами
безпеки)
[»CA-96.11](http://www.cert.org/advisories/CA-1996-11.md) рекомендує
не поміщати будь-які інтерпретатори до каталогу cgi-bin. Навіть якщо PHP
використовується як самостійний інтерпретатор, він спроектований так,
щоб запобігти можливості наступних атак:

- Доступ до системних файлів: `http://my.host/cgi-bin/php?/etc/passwd`
Дані, введені у рядку запиту (URL) після запитання
знака, передаються інтерпретатору як аргументи командного рядка з
за допомогою інтерфейсу CGI. Зазвичай інтерпретатори відкривають та виконують
файл, вказаний як перший аргумент. У разі використання
PHP як CGI-додаток він не буде інтерпретувати
аргументи командного рядка.
- Доступ до довільного документа на сервері:
`http://my.host/cgi-bin/php/secret/doc.md` Відповідно до загальноприйнятого
угоді, частина шляху на запитаній сторінці, яка розташована
після імені виконуваного модуля PHP, `/secret/doc.md`,
використовується для вказівки файлу, інтерпретованого
CGI-програмою. Зазвичай деякі конфігураційні опції веб-сервера
(наприклад, Action для сервера Apache) використовуються для
перенаправлення документа, наприклад, для перенаправлення запитів
виду `http://my.host/secret/script.php` інтерпретатору PHP. У такому
У разі веб-сервер спочатку перевіряє права доступу до директорії
`/secret`, і після цього створює перенаправлений запит
`http://my.host/cgi-bin/php/secret/script.php`. На жаль, якщо
запит спочатку заданий у повному вигляді, перевірка на наявність прав для
файлу `/secret/script.php` не виконується, вона відбувається тільки для
файлу `/cgi-bin/php`. Таким чином, користувач має можливість
звернутися до `/cgi-bin/php`, і, як наслідок, до будь-якого захищеного
документ на сервері. Якщо в PHP вказати під час виконання скрипту
опції [cgi.force_redirect](ini.core.md#ini.cgi.force-redirect),
[doc_root](ini.core.md#ini.doc-root) та
[user_dir](ini.core.md#ini.user-dir), то можна запобігти
подібні атаки для директорій з обмеженим доступом. Більше
детально наведені опції, а також їх комбінації будуть розглянуті
нижче.
