- [«Безпека файлової системи](security.filesystem.md)
- [Безпека баз даних »](security.database.md)

- [PHP Manual](index.md)
- [Безпека файлової системи](security.filesystem.md)
- Проблеми безпеки, пов'язані з нульовим байтом

## Проблеми безпеки, пов'язані з нульовим байтом

Так як для роботи з файловою системою PHP використовує нижченаведені
C-функції, то в цьому випадку можлива вкрай несподівана обробка
нульового байта. Так як нульовий байт означає кінець рядка C, то
рядки, що містять такий байт, не трактуватимуться повністю, а тільки
до тієї позиції, де знаходиться цей байт. Наступний приклад містить
вразливий код, що демонструє цю проблему:

**Приклад #1 Скрипт, вразливий до нульового байта**

`<?php$file u003d $_GET['file']; // "../../etc/passwd "if (file_exists('/home/wwwrun/'.$file.'.php')) {    // file_exists верне true, т.к. /home/wwwrun/../../etc/passwd існує    include '/home/wwwrun/'.$file.'.php'; // буде підключений файл /etc/passwd}?> `

Таким чином, будь-який зіпсований рядок, що використовується в операціях з
файлова система повинна бути відповідним чином перевірена. Ось
покращена версія попереднього прикладу:

**Приклад #2 Коректна перевірка вхідних даних**

`<?php$file u003d $_GET['file'];// Білий список можливих значеньswitch ($file) {    case 'main':   case 'foo':                          '.$file.'.php'; break; default:        include '/home/wwwrun/include/main.php';}?> `
