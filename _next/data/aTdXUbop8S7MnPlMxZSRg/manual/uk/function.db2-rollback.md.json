{"pageProps":{"page":{"slug":"function.db2-rollback.md","content":"# db2\\_rollback\n\n(PECL ibm\\_db2 >= 1.0.0)\n\ndb2\\_rollback - Відкочує транзакцію\n\n### Опис\n\n```methodsynopsis\ndb2_rollback(resource $connection): bool\n```\n\nВідкочує поточну транзакцію на зазначеному з'єднанні та починає нову. За промовчанням, в PHP, використовується автопідтвердження транзакцій, так що функція **db2\\_rollback()** потрібна лише в тому випадку, якщо ви примусово відключили автопідтвердження транзакцій для з'єднання.\n\n### Список параметрів\n\n`connection`\n\nЗмінна, що містить активний ресурс підключення, отриманий за допомогою [db2\\_connect()](function.db2-connect.md) або [db2\\_pconnect()](function.db2-pconnect.md)\n\n### Значення, що повертаються\n\nПовертає **`true`** у разі успішного виконання або \\*\\*`false`\\*\\*в случае возникновения ошибки.\n\n### Приклади\n\n**Приклад #1 Відкат операції DELETE**\n\nУ наступному прикладі ми порахуємо кількість рядків у таблиці, відключимо автопідтвердження транзакцій, видалимо всі рядки у таблиці та переконаємось, що їх стало . Після цього ми використовуємо функцію **db2\\_rollback()** і перевіримо, що число рядків у таблиці стало таким самим, як і до видалення - це підтвердить, що транзакція успішно відкотилася.\n\n```php\n<?php\n$conn = db2_connect($database, $user, $password);\n\nif ($conn) {\n    $stmt = db2_exec($conn, \"SELECT count(*) FROM animals\");\n    $res = db2_fetch_array( $stmt );\n    echo $res[0] . \"\\n\";\n\n    // Отключаем автоподтверждение\n    db2_autocommit($conn, DB2_AUTOCOMMIT_OFF);\n\n    // Удаляем все строки из ANIMALS\n    db2_exec($conn, \"DELETE FROM animals\");\n\n    $stmt = db2_exec($conn, \"SELECT count(*) FROM animals\");\n    $res = db2_fetch_array( $stmt );\n    echo $res[0] . \"\\n\";\n\n    // Откатываем операцию DELETE\n    db2_rollback( $conn );\n\n    $stmt = db2_exec( $conn, \"SELECT count(*) FROM animals\" );\n    $res = db2_fetch_array( $stmt );\n    echo $res[0] . \"\\n\";\n    db2_close($conn);\n}\n?>\n```\n\nРезультат виконання наведеного прикладу:\n\n```\n7\n0\n7\n```\n\n### Дивіться також\n\n-   [db2\\_autocommit()](function.db2-autocommit.md) \\- Повертає або встановлює режим автопідтвердження транзакцій для з'єднання\n-   [db2\\_commit()](function.db2-commit.md) \\- підтверджує транзакцію\n","title":"db2\\_rollback","contentType":2,"navigation":[{"function.db2-result.md":"« db2\\_result"},{"function.db2-server-info.md":"db2\\_server\\_info »"},{"index.md":"PHP Manual"},{"ref.ibm-db2.md":"Функції IBM DB2"}]}},"__N_SSG":true}