- [« dns_get_mx](function.dns-get-mx.md)
- [fsockopen »] (function.fsockopen.md)

- [PHP Manual](index.md)
- [Мережні функції](ref.network.md)
- Отримання ресурсних записів DNS хоста

# dns_get_record

(PHP 5, PHP 7, PHP 8)

dns_get_record — Отримання ресурсних записів DNS хоста

### Опис

**dns_get_record**(
string `$hostname`,
int `$type` u003d **`DNS_ANY`**,
array `&$authoritative_name_servers` u003d **`null`**,
array `&$additional_records` u003d **`null`**,
bool `$raw` u003d **`false`**
): array\|false

Здійснює вибірку DNS-записів, що відповідають властивостям хоста
`hostname`.

### Список параметрів

`hostname`
Параметр `hostname` має бути коректним DNS-іменем таким, як
"www.example.com". Зворотний дозвіл назв хостів може бути
зроблено з використанням нотації `in-addr.arpa`, однак, для цієї
мети краще скористатися функцією
[gethostbyaddr()](function.gethostbyaddr.md).

> **Примітка**:
>
> Відповідно до стандартів DNS, адреси електронної пошти задаються в
> форматі `user.host` (наприклад, `hostmaster.example.com` на відміну від
> `hostmaster@example.com`), тому будьте уважні та додатково
> Перевірте це значення, перш ніж використовувати його в таких функціях,
> як [mail()](function.mail.md).

`type`
За замовчуванням **dns_get_record()** шукатиме всі можливі записи,
відповідні заданому імені хоста `hostname`. Щоб звузити коло
пошуку можна задати необов'язковий параметр `type`. Цей параметр може
приймати наступні значення: **`DNS_A`**, **`DNS_CNAME`**,
**`DNS_HINFO`**, **`DNS_CAA`**, **`DNS_MX`**, **`DNS_NS`**,
**`DNS_PTR`**, **`DNS_SOA`**, **`DNS_TXT`**, **`DNS_AAAA`**,
**`DNS_SRV`**, **`DNS_NAPTR`**, **`DNS_A6`**, **`DNS_ALL`** або
**`DNS_ANY`**.

> **Примітка**:
>
> Через неоднозначну поведінку libresolv на різних платформах,
> **`DNS_ANY`** може повернути не всі записи, повільніший
> **`DNS_ALL`** поверне всі записи надійніше.

> **Примітка**:
>
> Windows: **`DNS_CAA`** не підтримується. Підтримка **`DNS_A6`** не
> реалізована.

`authoritative_name_servers`
Передається за посиланням і, якщо передано, заповнюватиметься ресурсними
записами для *засвідчувальних серверів імен* (Authoritative Name
Servers).

`additional_records`
Передається за посиланням і, якщо передано, буде заповнюватися *додатковими
записами* (Additional Records).

`raw`
`type` буде інтерпретований як необроблений ідентифікатор типу DNS
(не можна використовувати константи `DNS_*`). Значення, що повертається буде
містити ключ `data`, який потрібно проаналізувати вручну.

### Значення, що повертаються

Ця функція повертає масив асоціативних масивів або **`false`**
у разі виникнення помилки. Кожен асоціативний масив містить *
щонайменше* наступні ключі:

| Атрибут Опис |
|---------|------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ------|
| host | Запис у просторі імен DNS, на яку посилається решта даних. |
| class | **dns_get_record()** повертає тільки записи класу Internet, відповідно цей параметр завжди прийматиме значення `IN`. |
| тип | Рядок, що містить тип запису. Додаткові атрибути також містяться в результуючому масиві в залежності від типу. По одному вкладеному масиву за кожен тип. Дивіться таблицю нижче. |
| ttl | Час життя (``Time To Live'`), що залишився для цього запису. Це *не* вихідне ttl запису. Воно дорівнює вихідному за вирахуванням часу, що минув з моменту відправки запиту на сервер. |

**Основні атрибути DNS**

| Тип запису Додаткові дані
|------------|------------------------------------ -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- --------------------------|
| 'A' | `ip`: адреси IPv4 у десятковому форматі з роздільниками. |
| `MX` | `pri`: Пріоритет поштового сервера. Чим нижче число, тим вищий пріоритет. `target`: FQDN поштового сервера Також дивіться [dns_get_mx()](function.dns-get-mx.md). |
| `CNAME` | `target`: FQDN розташування в просторі імен DNS, на яке вказує запис. |
| `NS` | `target`: FQDN - ім'я сервера, який є авторитетним для цього імені хоста. |
| `PTR` | `target`: Розташування без вказівки простору імен DNS, на яке вказує запис. |
| `TXT` | `txt`: Рядок даних, пов'язаних із цим записом. |
| `HINFO` | `cpu`: число IANA, що позначає модель процесора комп'ютера, який вказує цей запис. `os`: число IANA, що означає операційну систему комп'ютера, який вказує цей запис. Дивіться додатково IANA [» `Operating System Names`](http://www.iana.org/assignments/operating-system-names). |
| `CAA` | `flags`: Однобайтове бітове поле; в даний момент визначено лише біт номер 0, що називається 'critical'; інші біти зарезервовані та повинні ігноруватися. `tag`: Ім'я тега CAA (літерно-числовий рядок ASCII). `value`: Значення тега CAA (бінарний рядок, можна використовувати підформати). Докладніше читайте тут: [» RFC 6844](http://www.faqs.org/rfcs/rfc6844) |
| 'SOA' | mname: FQDN початкового комп'ютера, з якого отримані ресурсні записи. `rname`: Адреса електронної пошти адміністратора домену. `serial`: Порядковий номер цієї ревізії домена, що запитується. `refresh`: Інтервал часу (в секундах), який мають використовувати вторинні сервери під час оновлення видалених копій цього домену. `retry`: Час очікування (у секундах) після невдалого оновлення до наступної спроби. `expire`: Максимальний час (у секундах), протягом якого вторинний DNS-сервер повинен тримати в пам'яті дані віддалених копій доменної зони, перш ніж відповісти, коли не вдається оновити дані. `minimum-ttl`: Мінімальний час (у секундах), протягом якого клієнт може працювати з поточною DNS-роздільною здатністю, перш ніж йому доведеться повторно запитувати цей дозвіл. Значення може бути замінено окремими ресурсними записами. |
| `AAAA` | `ipv6`: адреса IPv6
| `A6` | `masklen`: Довжина (у бітах), яку потрібно успадкувати від цільової адреси `chain`. `ipv6`: Адреса для цього конкретного запису, який потрібно об'єднати з `chain`. `chain`: Запис, який потрібно доповнити даними `ipv6`. |
| `SRV` | `pri`: (Пріоритет) менші значення мають використовуватися першими. `weight`: Ранжування. Записам з великою вагою віддається перевага. `targets` має вибиратися випадково. `target` та `port`: ім'я хоста та номер порту, на якому можна знайти запитану службу. Додаткову інформацію можна отримати за посиланням: [»RFC 2782](http://www.faqs.org/rfcs/rfc2782) |
| `NAPTR` | `order` та `pref`: Еквівалентні `pri` та `weight` наведеним вище. `flags`, `services`, `regex` та `replacement`: Параметри, визначені в [»RFC 2915](http://www.faqs.org/rfcs/rfc2915). |

**Інші ключі асоціативного масиву, що відповідають типу 'type'**

### Список змін

| Версія | Опис |
|---------------|--------------------------------- ------|
| 7.0.16, 7.1.2 | Додано підтримку записів типу CAA. |

### Приклади

**Приклад #1 Приклад використання **dns_get_record()****

` <?php$result u003d dns_get_record("php.net");print_r($result);?> `

Результатом виконання цього прикладу буде щось подібне:

Array
(
[0] u003d> Array
(
[host] u003d> php.net
[type] u003d> MX
[pri] u003d> 5
[target] u003d> pair2.php.net
[class] u003d> IN
[ttl] u003d> 6765
)

[1] u003d> Array
(
[host] u003d> php.net
[type] u003d> A
[ip] u003d> 64.246.30.37
[class] u003d> IN
[ttl] u003d> 8125
)

)

**Приклад #2 Використання **dns_get_record()** з DNS_ANY**

Оскільки часто потрібно визначити IP-адресу поштового сервера,
після того, як запис MX був дозволений, **dns_get_record()** повертає
масив `additional_records` із відповідними записами. Масив
`authoritative_name_servers` міститиме список свідоцтв
DNS серверів.

` <?php/* Отправим "ANY" запрос к php.net,   создадим массивы $authns и $addtl,   в которые будут помещён список серверов   имён и дополнительные записи,   соответствующие этим серверам*/$result u003d dns_get_record("php.net" , DNS_ANY, $authns, $addtl);echo "Результат u003d ";print_r($result);echo "Посвідчуючі сервери u003d ";print_r($authns);echo "Додаткові записи u003d > `

Результатом виконання цього прикладу буде щось подібне:

Результат u003d Array
(
[0] u003d> Array
(
[host] u003d> php.net
[type] u003d> MX
[pri] u003d> 5
[target] u003d> pair2.php.net
[class] u003d> IN
[ttl] u003d> 6765
)

[1] u003d> Array
(
[host] u003d> php.net
[type] u003d> A
[ip] u003d> 64.246.30.37
[class] u003d> IN
[ttl] u003d> 8125
)

)
Сервіси, що засвідчують u003d Array
(
[0] u003d> Array
(
[host] u003d> php.net
[type] u003d> NS
[target] u003d> remote1.easydns.com
[class] u003d> IN
[ttl] u003d> 10722
)

[1] u003d> Array
(
[host] u003d> php.net
[type] u003d> NS
[target] u003d> remote2.easydns.com
[class] u003d> IN
[ttl] u003d> 10722
)

[2] u003d> Array
(
[host] u003d> php.net
[type] u003d> NS
[target] u003d> ns1.easydns.com
[class] u003d> IN
[ttl] u003d> 10722
)

[3] u003d> Array
(
[host] u003d> php.net
[type] u003d> NS
[target] u003d> ns2.easydns.com
[class] u003d> IN
[ttl] u003d> 10722
)

)
Додаткові записи u003d Array
(
[0] u003d> Array
(
[host] u003d> pair2.php.net
[type] u003d> A
[ip] u003d> 216.92.131.5
[class] u003d> IN
[ttl] u003d> 6766
)

[1] u003d> Array
(
[host] u003d> remote1.easydns.com
[type] u003d> A
[ip] u003d> 64.39.29.212
[class] u003d> IN
[ttl] u003d> 100384
)

[2] u003d> Array
(
[host] u003d> remote2.easydns.com
[type] u003d> A
[ip] u003d> 212.100.224.80
[class] u003d> IN
[ttl] u003d> 81241
)

[3] u003d> Array
(
[host] u003d> ns1.easydns.com
[type] u003d> A
[ip] u003d> 216.220.40.243
[class] u003d> IN
[ttl] u003d> 81241
)

[4] u003d> Array
(
[host] u003d> ns2.easydns.com
[type] u003d> A
[ip] u003d> 216.220.40.244
[class] u003d> IN
[ttl] u003d> 81241
)

)

### Дивіться також

- [dns_get_mx()](function.dns-get-mx.md) - Псевдонім getmxrr
- [dns_check_record()](function.dns-check-record.md) - Псевдонім
checkdnsrr
