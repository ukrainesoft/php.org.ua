- [« preg_replace_callback](function.preg-replace-callback.md)
- [preg_split »] (function.preg-split.md)

- [PHP Manual](index.md)
- [Функції PCRE](ref.pcre.md)
- Виконує пошук та заміну за регулярним виразом

# preg_replace

(PHP 4, PHP 5, PHP 7, PHP 8)

preg_replace — Пошук та заміна за регулярним виразом

### Опис

**preg_replace**(
string\|array `$pattern`,
string\|array `$replacement`,
string\|array `$subject`,
int `$limit` u003d -1,
int `&$count` u003d **`null`**
): string\|array\|null

Виконує пошук збігів у рядку `subject` із шаблоном `pattern` та
замінює їх на `replacement`.

### Список параметрів

`pattern`
Шуканий шаблон. Можливо як рядком, і масивом рядків.

Також доступні деякі [модифікатори
PCRE] (reference.pcre.pattern.modifiers.md).

`replacement`
Рядок або масив рядків для заміни. Якщо цей параметр є рядком,
а `pattern` є масивом, всі шаблони будуть замінені цим рядком.
Якщо і `pattern` та `replacement` є масивами, кожен елемент
`pattern` буде замінено відповідним елементом з `replacement`. Якщо
масив `replacement` містить менше елементів, ніж масив `pattern`, то
всі зайві шаблони з pattern будуть замінені порожніми рядками.

`replacement` може містити посилання виду `
`, або `$n`, причому
останній варіант кращий. Кожне таке посилання буде замінено
на підрядок, що відповідає n-го підмаску. n може приймати значення
від 0 до 99, причому посилання `` (або `$0`) відповідає входу всього
шаблон. Підмаски нумеруються ліворуч, починаючи з одиниці. Зверніть
увагу, що зворотні сліші у рядку (string) літерали можуть вимагати
екранування.

При заміні за шаблоном з використанням посилань на підмаски може
виникнути ситуація, коли безпосередньо за маскою слід цифра
(наприклад, встановлення цифри відразу після маски, що збіглася). В такому випадку
не можна використовувати знайому нотацію виду `` для посилання на підмаски.
Запис, наприклад, ``, збентежить **preg_replace()**, тому що вона не
зможе зрозуміти, чи хочете ви використовувати посилання ``, за якою слідує
цифра `1` або ж ви хочете просто використовувати посилання ``, за якою
нічого не слід. Це непорозуміння можна усунути, якщо
скористатися конструкцією `${1}1`, яка використовує ізольоване посилання
`$1`, і наступну за нею цифру `1`.

При використанні застарілого модифікатора `e` ця функція екранує
деякі символи (а саме ```, ```, `\` і NULL) у рядках, що заміщають
зворотні посилання. Це зроблено для засвідчення коректності синтаксису
при використанні зворотних посилань усередині одинарних або подвійних лапок
(наприклад, `strlen($1)+strlen($2)). Переконайтеся, що ви володієте
[синтаксисом обробки рядків](language.types.string.md) PHP для того,
щоб точно усвідомлювати, як виглядатиме інтерпретований рядок.

`subject`
Рядок або масив рядків для пошуку та заміни.

Якщо `subject` є масивом, то пошук із заміною здійснюється для
кожного елемента масиву `subject`, а значення, що повертається, також буде
бути масивом.

`limit`
Максимально можлива кількість замін кожного шаблону для кожного рядка
`subject`. За замовчуванням дорівнює `-1` (без обмежень).

`count`
Якщо зазначено, то ця змінна буде заповнена кількістю
зроблених замін.

### Значення, що повертаються

**preg_replace()** повертає масив, якщо параметр `subject` є
масивом, інакше повертається рядок.

Якщо знайдені збіги, повертається нова версія `subject`, інакше
`subject` повертається недоторканим, у разі помилки повертається
**`null`**.

### Помилки

Використання модифікатора є помилкою; у цьому випадку видається
помилка рівня **`E_WARNING`**;.

Якщо переданий шаблон регулярного виразу не компілюється
допустиме регулярне вираження, видається помилка рівня **`E_WARNING`**.

### Приклади

**Приклад #1 Використання підмасок, за якими слідує цифра**

` <?php$string u003d 'April 15, 2003';$pattern u003d '/(\w+) (\d+), (\d+)/i';$replacement u003d '${1}1,$3';echo preg_replace($pattern, $replacement, $string);?> `

Результат виконання цього прикладу:

April1,2003

**Приклад #2 Використання масивів з числовими індексами як
аргументів функції **preg_replace()****

` <?php$string u003d 'The quick brown fox jumps over the lazy dog.';$patterns u003d array();$patterns[0] u003d '/quick/';$patterns[1] u003d '/brown ;$patterns[2] u003d '/fox/';$replacements u003d array();$replacements[2] u003d 'bear';$replacements[1] u003d 'black';$replacements[0] u003d 'slow'; echo preg_replace($patterns, $replacements, $string);?> `

Результат виконання цього прикладу:

Bear black slow jumps over lazy dog.

Відсортувавши за ключами шаблони та заміни, отримуємо бажаний результат:

` <?phpksort($patterns);ksort($replacements);echo preg_replace($patterns, $replacements, $string);?> `

Результат виконання цього прикладу:

Slow black bear jumps over the lazy dog.

**Приклад #3 Заміна за кількома шаблонами**

` <?php$patterns u003d array ('/(19|20)(\d{2})-(\d{1,2})-(\d{1,2})/',               ^/ s*{(\w+)}\s*u003d/');$replace u003d array (' / / ', '$  u003d');echo preg_replace($patterns, $replace, '{startDate} u003d 1999-5-27');?> `

Результат виконання цього прикладу:

$startDate u003d 5/27/1999

**Приклад #4 Чистка пробілів**

Цей приклад вичищає зайві прогалини у рядку.

` <?php$str u003d 'foo   o';$str u003d preg_replace('/\s\s+/', ' ', $str);// Це тепер буде 'foo o'echo $str;?> `

**Приклад #5 Використання параметра `count`**

` <?php$count u003d 0;echo preg_replace(array('/\d/', '/\s/'), '*', 'xp 4 to', -1 , $count);echo $count; //3?> `

Результат виконання цього прикладу:

xp***to
3

### Примітки

> **Примітка**:
>
> При використанні масивів в `pattern` та `replacement`, ключі
> обробляються у порядку, у якому перебувають у масиві. Цей
> порядок *не завжди* збігається з числовим порядком індексів. Якщо ви
> використовуєте індекси для порівняння один з одним потрібного `pattern`
> та `replacement`, то вам необхідно прогнати через функцію
> [ksort()](function.ksort.md) обидва масиви перед використанням
> **preg_replace()**.

### Дивіться також

- [Регулярні висловлювання PCRE](pcre.pattern.md)
- [preg_quote()](function.preg-quote.md) - Екранує символи в
регулярних виразах
- [preg_filter()](function.preg-filter.md) - Виконує пошук та
заміну за регулярним виразом
- [preg_match()](function.preg-match.md) - Виконує перевірку на
відповідність регулярному виразу
- [preg_replace_callback()](function.preg-replace-callback.md) -
Виконує пошук за регулярним виразом та заміною з використанням
callback-функції
- [preg_split()](function.preg-split.md) - Розбиває рядок по
регулярному виразу
- [preg_last_error()](function.preg-last-error.md) - Повертає код
помилки виконання останнього регулярного вираження PCRE
