- [«Тестування](oci8.test.md)
- [Предвизначені константи »](oci8.constants.md)

- [PHP Manual](index.md)
- [Встановлення та налаштування](oci8.setup.md)
- Налаштування під час виконання

## Налаштування під час виконання

Поведінка цих функцій залежить від установок `php.ini`.

| Ім'я За замовчуванням | Місце зміни | Список змін |
|------------------------------------------------- -----------------------------------------|-------- ------|-----------------|------------------------- -------------------------------------------------- ----------|
| [oci8.connection_class](oci8.configuration.md#ini.oci8.connection-class) | "" | PHP_INI_ALL | Доступна з версії PECL OCI8 1.3. |
| [oci8.default_prefetch](oci8.configuration.md#ini.oci8.default-prefetch) | "100" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |
| [oci8.events](oci8.configuration.md#ini.oci8.events) | Off | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.3. |
| [oci8.max_persistent](oci8.configuration.md#ini.oci8.max-persistent) | "-1" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. Оголошена застарілою починаючи з PHP 8.1.0. |
| [oci8.old_oci_close_semantics](oci8.configuration.md#ini.oci8.old-oci-close-semantics) | Off | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |
| [oci8.persistent_timeout](oci8.configuration.md#ini.oci8.persistent-timeout) | "-1" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |
| [oci8.ping_interval](oci8.configuration.md#ini.oci8.ping-interval) | "60" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |
| [oci8.prefetch_lob_size](oci8.configuration.md#ini.oci8.prefetch-lob-size) | "0" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 3.2. |
| [oci8.privileged_connect](oci8.configuration.md#ini.oci8.privileged-connect) | Off | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |
| [oci8.statement_cache_size](oci8.configuration.md#ini.oci8.statement-cache-size) | "20" | PHP_INI_SYSTEM | Доступна з версії PECL OCI8 1.1. |

**Параметри конфігурації OCI8**

Коротке пояснення конфігураційних директив.

`oci8.connection_class` string
Цей текст, що визначається користувачем, обов'язково повинен бути заданий при
використання резидентного пулу з'єднань бази даних Oracle (Database
Resident Connection Pooling (DRCP). Це дозволяє субпартіонування
пула з'єднань DRCP, що дозволяє постійним з'єднанням OCI8 з
програми наново використовувати сесії бази даних від попереднього
PHP-скрипта, покращуючи масштабованість. Якщо програма використовує
процес з пулу бази даних, що раніше використовується з іншим класом
з'єднань, налаштування сесії, такі як формат дати Oracle, будуть
скинуті. Це запобігає випадковому обміну інформацією між різними
додатками.

Значення може бути встановлене під час виконання скрипту за допомогою
[ini_set()](function.ini-set.md) до встановлення з'єднання.

Для використання DRCP, OCI8 має бути зібрана з бібліотеками Oracle
11*g* чи новіше і база даних має бути Oracle 11*g* чи новіше. Пул
з'єднань DRCP у базі даних має бути включений,
`oci8.connection_class` має бути встановлене в те саме рядкове
значення для всіх веб-серверів, що виконують одну і ту ж програму, а
рядок з'єднання OCI8 повинен вказувати на сервер із пула. додаток
Повинне використовувати постійні з'єднання.

`oci8.default_prefetch` int
Ця опція встановлює значення за замовчуванням для кількості екстра
рядів, які будуть повернуті та автоматично закешовані при
низькорівневий запит даних з бази даних. Встановлення значення `0`
вимикає попередню вибірку (prefetching).

Значення попередньої вибірки не змінює кількість повертаних
користувачеві рядів такими функціями як
[oci_fetch_array()](function.oci-fetch-array.md); OCI8 внутрішньо
обробляє попередню вибірку та кешування рядів.

Значення може бути встановлене окремо для кожного виразу
(per-statement) за допомогою
[oci_set_prefetch()](function.oci-set-prefetch.md) до виконання
самого виразу.

У PHP 5.3 (PECL OCI8 1.3.4) значення за промовчанням було збільшено з `10`
до `100`.

У PHP 5.3.2 (PECL OCI8 1.4) мінімально встановлене значення було
зменшено з `1` до `0`, дозволяючи таким чином вимкнення
попередньої вибірки.

При використанні Oracle Database 12*c* або новіше, попереднє
значення, задане PHP, може бути перевизначено клієнтським
конфігураційним файлом Oracle `oraaccess.xml`. Зверніться до
документації Oracle.

> **Примітка**: Велика попередня вибірка може покращити
> продуктивність рахунок деякого збільшеного використання
> пам'яті. Для запитів, що повертають великі масиви даних, вигода у
> продуктивність буде значною.

`oci8.events` bool
Включення (`On`) дозволяє повідомити PHP про події Швидкого Повідомлення
Програми бази даних (FAN).

Без FAN, якщо екземпляр бази даних або вузол машини зненацька дасть
збій, PHP програми можуть бути заблоковані, чекаючи відповіді від бази
даних до перевищення часу очікування TCP. За допомогою подій FAN PHP
програми швидко будуть повідомлені про збої, які впливають на
встановлені ними з'єднання бази даних. Модуль OCI8 підчистить
з'єднання, що не використовуються, в кеші постійних з'єднань.

При використанні директиви (`On`), база даних також має бути
настроєна на відправлення подій FAN.

Підтримка FAN доступна, якщо OCI8 була злінкована з бібліотеками Oracle
10*g*R2 (або пізнішими) та з'єднання було здійснено до Oracle
Database 10*g*R2 (або пізнішої версії).

`oci8.max_persistent` int
Максимальна кількість постійних з'єднань OCI8 на один процес PHP.
Установка цієї опції -1 означає відсутність ліміту.

`oci8.old_oci_close_semantics` bool
Ця опція контролює поведінку функції
[oci_close()](function.oci-close.md). Її включення означає, що
[oci_close()](function.oci-close.md) не робить нічого; з'єднання не
буде закрито, доки не закінчиться виконання скрипта. Це зроблено тільки
з метою зворотної сумісності. Якщо ви відчуваєте потребу в цьому
налаштування, *суворо рекомендується* налаштувати виклики
[oci_close()](function.oci-close.md) у ваших скриптах замість включення
цієї опції.

`oci8.persistent_timeout` int
Максимальна кількість секунд, яку дозволяється PHP-процесу тримати
постійне з'єднання, що не використовується, відкритим. Встановлення цієї опції -1
означає, що з'єднання, що не використовуються, будуть утримані, поки PHP-процес
не завершить виконання або з'єднання не буде примусово
закрито за допомогою функції [oci_close()](function.oci-close.md).

> **Примітка**: У PHP закінчення терміну дії невикористовуваних ресурсів
> не ґрунтується на повідомленнях. Воно трапляється коли PHP завершує
> обробку скрипта та перевіряє позначку часу останніх використаних
> Ресурсів. Звідси виникає наступний парадокс: невикористовувані
> з'єднання можуть бути закриті лише коли є деяка активність
> (хоч і не обов'язково пов'язана з OCI8) у PHP-процесі. Якщо
> є більше одного PHP-процесу, то кожен з них окремо
> має бути приведений у дію для того, щоб ініціювати закінчення
> терміну дії ресурсів, що простоюють. Введення резидентного пулу
> з'єднань бази даних (DRCP) в Oracle 11*g* вирішує проблеми з
> пам'яттю та ресурсами, які раніше намагалися вирішити
> `oci8.max_persistent` та `oci8.persistent_timeout`.

> **Примітка**: У PHP 5.3 (PECL OCI8 1.3), постійні з'єднання можуть
> закрити за допомогою [oci_close()](function.oci-close.md).

`oci8.ping_interval` int
Кількість секунд, що має пройти до пінгу протягом
виконання [oci_pconnect()](function.oci-pconnect.md). Пінг
забезпечує коректність з'єднання бази даних. Якщо встановлено в 0,
постійні з'єднання пінгуватимуться при кожному виклику
[oci_pconnect()](function.oci-pconnect.md). Для повного відключення
пінгів встановіть цю опцію -1.

> **Примітка**: Вимкнення пінгів дозволяє
> [oci_pconnect()](function.oci-pconnect.md) діяти з
> максимальною ефективністю, але PHP може бути нездатним визначити
> непридатні з'єднання, наприклад, при обриві мережі або при вимкненні
> бази даних Oracle після того, як PHP встановив з'єднання, поки
> З'єднання знову не буде використано у скрипті. Проконсультуйтесь
> з документацією функції [oci_pconnect()](function.oci-pconnect.md)
> для більш детальної інформації.

`oci8.prefetch_lob_size` int
Параметр налаштування, що впливає на внутрішню буферизацію даних LOB.
Збільшення цього значення може покращити продуктивність вибірки
менших LOB за рахунок скорочення кругових обходів між PHP та базою
даних. Використання пам'яті зміниться.

Значення впливає на LOB, що повертаються як екземпляри OCILob, а також на
ті, що повертаються за допомогою **`OCI_RETURN_LOBS`**.

Значення може бути встановлене для кожного оператора за допомогою функції
[oci_set_prefetch_lob()](function.oci-set-prefetch-lob.md) до
виконання оператора.

> **Примітка**: Використовуйте Oracle Database 12.2 або новіше.

`oci8.privileged_connect` bool
Ця опція дозволяє з'єднанням використовувати привілейовані зовнішні
облікові записи **`OCI_SYSOPER`** або **`OCI_SYSDBA`**.

> **Примітка**: Встановлення цієї директиви в `On` дозволить скриптам,
> запущених з відповідними користувальницькими привілеями
> операційної системи, з'єднуватися з базою даних як
> привілейованих користувачів бази даних без вимог пароля. Це
> може бути ломом системи безпеки.

`oci8.statement_cache_size` int
Ця опція включає кешування виразів, а також вказує скільки
виразів необхідно кешувати. Для відключення кешування виразів
просто встановіть значення цієї опції 0.

Кешування виразів прибирає необхідність передавати текст виразу до
базі даних, а також зворотну передачу різних метаданих про це
виразі назад до PHP. Це може значно покращити загальну
продуктивність системи у додатках, які повторно використовують
висловлювання протягом життя однієї сполуки. Деякі додаткові
"курсори" баз даних можуть залишитися відкритими, маючи на увазі, що дані
вирази будуть використані повторно.

Встановіть це значення розміром робочого набору виразів, які використовуються
вашим додатком. Встановлення занадто малого значення може спричинити
викид виразів із кешу до їх повторного використання.

Ця опція найчастіше використовується із постійними з'єднаннями.

При використанні Oracle Database 12*c* або вище, попереднє
значення, задане PHP, може бути перевизначено клієнтським
конфігураційним файлом Oracle `oraaccess.xml`. Зверніться до
документації Oracle.
